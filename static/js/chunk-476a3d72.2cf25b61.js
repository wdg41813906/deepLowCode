(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-476a3d72"],{"56d2":function(t,e,a){"use strict";a("958e")},6472:function(t,e,a){"use strict";a("9952")},"958e":function(t,e,a){},9952:function(t,e,a){},b4d4:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{staticClass:"detail_alert_dialog",attrs:{title:"详情",visible:t.my_is_add,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(e){t.my_is_add=e}}},[a("div",{staticClass:"form_other_detail"},[a("el-row",[a("el-col",{attrs:{span:24}},[t._v("表单名："+t._s(t.detail.FormName))]),a("el-col",{attrs:{span:12}},[t._v("创建人："+t._s(t.detail.CreateUserName)+t._s(t.is_flag))]),a("el-col",{attrs:{span:12}},[t._v("创建时间："+t._s(new Date(t.detail.CreateTime).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"").split(" ")[0]))])],1),2!=t.is_flag&&3!=t.is_flag?a("div",{staticClass:"right right_yan cursor",on:{click:function(e){return t.editorClick(t.detail.Code)}}},[a("i",{staticClass:"el-icon-edit"})]):t._e()],1),t.detail_arr.length>0?a("el-table",{attrs:{data:t.detail_arr,border:"","header-cell-style":{background:"#eef1f6",color:"#606266"}}},[a("el-table-column",{attrs:{prop:"name",width:"150",label:"字段"},scopedSlots:t._u([{key:"default",fn:function(e){return[null!=e.row.str_list&&e.row.str_list.length>0?a("span",[t._v(" "+t._s(e.row.name)+" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.row.str_list.join(""),placement:"right"}},[a("i",{staticClass:"el-icon-warning-outline cursor"})])],1):a("span",[t._v(" "+t._s(e.row.name))])]}}],null,!1,2062905585)}),a("el-table-column",{attrs:{prop:"value",label:"数值"},scopedSlots:t._u([{key:"default",fn:function(e){return[""!==e.row.opt_label&&"image"!==e.row.opt_label&&"file"!==e.row.opt_label?a("p",[t._v(" "+t._s(e.row.opt_label.split("__")[1])+" ")]):"image"==e.row.opt_label?a("div",t._l(e.row.value,(function(t){return a("span",{key:t,staticClass:"margin_r_10 display_block"},[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.url,"preview-src-list":e.row.enable_greater}})],1)})),0):"file"==e.row.opt_label?a("div",t._l(e.row.value,(function(e){return a("div",{key:e},[a("p",[a("span",{staticClass:"upload_list_span",on:{click:function(a){return t.goimg(e.url)}}},[t._v(" "+t._s(e.name)+" ")])])])})),0):a("p",[t._v(t._s(e.row.value))]),null!=e.row.assign_data&&e.row.assign_data.length>0?a("div",[a("el-table",{attrs:{data:e.row.assign_data,border:""}},[a("el-table-column",{attrs:{label:"被分配人",prop:"ToUserName"}}),a("el-table-column",{attrs:{label:"被分配值",prop:"ToValue"}})],1)],1):t._e()]}}],null,!1,3791008091)})],1):t._e(),a("el-form",{staticClass:"auditform",attrs:{"label-width":"150px"},nativeOn:{submit:function(t){t.preventDefault()}}},[null!=t.detail.AuditStates?a("el-form-item",{staticClass:"audit_item",attrs:{label:"审批流程：","label-width":"200px"}},[a("div",{staticClass:"audit_div"},[a("el-timeline",t._l(t.detail.AuditStates,(function(e,i){return a("el-timeline-item",{key:i,attrs:{color:0==e.node_state?"#0bbd87":"#D6D6D6"}},[a("div",[a("div",{staticClass:"left"},[a("p",{staticClass:"audit_title"},[t._v("审批人")]),a("p",{staticClass:"audit_num"},[t._v(" "+t._s(e.userids.length)+"人 "),a("span",[t._v(t._s(0==e.node_state?"(已审批)":"(待审批)"))])])]),a("div",{staticClass:"right"},t._l(e.user_info,(function(i,s){return a("span",{key:i},[t._v(" "+t._s(i.name)+" "),s<e.userids.length-1?a("span",[t._v("/")]):t._e()])})),0)])])})),1)],1)]):t._e()],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{icon:"el-icon-refresh-left",type:"danger",size:"small"},on:{click:function(e){return t.callbackone(t.detail.Code)}}},[t._v(" 退 回")]),a("el-button",{attrs:{icon:"el-icon-delete",size:"small"},on:{click:function(e){return t.delClick(t.detail.Code)}}},[t._v(" 删 除")]),a("el-button",{attrs:{icon:"el-icon-tickets",size:"small",type:"warning"},on:{click:function(e){return t.logClick(t.detail.Code)}}},[t._v(" 日 志")]),2!=t.is_flag?a("el-button",{attrs:{icon:"el-icon-check",size:"small",type:"primary"},on:{click:function(e){return t.addClick(t.detail.Code)}}},[t._v(" 通 过")]):t._e()],1)],1),a("EditorDetailAlert",{attrs:{is_add:t.is_editor,form_data:t.detail,detail:t.detail,main_code:t.main_code,task_code:t.detail.TaskCode},on:{back:t.editorBack,subback:t.editorSubBack}}),a("LogAlert",{attrs:{is_add:t.is_log,code:t.logcode},on:{back:t.logBack}})],1)},s=[],l=(a("a9e3"),a("498a"),a("690f")),o=a("3ec3"),n={name:"detail_alert_dialog",props:{is_add:Boolean,detail:Object,is_flag:Number},components:{EditorDetailAlert:l["a"],LogAlert:o["a"]},data:function(){return{tableProps:{border:!0,"header-cell-style":{background:"#eef1f6",color:"#606266"}},my_is_add:!1,is_editor:!1,activeName:"",assignlist:[],logcode:"",is_log:!1,main_code:"",detail_arr:[]}},methods:{goimg:function(t){return window.open(t),!1},logClick:function(t){this.logcode=t,this.is_log=!this.is_log},logBack:function(t){this.is_log=t},editorClick:function(t){this.main_code=t,this.is_editor=!this.is_editor},editorSubBack:function(){this.$emit("otherback"),this.my_is_add=!this.my_is_add},editorBack:function(t){this.is_editor=t},addClick:function(t){var e=this,a=this,i={corpid:this.$store.state.corpid,userid:this.$store.state.userid,main_code:t},s=a.$createObj(i),l=s["keyvalue"],o=a.$apilist["approveone"]+"?signature="+l;a.$server.post(o,s["fd"]).then((function(t){e.$message({type:"success",message:"通过成功!"}),e.editorSubBack()})).catch((function(t){}))},delClick:function(t){var e=this;this.$confirm("删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=e,i={corpid:e.$store.state.corpid,userid:e.$store.state.userid,code:t},s=a.$createObj(i),l=s["keyvalue"],o=a.$apilist["delone_main"]+"?signature="+l;a.$server.post(o,s["fd"]).then((function(){e.$message({type:"success",message:"删除成功!"}),e.$emit("otherback"),e.my_is_add=!e.my_is_add})).catch((function(t){}))})).catch((function(){}))},callbackone:function(t){var e=this;this.$prompt("退回理由","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(a){var i=a.value,s=e,l={corpid:e.$store.state.corpid,userid:e.$store.state.userid,main_code:t};null!=i&&""!=i.trim&&(l["content"]=i);var o=s.$createObj(l),n=o["keyvalue"],r=s.$apilist["denyone"]+"?signature="+n;s.$server.post(r,o["fd"]).then((function(){e.$message({type:"success",message:"退回成功!"}),e.$emit("otherback"),e.my_is_add=!e.my_is_add})).catch((function(t){}))})).catch((function(){e.$message({type:"info",message:"取消退回！"})}))},getimgurl:function(t,e){for(var a in e.enable_greater=[],e.value)e.enable_greater.push(e.value[a].url)}},watch:{is_add:function(t){if(this.my_is_add=t,t)for(var e in this.detail_arr=[],this.detail.FormFieldInfos){if("image"==this.detail.FormFieldInfos[e].opt_label||"file"==this.detail.FormFieldInfos[e].opt_label)for(var a in this.enable_assign=[],this.detail.FormFieldInfos[e].enable_greater=[],this.detail.FormFieldInfos[e].value)this.getimgurl(this.detail.FormFieldInfos[e].value[a],this.detail.FormFieldInfos[e]);this.detail_arr.push({name:this.detail.FormFieldInfos[e].field_label,str_list:this.detail.FormFieldInfos[e].str_list,value:this.detail.FormFieldInfos[e].value,assign_data:this.detail.FormFieldInfos[e].assign_data,opt_label:this.detail.FormFieldInfos[e].opt_label,enable_greater:this.detail.FormFieldInfos[e].enable_greater})}},my_is_add:function(t){this.$emit("back",t)}}},r=n,c=(a("56d2"),a("2877")),d=Object(c["a"])(r,i,s,!1,null,null,null);e["a"]=d.exports},e8d3:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"audit_index"},[a("div",{staticClass:"text_right top_form"},[a("el-button",{staticClass:"top_add",attrs:{type:"primary",size:"small",icon:"el-icon-check"},on:{click:function(e){return t.addListClick()}}},[t._v("批量通过")]),a("el-button",{staticClass:"top_add",attrs:{size:"small",icon:"el-icon-refresh-left"},on:{click:function(e){return t.delListClick()}}},[t._v("批量退回")])],1),a("div",[a("div",{staticClass:"margin_b_10"},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"提交人/表单名/任务名",size:"small"},model:{value:t.filters[0].value,callback:function(e){t.$set(t.filters[0],"value",e)},expression:"filters[0].value"}})],1),a("data-tables",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{filters:t.filters,data:t.tasklist,"pagination-props":{pageSizes:[5,10,15]},"row-key":t.row_key,"expand-row-keys":t.expandRowKeys,"table-props":t.tableProps},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"65"}}),a("el-table-column",{attrs:{label:"内容"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.FormFieldInfos,(function(e,i){return a("div",{key:e},[i<3?a("p",{staticClass:"flow-subtitle"},[""!=e.opt_label&&"image"!=e.opt_label&&"file"!=e.opt_label?a("span",[t._v(" "+t._s(e.field_label)+":"+t._s(e.opt_label.split("__")[1])+" ")]):"image"==e.opt_label||"file"==e.opt_label?a("span",[t._v(" "+t._s(e.field_label)+": "),e.value.length>1?a("span",[t._v(t._s(e.value[0].name)+"...")]):1==e.value.length?a("span",[t._v(t._s(e.value[0].name))]):a("span",[t._v("-")])]):a("span",[t._v(" "+t._s(e.field_label)+":"+t._s(e.value)+" ")])]):t._e()])}))}}])}),a("el-table-column",{attrs:{label:"任务名"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.TaskName)+" ")]}}])}),a("el-table-column",{attrs:{label:"表单名",prop:"FormName"}}),a("el-table-column",{attrs:{label:"提交人",prop:"CreateUserName"}}),a("el-table-column",{attrs:{label:"发起时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"flow-permisson-row"},[a("span",{staticClass:"flow-subtitle"},[t._v(" "+t._s(new Date(e.row.CreateTime).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"").split(" ")[0])+" ")])])]}}])}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"flow-permisson-row"},[a("span",[0==e.row.State?a("span",{staticClass:"flow_per"},[t._v("未提交")]):1==e.row.State?a("span",{staticClass:"flow_per warning"},[t._v("已提交 ")]):2==e.row.State?a("span",{staticClass:"flow_per danger"},[t._v("驳回")]):3==e.row.State?a("span",{staticClass:"flow_per success"},[t._v("已通过")]):4==e.row.State?a("span",{staticClass:"flow_per warning"},[t._l(e.row.AuditStates,(function(i,s){return a("span",{key:i},[a("span",[t._v(t._s(i.user_info[0].name))]),s<e.row.AuditStates.length-1?a("span",[t._v("/")]):t._e()])})),t._v(" 审核中")],2):5==e.row.State?a("span",{staticClass:"flow_per success"},[t._v("已通过")]):6==e.row.State?a("span",{staticClass:"flow_per"},[t._v("导入数据")]):t._e()])])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"form_operate"},[a("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(a){return t.detailClick(e.row,1)}}},[a("span",[t._v("详情")])])],1)]}}])})],1)],1),a("DetailAlert",{attrs:{is_add:t.is_detail,detail:t.detail,is_flag:t.is_flag},on:{back:t.detailBack,otherback:t.otherDetailBack}})],1)},s=[],l=(a("b64b"),a("498a"),a("b4d4")),o={name:"audit_index",components:{DetailAlert:l["a"]},data:function(){return{filters:[{prop:["CreateUserName","FormName","TaskName"],value:""}],tasklist:[],is_flag:1,is_detail:!1,detail:{},selectedRow_review:[],tableProps:{border:!0,"header-cell-style":{background:"#eef1f6",color:"#606266"}}}},methods:{handleSelectionChange:function(t){this.selectedRow_review=t},addListClick:function(){var t=this;if(0==this.selectedRow_review.length)return this.$alert("请选择通过内容！","提示",{confirmButtonText:"确定"}),!1;var e=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid},i=[];for(var s in this.selectedRow_review)i.push(this.selectedRow_review[s].Code);a["main_codes"]=JSON.stringify(i);var l=e.$createObj(a),o=l["keyvalue"],n=e.$apilist["approvemaindatas"]+"?signature="+o;e.$server.post(n,l["fd"]).then((function(e){t.$message({type:"success",message:"批量通过成功!"}),t.alltoauditelist()})).catch((function(t){}))},delListClick:function(){var t=this;if(0==this.selectedRow_review.length)return this.$alert("请选择退回内容！","提示",{confirmButtonText:"确定"}),!1;this.$prompt("退回理由","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(e){var a=e.value,i=t,s={corpid:t.$store.state.corpid,userid:t.$store.state.userid},l=[];for(var o in t.selectedRow_review)l.push(t.selectedRow_review[o].Code);null!=a&&""!=a.trim&&(s["content"]=a),s["main_codes"]=JSON.stringify(l);var n=i.$createObj(s),r=n["keyvalue"],c=i.$apilist["denymaindatas"]+"?signature="+r;i.$server.post(c,n["fd"]).then((function(e){t.$message({type:"success",message:"批量退回成功!"}),t.alltoauditelist(),t.allhaveauditedlist()})).catch((function(t){}))})).catch((function(){t.$message({type:"info",message:"取消退回！"})}))},detailClick:function(t,e){this.is_flag=e,this.is_detail=!this.is_detail,this.detail=t},detailBack:function(t){this.is_detail=t},otherDetailBack:function(){this.alltoauditelist()},alltoauditelist:function(){var t=this,e=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid},i=e.$createObj(a),s=i["keyvalue"],l=e.$apilist["alltoauditelist"]+"?signature="+s;e.$server.post(l,i["fd"]).then((function(e){t.tasklist=e.data})).catch((function(t){}))}},mounted:function(){this.alltoauditelist()}},n=o,r=(a("6472"),a("2877")),c=Object(r["a"])(n,i,s,!1,null,null,null);e["default"]=c.exports}}]);