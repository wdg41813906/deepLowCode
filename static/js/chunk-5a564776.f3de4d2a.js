(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a564776"],{"1d90":function(e,i,s){"use strict";var t=function(){var e=this,i=e.$createElement,s=e._self._c||i;return s("div",{staticClass:"fill_alert"},[s("el-dialog",{staticClass:"fill_alert_dialog",attrs:{title:e.form_data.title,visible:e.my_is_add,"close-on-click-modal":!1,"custom-class":"depart_aldert_dialog",width:"600px",height:"700px","append-to-body":!0},on:{"update:visible":function(i){e.my_is_add=i},close:e.close}},[s("div",{},[s("el-form",{staticClass:"add_form",attrs:{"label-width":e.form_data.labelWidth+"px","label-position":e.form_data.labelPosition},nativeOn:{submit:function(e){e.preventDefault()}}},[""!=e.form_data.remark?s("el-form-item",{staticClass:"remark_style"}):e._e(),s("el-form-item",{attrs:{required:"",label:"用户名"}},[s("el-select",{staticClass:"assign_input",attrs:{filterable:"",placeholder:"请选择用户","filter-method":e.dataFilterTo},on:{change:function(i){return e.assignChangeTo()}},model:{value:e.touserid,callback:function(i){e.touserid=i},expression:"touserid"}},e._l(e.userlist_to,(function(i){return s("el-option",{key:i.uid,attrs:{label:i.name,value:i.uid}},[s("span",{staticStyle:{float:"left"}},[e._v(e._s(i.name))]),s("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(i.uid))])])})),1)],1),e._l(e.form_data1.fields,(function(i,t){return s("div",{key:i},["divider"==i.tagIcon||"describe"==i.tagIcon||"describeImg"==i.tagIcon?s("el-form-item",["divider"==i.tagIcon?s("div",[s("el-divider")],1):"describe"==i.tagIcon?s("div",[s("el-tag",[e._v(e._s(i.placeholder))])],1):s("div",[s("el-image",{attrs:{src:i.placeholder}})],1)]):"upload"==i.tagIcon?s("el-form-item",{attrs:{"label-width":i.labelWidth>0?i.labelWidth+"px":e.form_data.labelWidth+"px",label:i.label,"label-position":e.form_data.labelPosition,required:i.required}},[s("uploadFile",{attrs:{item:i,fileList:null===i.value?[]:i.value},on:{back_btn:e.back_btn}})],1):"image"==i.tagIcon?s("el-form-item",{attrs:{"label-width":i.labelWidth>0?i.labelWidth+"px":e.form_data.labelWidth+"px",label:i.label,"label-position":e.form_data.labelPosition,required:i.required}},[s("uploadImg",{attrs:{item:i,imgList:null===i.value?[]:i.value},on:{back_btn:e.back_btn}})],1):"calculate"==i.tagIcon?s("el-form-item",{attrs:{"label-width":i.labelWidth>0?i.labelWidth+"px":e.form_data.labelWidth+"px",label:i.label,"label-position":e.form_data.labelPosition}},[s("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(i.label)+" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:i.strlist.join(""),placement:"right"}},[s("i",{staticClass:"el-icon-warning-outline"})])],1),s("span",{staticClass:"calculate_span display_inline_block"},[e._v(" "+e._s(null==i.value?0:i.value)+" ")]),i.enable_assign?s("el-button",{staticClass:"margin_l_15",attrs:{size:"medium",type:"text"},on:{click:function(s){return e.assignClick(i,t)}}},[e._v("分配")]):e._e(),null!=i.assign_data?s("div",[null!=i.assign_data&&0!=i.assign_data.length?s("span",{staticClass:"success"},[e._v(" 未分配值："+e._s(e.calOther(i.value,t,i.assign_data))+" "),s("span",{staticStyle:{color:"#fff"}},[e._v(e._s(e.calOther(i.value,t,i.assign_data))+" ")])]):e._e(),e._l(i.assign_data,(function(l,a){return s("div",{key:l,staticClass:"margin_top_10"},[s("el-select",{staticClass:"assign_input",attrs:{filterable:"",placeholder:"请选择被分配人","filter-method":e.dataFilter},on:{change:function(i){return e.assignChange()}},model:{value:l.ToUserId,callback:function(i){e.$set(l,"ToUserId",i)},expression:"assignitem.ToUserId"}},e._l(e.userlist,(function(i){return s("el-option",{key:i.uid,attrs:{label:i.name,value:i.uid}},[s("span",{staticStyle:{float:"left"}},[e._v(e._s(i.name))]),s("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(i.uid))])])})),1),s("el-input",{staticClass:"assign_input margin_l_15",attrs:{placeholder:"请填写分配数值"},on:{input:function(s){return e.cal(i.value,i.assign_data,t)}},model:{value:l.ToValue,callback:function(i){e.$set(l,"ToValue",i)},expression:"assignitem.ToValue"}}),s("i",{staticClass:"el-icon-remove assign_icon assign_error danger",on:{click:function(s){return e.removeassign(i,a)}}}),a===i.assign_data.length-1?s("i",{staticClass:"el-icon-circle-plus assign_icon assign_add primary",on:{click:function(s){return e.assignClick(i,t)}}}):e._e()],1)}))],2):e._e()],1):"calculate"!=i.tagIcon?s("el-form-item",{attrs:{"label-width":i.labelWidth>0?i.labelWidth+"px":e.form_data.labelWidth+"px",label:i.label,"label-position":e.form_data.labelPosition,required:i.required}},["input"==i.tagIcon?s("div",[s("el-input",{attrs:{placeholder:i.placeholder,maxlength:i.maxlength,size:"medium"},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}})],1):e._e(),"textarea"==i.tagIcon?s("div",[s("el-input",{attrs:{type:"textarea",rows:3,maxlength:i.maxlength,placeholder:i.placeholder},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}})],1):e._e(),"number"==i.tagIcon?s("div",[s("el-input",{attrs:{placeholder:i.placeholder,size:"medium"},on:{input:function(s){return e.enterClick(s,i.assign_data,t)}},model:{value:i.value,callback:function(s){e.$set(i,"value","string"===typeof s?s.trim():s)},expression:"item.value"}}),i.enable_assign?s("el-button",{staticClass:"margin_l_15",attrs:{size:"medium",type:"text"},on:{click:function(s){return e.assignClick(i,t)}}},[e._v("分配")]):e._e(),null!=i.assign_data?s("div",[null!=i.assign_data&&0!=i.assign_data.length?s("span",{staticClass:"success"},[e._v(" 未分配值："+e._s(e.assign_other[t])+" ")]):e._e(),e._l(i.assign_data,(function(l,a){return s("div",{key:l,staticClass:"margin_top_10"},[s("el-select",{staticClass:"assign_input",attrs:{filterable:"",placeholder:"请选择被分配人","filter-method":e.dataFilter},on:{change:function(i){return e.assignChange()}},model:{value:l.ToUserId,callback:function(i){e.$set(l,"ToUserId",i)},expression:"assignitem.ToUserId"}},e._l(e.userlist,(function(i){return s("el-option",{key:i.uid,attrs:{label:i.name,value:i.uid}},[s("span",{staticStyle:{float:"left"}},[e._v(e._s(i.name))]),s("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(i.uid))])])})),1),s("el-input",{staticClass:"assign_input margin_l_15",attrs:{placeholder:"请填写分配数值"},on:{input:function(s){return e.cal(i.value,i.assign_data,t)}},model:{value:l.ToValue,callback:function(i){e.$set(l,"ToValue",i)},expression:"assignitem.ToValue"}}),s("i",{staticClass:"el-icon-remove assign_icon assign_error danger",on:{click:function(s){return e.removeassign(i,a)}}}),a===i.assign_data.length-1?s("i",{staticClass:"el-icon-circle-plus assign_icon assign_add primary",on:{click:function(s){return e.assignClick(i,t)}}}):e._e()],1)}))],2):e._e()],1):e._e(),"date"==i.tagIcon?s("div",[s("el-date-picker",{attrs:{type:"date",placeholder:i.placeholder,size:"medium"},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}})],1):e._e(),"select"==i.tagIcon?s("div",[s("el-select",{attrs:{placeholder:i.placeholder,size:"medium"},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}},e._l(i.options,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"select_number"==i.tagIcon?s("div",[0==i.is_counted?s("span",[e._v(e._s(e.otherfn(i)))]):e._e(),s("el-select",{attrs:{placeholder:i.placeholder,size:"medium"},on:{change:function(i){return e.selectNChage(i)}},model:{value:i.is_counted,callback:function(s){e.$set(i,"is_counted",s)},expression:"item.is_counted"}},e._l(i.options,(function(e){return s("el-option",{key:e.value+"__"+e.label,attrs:{label:e.label,value:("object"==typeof e.value?JSON.stringify(e.value):e.value)+"__"+e.label}})})),1)],1):e._e(),"rate"==i.tagIcon?s("div",[s("el-rate",{attrs:{"allow-half":i["allow-half"]},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}})],1):e._e()]):e._e()],1)}))],2)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(i){e.my_is_add=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(i){return e.submitClick()}}},[e._v("确 定")])],1)]),s("AssignAlert",{attrs:{is_add:e.is_assign,task_code:e.task_code,detail:e.detail},on:{back:e.assignBack,subback:e.assignSubBack}})],1)},l=[],a=(s("4de4"),s("c975"),s("b0c0"),s("b680"),s("d3b7"),s("ac1f"),s("25f0"),s("1276"),s("4841")),o=(s("5a6e"),s("1d57"),s("991d")),f=s("4ad9"),_={name:"fill_alert",props:{is_add:Boolean,form_data:Object,task_code:String},components:{AssignAlert:a["a"],uploadImg:o["a"],uploadFile:f["a"]},data:function(){return{form_data1:{},my_is_add:!1,form_fields:[],assigndetail:{},is_assign:!1,userlist:[],userlist_two:[],userlist_to:[],userlist_two_to:[],uploadKey:"0pc99vFCTZFb-FxnwxuyzbVcmlC_n0qkQ37INru4",uploadToken:"gbNuDHhFDyjIRLDXdJ6HRzp-uc_D6QypslKMJ85m",baseUrl:"http://images.xxxx.cn/",QiniuData:{key:"",token:""},domain:"https://upload-z1.qiniup.com",qiniuaddr:"http://cdn.deepgrid.cn/",uploadPicUrl:"",fileList:[],imgList:[],nowTime:"",fileExtension:"",otherlist:[],assign_other:[],touserid:"",form_fields_select:[],btn_disable:!1}},methods:{back_btn:function(e){this.btn_disable=e},addindex:function(e,i){this.assign_other[e]=i},calOther:function(e,i,s){for(var t in this.assign_other[i]=e,s){if("number"!=typeof s[t].ToValue&&("."==s[t].ToValue.split("")[s[t].ToValue.length-1]||""==s[t].ToValue))break;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(s[t].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;e=this.subtr(e,parseFloat(s[t].ToValue))}return this.assign_other[i]=e,e},cal:function(e,i,s){var t=parseFloat(e);for(var l in i){if("."==i[l].ToValue.split("")[i[l].ToValue.length-1]||""==i[l].ToValue)break;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(i[l].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;t=this.subtr(t,parseFloat(i[l].ToValue))}this.assign_other[s]=t},subtr:function(e,i){var s,t,l,a;try{s=e.toString().split(".")[1].length}catch(o){s=0}try{t=i.toString().split(".")[1].length}catch(o){t=0}return l=Math.pow(10,Math.max(s,t)),a=s>=t?s:t,((e*l-i*l)/l).toFixed(a)},isNum:function(e){if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(e))return this.$alert(" 请填写数字!","提示",{confirmButtonText:"确定"}),e="",!1},removeassign:function(e,i){this.$delete(e.assign_data,i)},addassign:function(e){},assignClick:function(e,i){if(null==e.value||0==e.value)return this.$alert(" 请先填写，再分配!","提示",{confirmButtonText:"确定"}),!1;this.assignChange(),null==e.assign_data?(e.assign_data=[],e["assign_data"].push({ToUserId:"",ToValue:""})):e["assign_data"].push({ToUserId:"",ToValue:""})},otherfn:function(e){return e.is_counted="",e.join_gather="",""},close:function(){this.my_is_add=!1},selectNChage:function(e){this.subClick()},enterClick:function(e,i,s){return"."!=e.split("")[e.length-1]&&""!=e&&(/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(e)?(this.cal(e,i,s),void this.subClick()):(this.$alert(" 请填写数字!","提示",{confirmButtonText:"确定"}),!1))},getnowdate:function(e){var i=new Date(e),s=i.getFullYear(),t=i.getMonth()+1,l=i.getDate();return t<10&&(t="0"+t),l<10&&(l="0"+l),s+"/"+t+"/"+l},countselected:function(e){var i=this,s=[];for(var t in this.form_fields)if(this.form_fields[t].required)if("number"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].value)});else{if("divider"==this.form_fields[t].tagIcon||"describe"==this.form_fields[t].tagIcon||"describeImg"==this.form_fields[t].tagIcon)continue;"select_number"==this.form_fields[t].tagIcon?this.form_fields[t].is_counted.split("]}__").length<2?s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].is_counted.split("__")[0])}):(this.form_fields[t].join_gather,s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].join_gather)})):"date"==this.form_fields[t].tagIcon?s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.getnowdate(this.form_fields[t].value)}):"image"==this.form_fields[t].tagIcon?s.push({field_code:this.form_fields[t].filed_code,opt_label:"image",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:!1,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value}):"upload"==this.form_fields[t].tagIcon?s.push({field_code:this.form_fields[t].filed_code,opt_label:"file",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:!1,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value}):s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value})}else if("number"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].value)});else if("select_number"==this.form_fields[t].tagIcon)this.form_fields[t].is_counted.split("]}__").length<2?s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].is_counted.split("__")[0])}):(this.form_fields[t].join_gather,s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].join_gather)}));else if("date"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.getnowdate(this.form_fields[t].value)});else if("image"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,opt_label:"image",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value});else if("upload"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,opt_label:"file",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value});else{if("divider"==this.form_fields[t].tagIcon||"describe"==this.form_fields[t].tagIcon||"describeImg"==this.form_fields[t].tagIcon)continue;var l=this.form_fields[t].enable_assign;s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:l,value:this.form_fields[t].value})}var a=JSON.parse(e.is_counted.split("__")[0]).str_id_list,o=this,f={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,file_info:JSON.stringify(s),formula_method:JSON.stringify(a)},_=o.$createObj(f),r=_["keyvalue"],d=o.$apilist["countselected"]+"?signature="+r;o.$server.post(d,_["fd"]).then((function(s){e.join_gather=s.data,i.subClickTwo()})).catch((function(e){}))},subClick:function(){var e=this;for(var i in this.form_fields_select)this.form_fields_select[i].is_counted.split("]}__").length>1&&this.countselected(this.form_fields_select[i]);var s=[];for(var t in this.form_fields)if(this.form_fields[t].required)if("number"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].value)});else{if("divider"==this.form_fields[t].tagIcon||"describe"==this.form_fields[t].tagIcon||"describeImg"==this.form_fields[t].tagIcon)continue;"select_number"==this.form_fields[t].tagIcon?this.form_fields[t].is_counted.split("]}__").length<2?s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].is_counted.split("__")[0])}):(this.form_fields[t].join_gather,s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].join_gather)})):"date"==this.form_fields[t].tagIcon?s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.getnowdate(this.form_fields[t].value)}):"image"==this.form_fields[t].tagIcon?s.push({field_code:this.form_fields[t].filed_code,opt_label:"image",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:!1,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value}):"upload"==this.form_fields[t].tagIcon?s.push({field_code:this.form_fields[t].filed_code,opt_label:"file",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:!1,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value}):s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value})}else if("number"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].value)});else if("select_number"==this.form_fields[t].tagIcon)this.form_fields[t].is_counted.split("]}__").length<2?s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].is_counted.split("__")[0])}):(this.form_fields[t].join_gather,s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].join_gather)}));else if("date"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.getnowdate(this.form_fields[t].value)});else if("image"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,opt_label:"image",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value});else if("upload"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,opt_label:"file",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value});else{if("divider"==this.form_fields[t].tagIcon||"describe"==this.form_fields[t].tagIcon||"describeImg"==this.form_fields[t].tagIcon)continue;var l=this.form_fields[t].enable_assign;s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:l,value:this.form_fields[t].value})}var a=this,o={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,rule_file_info:JSON.stringify(s)},f=a.$createObj(o),_=f["keyvalue"],r=a.$apilist["countfunction"]+"?signature="+_;a.$server.post(r,f["fd"]).then((function(i){if(i.data.length>0)for(var s in i.data)for(var t in e.form_data1.fields)e.form_data1.fields[t].filed_code==i.data[s].field_code&&(e.form_data1.fields[t].value=i.data[s].value)})).catch((function(e){}))},subClickTwo:function(){var e=this,i=[];for(var s in this.form_fields)if(this.form_fields[s].required)if("number"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)});else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;"select_number"==this.form_fields[s].tagIcon?this.form_fields[s].is_counted.split("]}__").length<2?i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])}):(this.form_fields[s].join_gather,i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].join_gather)})):"date"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)}):"image"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):"upload"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value})}else if("number"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)});else if("select_number"==this.form_fields[s].tagIcon)this.form_fields[s].is_counted.split("]}__").length<2?i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])}):(this.form_fields[s].join_gather,i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].join_gather)}));else if("date"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)});else if("image"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else if("upload"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;var t=this.form_fields[s].enable_assign;i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:t,value:this.form_fields[s].value})}var l=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,rule_file_info:JSON.stringify(i)},o=l.$createObj(a),f=o["keyvalue"],_=l.$apilist["countfunction"]+"?signature="+f;l.$server.post(_,o["fd"]).then((function(i){if(i.data.length>0)for(var s in i.data)for(var t in e.form_data1.fields)e.form_data1.fields[t].filed_code==i.data[s].field_code&&(e.form_data1.fields[t].value=i.data[s].value)})).catch((function(e){}))},submitClick:function(){var e=this,i=[];if(""==this.touserid)return this.$alert("请选择用户！","提示",{confirmButtonText:"确定"}),!1;for(var s in this.form_fields)if(this.form_fields[s].required){if("select_number"==this.form_fields[s].tagIcon){if(0==this.form_fields[s].is_counted)return this.$alert("请选择 "+this.form_fields[s].label+" !","提示",{confirmButtonText:"确定"}),!1}else if("number"==this.form_fields[s].tagIcon){if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].value))return this.$alert(this.form_fields[s].label+" 请填写数字!","提示",{confirmButtonText:"确定"}),!1}else if((null==this.form_fields[s].value||""==this.form_fields[s].value)&&"divider"!=this.form_fields[s].tagIcon&&"describe"!=this.form_fields[s].tagIcon&&"describeImg"!=this.form_fields[s].tagIcon)return this.$alert("请填写1 "+this.form_fields[s].label+" !","提示",{confirmButtonText:"确定"}),!1;if("number"==this.form_fields[s].tagIcon){for(var t in this.form_fields[s].assign_data){if(""==this.form_fields[s].assign_data[t].ToUserId||""==this.form_fields[s].assign_data[t].ToValue)return this.$alert(this.form_fields[s].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].assign_data[t].ToValue))return this.$alert(" 分配值请填写数字1!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[s].assign_data[t].ToValue=parseFloat(this.form_fields[s].assign_data[t].ToValue)}i.push({field_code:this.form_fields[s].filed_code,assign_data:this.form_fields[s].assign_data,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)})}else if("calculate"==this.form_fields[s].tagIcon){for(var l in this.form_fields[s].assign_data){if(""==this.form_fields[s].assign_data[l].ToUserId||""==this.form_fields[s].assign_data[l].ToValue)return this.$alert(this.form_fields[s].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].assign_data[l].ToValue))return this.$alert(" 分配值请填写数字2!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[s].assign_data[l].ToValue=parseFloat(this.form_fields[s].assign_data[l].ToValue)}i.push({field_code:this.form_fields[s].filed_code,assign_data:this.form_fields[s].assign_data,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)})}else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;"select_number"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])}):"date"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)}):"image"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):"upload"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value})}}else if("number"==this.form_fields[s].tagIcon){for(var a in this.form_fields[s].assign_data){if(""==this.form_fields[s].assign_data[a].ToUserId||""==this.form_fields[s].assign_data[a].ToValue)return this.$alert(this.form_fields[s].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].assign_data[a].ToValue))return this.$alert(" 分配值请填写数字3!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[s].assign_data[a].ToValue=parseFloat(this.form_fields[s].assign_data[a].ToValue)}i.push({field_code:this.form_fields[s].filed_code,assign_data:this.form_fields[s].assign_data,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)})}else if("calculate"==this.form_fields[s].tagIcon){for(var o in this.form_fields[s].assign_data){if(""==this.form_fields[s].assign_data[o].ToUserId||""==this.form_fields[s].assign_data[o].ToValue)return this.$alert(this.form_fields[s].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].assign_data[o].ToValue))return this.$alert(" 分配值请填写数字4!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[s].assign_data[o].ToValue=parseFloat(this.form_fields[s].assign_data[o].ToValue)}i.push({field_code:this.form_fields[s].filed_code,assign_data:this.form_fields[s].assign_data,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)})}else if("select_number"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])});else if("date"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)});else if("image"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else if("upload"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;var f=this.form_fields[s].enable_assign;i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:f,value:this.form_fields[s].value})}var _=this,r={corpid:this.$store.state.corpid,userid:this.touserid,admin_userid:this.$store.state.userid,form_code:this.form_data.form_code,form_field_info:JSON.stringify(i),task_code:this.task_code},d=_.$createObj(r),n=d["keyvalue"],h=_.$apilist["adminaddone"]+"?signature="+n;_.$server.post(h,d["fd"]).then((function(i){e.$message({message:"添加成功！",type:"success"}),e.fileList=[],e.$emit("subback"),e.close()})).catch((function(e){}))},dataFilter:function(e){this.userlist=this.userlist_two.filter((function(i){if(-1!==i.uid.indexOf(e)||-1!==i.name.indexOf(e))return!0}))},dataFilterTo:function(e){this.userlist_to=this.userlist_two_to.filter((function(i){if(-1!==i.uid.indexOf(e)||-1!==i.name.indexOf(e))return!0}))},assignChangeTo:function(){this.userlist=this.userlist_two},assignChange:function(){this.userlist=this.userlist_two},alluser:function(){var e=this,i=this,s={corpid:this.$store.state.corpid,userid:this.$store.state.userid},t=i.$createObj(s),l=t["keyvalue"],a=i.$apilist["allusernameandid"]+"?signature="+l;i.$server.post(a,t["fd"]).then((function(i){e.userlist=i.data,e.userlist_two=Object.assign(i.data),e.userlist_to=Object.assign(i.data),e.userlist_two_to=Object.assign(i.data)})).catch((function(e){}))}},created:function(){},mounted:function(){this.alluser()},watch:{is_add:function(e){if(this.my_is_add=e,e)for(var i in this.form_data1=JSON.parse(JSON.stringify(this.form_data)),this.form_fields=this.form_data1.fields,this.form_fields_select=[],this.form_fields)"select_number"==this.form_fields[i].tagIcon&&this.form_fields_select.push(this.form_fields[i])},my_is_add:function(e){this.$emit("back",e)}}},r=_,d=(s("879b"),s("2877")),n=Object(d["a"])(r,t,l,!1,null,null,null);i["a"]=n.exports},"5f87":function(e,i,s){"use strict";s.d(i,"a",(function(){return a}));var t=s("a78e"),l=s.n(t);function a(e){return l.a.get(e)}},"6a47":function(e,i,s){},"879b":function(e,i,s){"use strict";s("6a47")}}]);