(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58557ef5"],{"10aa":function(t,e,i){},6011:function(t,e,i){"use strict";i("10aa")},a0b1:function(t,e,i){"use strict";i("fbd8")},eee9:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"formlist_fill"},[i("div",{staticClass:"top_form"},[i("span",{staticClass:"name_span",attrs:{span:""},on:{click:function(e){return t.tabClick(2)}}},[t._v("数据")]),i("span",{staticClass:"right"},[i("el-button",{attrs:{icon:"iconfont icon-cancel",size:"small"},on:{click:function(e){return t.back()}}},[t._v("返回")])],1)]),t.is_tab?i("div",t._l(t.sortFun(t.formlist),(function(e){return i("div",{key:e,staticClass:"type_div"},[i("p",{staticClass:"title_form"},[i("span",{on:{click:function(i){return t.typeEditorClick(e,t.formlist[e][0].TypeContent)}}},[t._v(" "+t._s(t.formlist[e][0].TypeContent)+" ")])]),i("div",{staticClass:"clearfix"}),1==t.isStr(t.formlist[e])?i("ul",{staticClass:"eform-list clearfix"},t._l(t.formlist[e],(function(e){return i("li",{key:e,on:{mouseover:function(e){return t.mouseOver(e)},mouseleave:function(e){return t.mouseLeave(e)}}},[i("div",{staticClass:"list_box"},[i("div",{staticClass:"content_list_item"},[i("p",{staticClass:"p_over left width_150",attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(e.Title)+" ")]),e.DenyCount>0?i("p",{staticClass:"right other_count"},[t._v(" "+t._s(e.DenyCount)+" ")]):t._e(),i("div",{staticClass:"clearfix"})]),i("div",[i("div",{staticClass:"left other_left"},[i("p",[t._v("已填报数："+t._s(e.AllCount))]),i("p",[t._v("待审批数："+t._s(e.CommitCount))])]),i("ul",{staticClass:"operation flex right"},[i("li",{on:{click:function(i){return t.goClick(e)}}},[i("span",[t._v("进入")])])])])])])})),0):t._e(),i("div",{staticClass:"clearfix"})])})),0):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.is_tab,expression:"!is_tab"}]},[i("data-tables",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{data:t.tableData,"pagination-props":{pageSizes:[5,10,15]},"row-key":t.row_key,"expand-row-keys":t.expandRowKeys,"table-props":t.tableProps},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{label:"工号",prop:"CreateUserId"}}),i("el-table-column",{attrs:{label:"姓名",prop:"CreateUserName"}}),i("el-table-column",{attrs:{label:"内容"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.FormFieldInfos,(function(e,a){return i("div",{key:e},[a<3?i("p",{staticClass:"flow-subtitle"},[""!=e.opt_label&&"image"!=e.opt_label&&"file"!=e.opt_label?i("span",[t._v(" "+t._s(e.field_label)+":"+t._s(e.opt_label.split("__")[1])+" ")]):"image"==e.opt_label||"file"==e.opt_label?i("span",[t._v(" "+t._s(e.field_label)+": "),e.value.length>1?i("span",[t._v(t._s(e.value[0].name)+"...")]):1==e.value.length?i("span",[t._v(t._s(e.value[0].name))]):i("span",[t._v("-")])]):i("span",[t._v(" "+t._s(e.field_label)+":"+t._s(e.value)+" ")])]):t._e()])}))}}])}),i("el-table-column",{attrs:{label:"表单名",prop:"FormName"}}),i("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"flow-permisson-row"},[i("span",[0==e.row.State?i("span",{staticClass:"flow_per"},[t._v("未提交")]):1==e.row.State?i("span",{staticClass:"flow_per warning"},[t._v("已提交 ")]):2==e.row.State?i("span",{staticClass:"flow_per danger"},[t._v("驳回")]):3==e.row.State?i("span",{staticClass:"flow_per success"},[t._v("已通过")]):4==e.row.State?i("span",{staticClass:"flow_per warning"},[t._l(e.row.AuditStates,(function(a,s){return i("span",{key:a},[i("span",[t._v(t._s(a.user_info[0].name))]),s<e.row.AuditStates.length-1?i("span",[t._v("/")]):t._e()])})),t._v(" 审核中")],2):5==e.row.State?i("span",{staticClass:"flow_per success"},[t._v("已通过")]):6==e.row.State?i("span",{staticClass:"flow_per"},[t._v("导入数据")]):t._e()])])]}}])}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-link",{attrs:{type:"primary"},on:{click:function(i){return t.detailClick(e.row)}}},[t._v("详情")])]}}])})],1),i("div",{staticClass:"clearfix"})],1),i("DetailAlert",{attrs:{is_add:t.is_detail,detail:t.detail,form_data:t.formdetail,is_flag:"2"},on:{back:t.detailBack,otherback:t.otherDetailBack}}),i("LogAlert",{attrs:{is_add:t.is_log,code:t.logcode},on:{back:t.logBack}})],1)},s=[],l=(i("99af"),i("b0c0"),i("b64b"),i("ade3")),o=i("5a6e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-dialog",{staticClass:"detail_alert_dialog",attrs:{title:"详情",visible:t.my_is_add,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(e){t.my_is_add=e}}},[i("div",{staticClass:"form_other_detail"},[i("el-row",[i("el-col",{attrs:{span:24}},[t._v("表单名："+t._s(t.detail.FormName))]),i("el-col",{attrs:{span:12}},[t._v("创建人："+t._s(t.detail.CreateUserName))]),i("el-col",{attrs:{span:12}},[t._v("创建时间："+t._s(new Date(t.detail.CreateTime).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"").split(" ")[0]))])],1)],1),t.detail_arr.length>0?i("el-table",{attrs:{data:t.detail_arr,border:"","header-cell-style":{background:"#eef1f6",color:"#606266"}}},[i("el-table-column",{attrs:{prop:"name",width:"150",label:"字段"},scopedSlots:t._u([{key:"default",fn:function(e){return[null!=e.row.str_list&&e.row.str_list.length>0?i("span",[t._v(" "+t._s(e.row.name)+" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.row.str_list.join(""),placement:"right"}},[i("i",{staticClass:"el-icon-warning-outline cursor"})])],1):i("span",[t._v(" "+t._s(e.row.name))])]}}],null,!1,2062905585)}),i("el-table-column",{attrs:{prop:"value",label:"数值"},scopedSlots:t._u([{key:"default",fn:function(e){return[""!==e.row.opt_label&&"image"!==e.row.opt_label&&"file"!==e.row.opt_label?i("p",[t._v(" "+t._s(e.row.opt_label.split("__")[1])+" ")]):"image"==e.row.opt_label?i("div",t._l(e.row.value,(function(t){return i("span",{key:t,staticClass:"margin_r_10 display_block"},[i("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.url,"preview-src-list":e.row.enable_greater}})],1)})),0):"file"==e.row.opt_label?i("div",t._l(e.row.value,(function(e){return i("div",{key:e},[i("p",[i("span",{staticClass:"upload_list_span",on:{click:function(i){return t.goimg(e.url)}}},[t._v(" "+t._s(e.name)+" ")])])])})),0):i("p",[t._v(t._s(e.row.value))]),null!=e.row.assign_data&&e.row.assign_data.length>0?i("div",[i("el-table",{attrs:{data:e.row.assign_data,border:""}},[i("el-table-column",{attrs:{label:"被分配人",prop:"ToUserName"}}),i("el-table-column",{attrs:{label:"被分配值",prop:"ToValue"}})],1)],1):t._e()]}}],null,!1,3791008091)})],1):t._e(),i("el-form",{staticClass:"auditform",attrs:{"label-width":"150px"},nativeOn:{submit:function(t){t.preventDefault()}}},[null!=t.detail.AuditStates?i("el-form-item",{staticClass:"audit_item",attrs:{label:"审批流程：","label-width":"200px"}},[i("div",{staticClass:"audit_div"},[i("el-timeline",t._l(t.detail.AuditStates,(function(e,a){return i("el-timeline-item",{key:a,attrs:{color:0==e.node_state?"#0bbd87":"#D6D6D6"}},[i("div",[i("div",{staticClass:"left"},[i("p",{staticClass:"audit_title"},[t._v("审批人")]),i("p",{staticClass:"audit_num"},[t._v(" "+t._s(e.userids.length)+"人 "),i("span",[t._v(t._s(0==e.node_state?"(已审批)":"(待审批)"))])])]),i("div",{staticClass:"right"},t._l(e.user_info,(function(a,s){return i("span",{key:a},[t._v(" "+t._s(a.name)+" "),s<e.userids.length-1?i("span",[t._v("/")]):t._e()])})),0)])])})),1)],1)]):t._e()],1)],1),i("EditorDetailAlert",{attrs:{is_add:t.is_editor,form_data:t.detail,detail:t.detail,main_code:t.main_code,task_code:t.detail.TaskCode},on:{back:t.editorBack,subback:t.editorSubBack}}),i("LogAlert",{attrs:{is_add:t.is_log,code:t.logcode},on:{back:t.logBack}})],1)},r=[],c=(i("a9e3"),i("498a"),i("690f")),d=i("3ec3"),u={name:"detail_alert_dialog",props:{is_add:Boolean,detail:Object,is_flag:Number},components:{EditorDetailAlert:c["a"],LogAlert:d["a"]},data:function(){return{tableProps:{border:!0,"header-cell-style":{background:"#eef1f6",color:"#606266"}},my_is_add:!1,is_editor:!1,activeName:"",assignlist:[],logcode:"",is_log:!1,main_code:"",detail_arr:[]}},methods:{goimg:function(t){return window.open(t),!1},logClick:function(t){this.logcode=t,this.is_log=!this.is_log},logBack:function(t){this.is_log=t},editorClick:function(t){this.main_code=t,this.is_editor=!this.is_editor},editorSubBack:function(){this.$emit("otherback"),this.my_is_add=!this.my_is_add},editorBack:function(t){this.is_editor=t},addClick:function(t){var e=this,i=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,main_code:t},s=i.$createObj(a),l=s["keyvalue"],o=i.$apilist["approveone"]+"?signature="+l;i.$server.post(o,s["fd"]).then((function(t){e.$message({type:"success",message:"通过成功!"}),e.editorSubBack()})).catch((function(t){}))},delClick:function(t){var e=this;this.$confirm("删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=e,a={corpid:e.$store.state.corpid,userid:e.$store.state.userid,code:t},s=i.$createObj(a),l=s["keyvalue"],o=i.$apilist["delone_main"]+"?signature="+l;i.$server.post(o,s["fd"]).then((function(){e.$message({type:"success",message:"删除成功!"}),e.$emit("otherback"),e.my_is_add=!e.my_is_add})).catch((function(t){}))})).catch((function(){}))},callbackone:function(t){var e=this;this.$prompt("退回理由","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(i){var a=i.value,s=e,l={corpid:e.$store.state.corpid,userid:e.$store.state.userid,main_code:t};null!=a&&""!=a.trim&&(l["content"]=a);var o=s.$createObj(l),n=o["keyvalue"],r=s.$apilist["denyone"]+"?signature="+n;s.$server.post(r,o["fd"]).then((function(){e.$message({type:"success",message:"退回成功!"}),e.$emit("otherback"),e.my_is_add=!e.my_is_add})).catch((function(t){}))})).catch((function(){e.$message({type:"info",message:"取消退回！"})}))},getimgurl:function(t,e){for(var i in e.enable_greater=[],e.value)e.enable_greater.push(e.value[i].url)}},watch:{is_add:function(t){if(this.my_is_add=t,t)for(var e in this.detail_arr=[],this.detail.FormFieldInfos){if("image"==this.detail.FormFieldInfos[e].opt_label||"file"==this.detail.FormFieldInfos[e].opt_label)for(var i in this.enable_assign=[],this.detail.FormFieldInfos[e].enable_greater=[],this.detail.FormFieldInfos[e].value)this.getimgurl(this.detail.FormFieldInfos[e].value[i],this.detail.FormFieldInfos[e]);this.detail_arr.push({name:this.detail.FormFieldInfos[e].field_label,str_list:this.detail.FormFieldInfos[e].str_list,value:this.detail.FormFieldInfos[e].value,assign_data:this.detail.FormFieldInfos[e].assign_data,opt_label:this.detail.FormFieldInfos[e].opt_label,enable_greater:this.detail.FormFieldInfos[e].enable_greater})}},my_is_add:function(t){this.$emit("back",t)}}},f=u,_=(i("a0b1"),i("2877")),m=Object(_["a"])(f,n,r,!1,null,null,null),h=m.exports,p={name:"formlist_fill",components:{DetailAlert:h,LogAlert:d["a"]},data:function(){var t;return t={loading:!1,task_code:"",formlist:[],is_tab:!1,tableData:[]},Object(l["a"])(t,"loading",!1),Object(l["a"])(t,"filed_infos",[]),Object(l["a"])(t,"tableProps",{border:!0,"header-cell-style":{background:"#eef1f6",color:"#606266"}}),Object(l["a"])(t,"is_detail",!1),Object(l["a"])(t,"detail",{}),Object(l["a"])(t,"is_add",!1),Object(l["a"])(t,"formdetail",{}),Object(l["a"])(t,"is_editor",!1),Object(l["a"])(t,"main_code",""),Object(l["a"])(t,"dellist",""),Object(l["a"])(t,"auditlist",""),Object(l["a"])(t,"auditkey",""),Object(l["a"])(t,"codeval",""),Object(l["a"])(t,"dialogTableVisible",!1),Object(l["a"])(t,"select_depart",""),Object(l["a"])(t,"select_auditcode",""),t},methods:{back:function(){var t=Object(o["a"])(this.$route.query.num);1==t?this.$router.push({name:"sumlistAudit"}):2==t&&this.$router.push({name:"sumDept"})},gourl:function(){this.$router.push({name:"sumFill",query:{id:this.$route.query.id,name:this.$route.query.name}})},otherDetailBack:function(){this.allmaindatabyformcodeanduserid()},auditSelectClick:function(){this.select_auditcode="",this.audit_key_list=this.auditlist[this.select_depart].conditions},auditSubmitClick:function(){if(""==this.select_auditcode)return this.$alert("请选择审批流程！","提示",{confirmButtonText:"确定"}),!1;1==this.num?this.commitmaindatawithnodecode(this.codeval):this.batchcommitmaindatawithnodecode(this.codeval)},commitmaindatawithnodecode:function(t){var e=this,i=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,main_code:t,depart_code:this.select_depart,node_code:this.select_auditcode},s=i.$createObj(a),l=s["keyvalue"],o=i.$apilist["commitmaindatawithnodecode"]+"?signature="+l;i.$server.post(o,s["fd"]).then((function(){e.dialogTableVisible=!1,e.$message({type:"success",message:"提交成功!"}),e.allmaindatabyformcodeanduserid()})).catch((function(t){}))},batchcommitmaindatawithnodecode:function(t){var e=this,i=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,main_codes:JSON.stringify(t),depart_code:this.select_depart,node_code:this.select_auditcode},s=i.$createObj(a),l=s["keyvalue"],o=i.$apilist["batchcommitmaindatawithnodecode"]+"?signature="+l;i.$server.post(o,s["fd"]).then((function(t){e.dialogTableVisible=!1,70002==t.data?e.$alert(t.message,"提示",{confirmButtonText:"确定",callback:function(t){e.allmaindatabyformcodeanduserid()}}):(e.$message({type:"success",message:"提交成功!"}),e.allmaindatabyformcodeanduserid())})).catch((function(t){}))},handleSelectionChange:function(t){this.dellist=t},addListClick:function(){if(0==this.dellist.length)return this.$alert("请选择提交内容！","提示",{confirmButtonText:"确定"}),!1;var t=[];for(var e in this.dellist)t.push(this.dellist[e].Code);this.submitClick(t,2)},submitClick:function(t,e){this.dialogTableVisible=!this.dialogTableVisible,this.num=e,this.codeval=t},getauditlist:function(){var t=this,e=this,i={corpid:this.$store.state.corpid,userid:this.$store.state.userid,task_code:this.task_code},a=e.$createObj(i),s=a["keyvalue"],l=e.$apilist["getauditlist"]+"?signature="+s;e.$server.post(l,a["fd"]).then((function(e){t.auditlist=e.data,t.auditkey=Object.keys(e.data)})).catch((function(t){}))},batchdel:function(){var t=this;if(0==this.dellist.length)return this.$alert("请选择要删除的数据","提示",{confirmButtonText:"确定"}),!1;this.$confirm("此操作将永久删除数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=[];for(var i in t.dellist)e.push(t.dellist[i].Code);var a=t,s={corpid:t.$store.state.corpid,userid:t.$store.state.userid,main_codes:JSON.stringify(e)},l=a.$createObj(s),o=l["keyvalue"],n=a.$apilist["batchdel"]+"?signature="+o;a.$server.post(n,l["fd"]).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.dellist=[],t.allmaindatabyformcodeanduserid()})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}))},delClick:function(t){var e=this;this.$confirm("删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=e,a={corpid:e.$store.state.corpid,userid:e.$store.state.userid,code:t},s=i.$createObj(a),l=s["keyvalue"],o=i.$apilist["delone_main"]+"?signature="+l;i.$server.post(o,s["fd"]).then((function(){e.allmaindatabyformcodeanduserid(),e.$message({type:"success",message:"删除成功!"})})).catch((function(t){}))})).catch((function(){}))},ediotrFillClick:function(t){this.main_code=t.Code,this.detail=t,this.getformdetail(t.FormCode)},getformdetail:function(t){var e=this,i=this;this.name=this.$route.query.name;var a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:t},s=i.$createObj(a),l=s["keyvalue"],o=i.$apilist["formdetail"]+"?signature="+l;i.$server.post(o,s["fd"]).then((function(i){e.formdetail=i.data,e.formdetail.form_code=t,e.is_editor=!e.is_editor})).catch((function(t){}))},fillEBack:function(t){this.is_editor=t},subFillEBack:function(){this.allmaindatabyformcodeanduserid()},subFillBack:function(){this.allmaindatabyformcodeanduserid()},fillClick:function(){this.is_add=!this.is_add},fillBack:function(t){this.is_add=t},detailClick:function(t){this.is_detail=!this.is_detail,this.detail=t},detailBack:function(t){this.is_detail=t},goClick:function(t){this.$router.push({name:"filllistFill",query:{name:t.Title,taskname:this.$route.query.name,id:Object(o["b"])(t.Code),taskcode:this.$route.query.id}})},tabClick:function(t){this.is_tab=1==t},isStr:function(t){return"string"!=typeof t?1:234},sortFun:function(t){var e=[],i=[],a=Object.keys(t);for(var s in a)"string"==typeof t[a[s]]?i.push(a[s]):e.push(a[s]);return e.concat(i.reverse())},mouseOver:function(t){t.currentTarget.className="  active"},mouseLeave:function(t){t.currentTarget.className=""},getselfformlist:function(){var t=this,e=this;this.task_code=Object(o["a"])(this.$route.query.id);var i={corpid:this.$store.state.corpid,userid:this.$store.state.userid,task_code:this.task_code},a=e.$createObj(i),s=a["keyvalue"],l=e.$apilist["getselfformlist"]+"?signature="+s;e.$server.post(l,a["fd"]).then((function(e){t.formlist=e.data})).catch((function(t){}))},allmaindatabyformcodeanduserid:function(){var t=this,e=this;this.task_code=Object(o["a"])(this.$route.query.id);var i={corpid:this.$store.state.corpid,userid:Object(o["a"])(this.$route.query.userid),task_code:this.task_code},a=e.$createObj(i),s=a["keyvalue"],l=e.$apilist["allmaindatabyformcodeanduserid"]+"?signature="+s;this.loading=!0,e.$server.post(l,a["fd"]).then((function(e){if(t.tableData=e.data,t.select_depart="",t.select_auditcode="",t.loading=!1,0==e.data.length){for(var i in t.filed_infos=[],e.filed_infos)t.filed_infos.push({label:e.filed_infos[i].label});t.filed_infos.push({label:"状态"}),t.filed_infos.push({label:"操作"})}})).catch((function(t){}))}},mounted:function(){var t=this.$route.query.other;1==t&&(this.is_tab=!1),this.getselfformlist(),this.allmaindatabyformcodeanduserid(),this.getauditlist()}},b=p,v=(i("6011"),Object(_["a"])(b,a,s,!1,null,null,null));e["default"]=v.exports},fbd8:function(t,e,i){}}]);