(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-531215cf"],{"033a":function(t,e,i){},"572c":function(t,e,i){"use strict";i("033a")},"79a7":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"form_list_fill"},[t.is_more?t._e():i("div",[i("div",{staticClass:"top_form"},[i("span",{staticClass:"name_span"},[t._v(t._s(t.name)+"表单")]),i("span",{staticClass:"right"},[i("el-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"small"},on:{click:function(e){return t.fillClick()}}},[t._v("添加")]),i("el-button",{attrs:{icon:"el-icon-s-promotion",size:"small"},on:{click:function(e){return t.addListClick()}}},[t._v("提交")]),i("el-button",{attrs:{icon:"el-icon-delete",size:"small"},on:{click:function(e){return t.batchdel()}}},[t._v("删除")]),i("router-link",{staticClass:"margin_l_15",attrs:{to:{name:"formlistFill",query:{id:t.$route.query.taskcode,k:Date.now(),name:t.$route.query.taskname,num:t.$route.query.num}}}},[i("el-button",{attrs:{icon:"iconfont icon-cancel",size:"small"}},[t._v("返回")])],1)],1)]),0==t.tableData.length?i("div",{staticClass:"text_center"},[i("data-tables",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.tableData,"pagination-props":{pageSizes:[5,10,15]},"row-key":t.row_key,"expand-row-keys":t.expandRowKeys,"table-props":t.tableProps},on:{"selection-change":t.handleSelectionChange}},t._l(t.filed_infos,(function(t){return i("el-table-column",{key:t,attrs:{label:t.label}})})),1)],1):i("div",[i("data-tables",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.tableData,"pagination-props":{pageSizes:[5,10,15]},"row-key":t.row_key,"expand-row-keys":t.expandRowKeys,"table-props":t.tableProps},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"65"}}),t._l(t.tableData[0].FormFieldInfos,(function(e,a){return i("el-table-column",{directives:[{name:"show",rawName:"v-show",value:"describe"!=e.tagIcon,expression:"item.tagIcon != 'describe'"}],key:e,attrs:{prop:"name",label:e.field_label},scopedSlots:t._u([{key:"default",fn:function(e){return[""!=e.row.FormFieldInfos[a].opt_label&&"image"!=e.row.FormFieldInfos[a].opt_label&&"file"!=e.row.FormFieldInfos[a].opt_label?i("p",[t._v(" "+t._s(e.row.FormFieldInfos[a].opt_label.split("__")[1])+" ")]):null!=e.row.FormFieldInfos[a].assign_data&&e.row.FormFieldInfos[a].assign_data.length>0?i("div",[t._v(" "+t._s(e.row.FormFieldInfos[a].value)+" ")]):"image"==e.row.FormFieldInfos[a].opt_label||"file"==e.row.FormFieldInfos[a].opt_label?i("div",t._l(e.row.FormFieldInfos[a].value,(function(e){return i("p",{key:e},[i("span",{staticClass:"upload_list_span cursor",on:{click:function(i){return t.goimg(e.url)}}},[t._v(" "+t._s(e.name)+" ")])])})),0):i("p",[t._v(" "+t._s(e.row.FormFieldInfos[a].value)+" ")])]}}],null,!0)})})),i("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"flow-permisson-row"},[i("span",{staticClass:"cursor",on:{click:function(i){return t.logClick(e.row.Code)}}},[0==e.row.State?i("span",{staticClass:"flow_per"},[t._v("未提交")]):1==e.row.State?i("span",{staticClass:"flow_per warning"},[t._v("已提交")]):2==e.row.State?i("span",{staticClass:"flow_per danger"},[t._v("驳回")]):3==e.row.State?i("span",{staticClass:"flow_per success"},[t._v("已通过")]):4==e.row.State?i("span",{staticClass:"flow_per warning"},[t._v("审核中")]):5==e.row.State?i("span",{staticClass:"flow_per success"},[t._v("已通过")]):6==e.row.State?i("span",{staticClass:"flow_per"},[t._v("导入数据")]):t._e()]),1==e.row.AssignState?i("span",{staticClass:"margin_l_5 flow_per"},[t._v("(分配未完成)")]):t._e()])]}}],null,!1,1001985526)}),i("el-table-column",{attrs:{prop:"address",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-dropdown",[i("span",{staticClass:"el-dropdown-link"},[i("i",{staticClass:"el-icon-more"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",[i("p",{on:{click:function(i){return t.detailClick(e.row)}}},[t._v("详情")])]),0==e.row.State||2==e.row.State||6==e.row.State?i("el-dropdown-item",[i("p",{on:{click:function(i){return t.submitClick(e.row.Code,1)}}},[t._v(" 提交 ")])]):t._e(),0==e.row.State||2==e.row.State||6==e.row.State?i("el-dropdown-item",[i("p",{on:{click:function(i){return t.ediotrFillClick(e.row)}}},[t._v(" 编辑 ")])]):t._e(),i("el-dropdown-item",[i("p",{on:{click:function(i){return t.delClick(e.row.Code)}}},[t._v(" 删除 ")])])],1)],1)]}}],null,!1,4284722510)})],2)],1)]),i("el-dialog",{staticClass:"audit_dialog",attrs:{title:"选择审批",visible:t.dialogTableVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[i("el-form",{staticClass:"auditform",attrs:{"label-width":"80px"},nativeOn:{submit:function(t){t.preventDefault()}}},[i("el-form-item",{attrs:{label:"部门"}},[i("el-select",{attrs:{placeholder:"请选择",filterable:""},on:{change:function(e){return t.auditSelectClick()}},model:{value:t.select_depart,callback:function(e){t.select_depart=e},expression:"select_depart"}},t._l(t.auditkey,(function(e){return i("el-option",{key:e,attrs:{label:t.auditlist[e].depart_name,value:e}})})),1)],1),i("el-form-item",{attrs:{label:"审批"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.select_auditcode,callback:function(e){t.select_auditcode=e},expression:"select_auditcode"}},t._l(t.audit_key_list,(function(t){return i("el-option",{key:t.NodeCode,attrs:{label:t.ConditionName,value:t.NodeCode}})})),1)],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.auditSubmitClick()}}},[t._v("确 定")])],1)],1),i("FillAlert",{attrs:{is_add:t.is_add,form_data:t.formdetail,task_code:t.task_code},on:{back:t.fillBack,subback:t.subFillBack}}),i("FillEditorAlert",{attrs:{is_add:t.is_editor,form_data:t.formdetail,main_code:t.main_code,task_code:t.task_code,detail:t.detail},on:{back:t.fillEBack,subback:t.subFillEBack}}),i("DetailAlert",{attrs:{is_add:t.is_detail,detail:t.detail,form_data:t.formdetail},on:{back:t.detailBack,otherback:t.otherDetailBack}}),i("LogAlert",{attrs:{is_add:t.is_log,code:t.logcode},on:{back:t.logBack}})],1)},s=[],o=(i("b0c0"),i("b64b"),i("5f87"),i("5a6e")),l=i("014b"),n=i("d394"),r=i("b4f9"),d=i("9583"),c={name:"form_list",components:{FillAlert:l["a"],FillEditorAlert:n["a"],DetailAlert:r["a"],LogAlert:d["a"]},data:function(){return{name:"",is_log:!1,logcode:"",corpid:this.$store.state.corpid,dialogTableVisible:!1,formdetail:{},task_code:"",is_add:!1,is_editor:!1,tableData:[],main_code:"",dellist:[],TypeId:3,auditkey:[],audit_key_list:[],select_auditcode:"",select_depart:"",is_detail:!1,detail:{},filed_infos:[],tableProps:{border:!0,"header-cell-style":{background:"#eef1f6",color:"#606266"}}}},methods:{logClick:function(t){this.logcode=t,this.is_log=!this.is_log},logBack:function(t){this.is_log=t},goimg:function(t){return window.open(t),!1},detailClick:function(t){this.is_detail=!this.is_detail,this.detail=t},detailBack:function(t){this.is_detail=t},otherDetailBack:function(){this.allmaindatabyformcodeanduserid()},auditSelectClick:function(){this.select_auditcode="",this.audit_key_list=this.auditlist[this.select_depart].conditions},auditSubmitClick:function(){if(""==this.select_auditcode)return this.$alert("请选择审批流程！","提示",{confirmButtonText:"确定"}),!1;1==this.num?this.commitmaindatawithnodecode(this.codeval):this.batchcommitmaindatawithnodecode(this.codeval)},submitClick:function(t,e){0==this.TypeId?1==e?this.commitmaindatawithoutaudit(t):this.batchcommitmaindatawithoutaudit(t):3==this.TypeId?(this.dialogTableVisible=!this.dialogTableVisible,this.num=e,this.codeval=t):1==e?this.commitmaindatawithtask(t):this.batchcommitmaindatawithtask(t)},getauditlist:function(){var t=this,e=this,i={corpid:this.$store.state.corpid,userid:this.$store.state.userid,task_code:this.task_code},a=e.$createObj(i),s=a["keyvalue"],o=e.$apilist["getauditlist"]+"?signature="+s;e.$server.post(o,a["fd"]).then((function(e){t.auditlist=e.data,t.auditkey=Object.keys(e.data)})).catch((function(t){}))},commitmaindatawithnodecode:function(t){var e=this,i=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,main_code:t,depart_code:this.select_depart,node_code:this.select_auditcode},s=i.$createObj(a),o=s["keyvalue"],l=i.$apilist["commitmaindatawithnodecode"]+"?signature="+o;i.$server.post(l,s["fd"]).then((function(){e.dialogTableVisible=!1,e.$message({type:"success",message:"提交成功!"}),e.allmaindatabyformcodeanduserid()})).catch((function(t){}))},batchcommitmaindatawithnodecode:function(t){var e=this,i=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,main_codes:JSON.stringify(t),depart_code:this.select_depart,node_code:this.select_auditcode},s=i.$createObj(a),o=s["keyvalue"],l=i.$apilist["batchcommitmaindatawithnodecode"]+"?signature="+o;i.$server.post(l,s["fd"]).then((function(t){e.dialogTableVisible=!1,70002==t.data?e.$alert(t.message,"提示",{confirmButtonText:"确定",callback:function(t){e.allmaindatabyformcodeanduserid()}}):(e.$message({type:"success",message:"提交成功!"}),e.allmaindatabyformcodeanduserid())})).catch((function(t){}))},commitmaindatawithoutaudit:function(t){var e=this,i=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,main_code:t},s=i.$createObj(a),o=s["keyvalue"],l=i.$apilist["commitmaindatawithoutaudit"]+"?signature="+o;i.$server.post(l,s["fd"]).then((function(t){e.$message({type:"success",message:"提交成功!"}),e.allmaindatabyformcodeanduserid()})).catch((function(t){}))},batchcommitmaindatawithoutaudit:function(t){var e=this,i=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,main_codes:JSON.stringify(t)},s=i.$createObj(a),o=s["keyvalue"],l=i.$apilist["batchcommitmaindatawithoutaudit"]+"?signature="+o;i.$server.post(l,s["fd"]).then((function(t){70002==t.data?e.$alert(t.message,"提示",{confirmButtonText:"确定",callback:function(t){e.allmaindatabyformcodeanduserid()}}):(e.$message({type:"success",message:"提交成功!"}),e.allmaindatabyformcodeanduserid())})).catch((function(t){}))},commitmaindatawithtask:function(t){var e=this,i=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,main_code:t},s=i.$createObj(a),o=s["keyvalue"],l=i.$apilist["commitmaindatawithtask"]+"?signature="+o;i.$server.post(l,s["fd"]).then((function(){e.$message({type:"success",message:"提交成功!"}),e.allmaindatabyformcodeanduserid()})).catch((function(t){}))},batchcommitmaindatawithtask:function(t){var e=this,i=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,main_codes:JSON.stringify(t)},s=i.$createObj(a),o=s["keyvalue"],l=i.$apilist["batchcommitmaindatawithtask"]+"?signature="+o;i.$server.post(l,s["fd"]).then((function(t){70002==t.data?e.$alert(t.message,"提示",{confirmButtonText:"确定",callback:function(t){e.allmaindatabyformcodeanduserid()}}):(e.$message({type:"success",message:"提交成功!"}),e.allmaindatabyformcodeanduserid())})).catch((function(t){}))},handleSelectionChange:function(t){this.dellist=t},addListClick:function(){if(0==this.dellist.length)return this.$alert("请选择提交内容！","提示",{confirmButtonText:"确定"}),!1;var t=[];for(var e in this.dellist)t.push(this.dellist[e].Code);this.submitClick(t,2)},batchdel:function(){var t=this;if(0==this.dellist.length)return this.$alert("请选择要删除的数据","提示",{confirmButtonText:"确定"}),!1;this.$confirm("此操作将永久删除数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=[];for(var i in t.dellist)e.push(t.dellist[i].Code);var a=t,s={corpid:t.$store.state.corpid,userid:t.$store.state.userid,main_codes:JSON.stringify(e)},o=a.$createObj(s),l=o["keyvalue"],n=a.$apilist["batchdel"]+"?signature="+l;a.$server.post(n,o["fd"]).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.dellist=[],t.allmaindatabyformcodeanduserid()})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}))},delClick:function(t){var e=this;this.$confirm("删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=e,a={corpid:e.$store.state.corpid,userid:e.$store.state.userid,code:t},s=i.$createObj(a),o=s["keyvalue"],l=i.$apilist["delone_main"]+"?signature="+o;i.$server.post(l,s["fd"]).then((function(){e.allmaindatabyformcodeanduserid(),e.$message({type:"success",message:"删除成功!"})})).catch((function(t){}))})).catch((function(){}))},ediotrFillClick:function(t){this.main_code=t.Code,this.detail=t,this.is_editor=!this.is_editor},fillEBack:function(t){this.is_editor=t},subFillEBack:function(){this.allmaindatabyformcodeanduserid()},subFillBack:function(){this.allmaindatabyformcodeanduserid()},fillClick:function(){this.is_add=!this.is_add},fillBack:function(t){this.is_add=t},getformdetail:function(){var t=this,e=this,i=this.$route.query.id;this.task_code=Object(o["a"])(this.$route.query.taskcode),this.name=this.$route.query.name;var a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:Object(o["a"])(i)},s=e.$createObj(a),l=s["keyvalue"],n=e.$apilist["formdetail"]+"?signature="+l;e.$server.post(n,s["fd"]).then((function(e){t.formdetail=e.data,t.formdetail.form_code=Object(o["a"])(i)})).catch((function(t){}))},allmaindatabyformcodeanduserid:function(){var t=this,e=this,i=this.$route.query.id;this.task_code=Object(o["a"])(this.$route.query.taskcode);var a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:Object(o["a"])(i),task_code:this.task_code},s=e.$createObj(a),l=s["keyvalue"],n=e.$apilist["allmaindatabyformcodeanduserid"]+"?signature="+l;e.$server.post(n,s["fd"]).then((function(e){if(t.tableData=e.data,t.select_depart="",t.select_auditcode="",0==e.data.length){for(var i in t.filed_infos=[],e.filed_infos)t.filed_infos.push({label:e.filed_infos[i].label});t.filed_infos.push({label:"状态"}),t.filed_infos.push({label:"操作"})}})).catch((function(t){}))}},mounted:function(){this.getformdetail(),this.allmaindatabyformcodeanduserid(),this.getauditlist()}},u=c,m=(i("572c"),i("2877")),f=Object(m["a"])(u,a,s,!1,null,null,null);e["default"]=f.exports}}]);