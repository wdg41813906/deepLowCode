(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25bbd5b0"],{"8e6c":function(e,i,s){},9583:function(e,i,s){"use strict";var t=function(){var e=this,i=e.$createElement,s=e._self._c||i;return s("div",{staticClass:"log_detail"},[s("el-dialog",{attrs:{title:"日志",visible:e.my_is_add,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(i){e.my_is_add=i}}},[s("data-tables",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",attrs:{data:e.loglist,"pagination-props":{pageSizes:[5,10,15]},"row-key":e.row_key,"expand-row-keys":e.expandRowKeys,"table-props":e.tableProps}},[s("el-table-column",{attrs:{label:"操作人"},scopedSlots:e._u([{key:"default",fn:function(i){return[e._v(" "+e._s(i.row.UserName)+" /"+e._s(i.row.UserId)+" ")]}}])}),s("el-table-column",{attrs:{label:"时间"},scopedSlots:e._u([{key:"default",fn:function(i){return[e._v(" "+e._s(new Date(+new Date(new Date(i.row.CreateTime).toJSON())+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"").slice(0,-3))+" ")]}}])}),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(i){return[7==i.row.TypeId?s("p",{staticClass:"danger_span"},[e._v(" #"+e._s(i.row.TypeDesc)+"# ")]):s("p",{staticClass:"success_span"},[e._v("#"+e._s(i.row.TypeDesc)+"#")]),s("p",[e._v(e._s(i.row.Remark))])]}}])})],1)],1)],1)},l=[],a={name:"log_detail",props:{is_add:Boolean,code:String},components:{},data:function(){return{tableProps:{border:!0,"header-cell-style":{background:"#eef1f6",color:"#606266"}},my_is_add:!1,loglist:[],loading:!1}},methods:{getallloginfobydatacode:function(){var e=this,i=this,s={corpid:this.$store.state.corpid,userid:this.$store.state.userid,data_code:this.code},t=i.$createObj(s),l=t["keyvalue"],a=i.$apilist["getallloginfobydatacode"]+"?signature="+l;i.$server.post(a,t["fd"]).then((function(i){e.loglist=i.data})).catch((function(e){}))}},watch:{is_add:function(e){this.my_is_add=e,e&&this.getallloginfobydatacode()},my_is_add:function(e){this.$emit("back",e)}}},o=a,r=(s("c44d"),s("2877")),f=Object(r["a"])(o,t,l,!1,null,null,null);i["a"]=f.exports},"9c00":function(e,i,s){"use strict";var t=function(){var e=this,i=e.$createElement,s=e._self._c||i;return s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:e.is_error,expression:"is_error"}]},[s("el-alert",{attrs:{title:"上传失败，请删除附件重新上传！",type:"error"}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}]},[s("el-alert",{attrs:{title:"上传中！",type:"warning"}})],1),s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[s("el-upload",{staticClass:"upload-pic",attrs:{action:"",data:e.QiniuData,"on-remove":function(i,s){return e.handleRemove(i,s,e.item)},"on-error":e.uploadError,"on-success":function(i,s,t){return e.uploadSuccess(i,s,t,e.item)},"before-remove":function(i,s){return e.beforeRemove(i,s,e.item)},"before-upload":e.beforeAvatarUpload,"http-request":function(i,s,t){return e.Upload(i,s,t)},"list-type":"picture-card",multiple:"","file-list":e.imgList}},[s("i",{staticClass:"el-icon-plus"}),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[s("p",{staticClass:"upload_p"},[e._v(e._s(e.item.placeholder))])])])],1)])},l=[],a=(s("99af"),s("c975"),s("a15b"),s("b0c0"),s("b64b"),s("ac1f"),s("1276"),s("5a6e")),o=s("1d57"),r=s("0a52"),f={name:"upload_img",props:{item:Object,imgList:Array},data:function(){return{loading:!1,imgurl:this.$store.state.imgurl,uploadKey:"0pc99vFCTZFb-FxnwxuyzbVcmlC_n0qkQ37INru4",uploadToken:"gbNuDHhFDyjIRLDXdJ6HRzp-uc_D6QypslKMJ85m",baseUrl:"http://images.xxxx.cn/",QiniuData:{key:"",token:""},domain:"https://upload-z1.qiniup.com",qiniuaddr:"http://cdn.deepgrid.cn/",uploadPicUrl:"",fileList:[],nowTime:"",fileExtension:"",otherlist:[],newFile:"",is_error:!1}},methods:{beforeAvatarUpload:function(e){var i="image/png"===e.type,s="image/jpeg"===e.type,t="image/jpg"===e.type;if(!i&&!s&&!t)return this.$message.error("上传图片只能是 jpg、png、jpeg 格式!"),!1;var l=e.name.split(".");this.fileExtension=l.pop(),this.newFile=e,this.loading=!0},Upload:function(e,i,s){var t=this,l={userid:t.$store.state.userid,file:this.newFile};t.$createObj(l),t.$apilist["uploadfiles"];this.loading=!0,Object(r["a"])(this.newFile,{quality:.9},(function(e){var s={userid:t.$store.state.userid,basestr:String(e).split("base64,")[1],shotname:t.newFile.name},l=t.$createObj(s),a=t.$apilist["uploadimages"];this.$emit("back_btn",!0),t.$server.post(a,l["fd"]).then((function(e){setTimeout((function(){t.uploadPicUrl=e.urlpath,t.otherlist=i,t.imgList.push({name:e.docname,url:t.imgurl+e.urlpath,doccode:e.doccode}),t.item.value=t.imgList,t.loading=!1,t.$emit("back_btn",!1),t.$message.success("添加成功"),t.is_error=!1,t.$emit("updata:item",this.item)}),1e3)})).catch((function(e){t.is_error=!0,t.loading=!1,t.$emit("back_btn",!1),t.$message.error("上传失败")}))}))},getval:function(e){var i=[];for(var s in e)-1!=Object.keys(e[s]).join(",").indexOf("response")&&i.push({name:e[s].response.key,hash:e[s].response.hash,url:e[s].url});return i},uploadSuccess:function(e,i,s,t){var l=this;this.uploadPicUrl="".concat(this.qiniuaddr,"/").concat(e.key);var a=this,o={key:e.key},r=a.$createObj(o),f=r["keyvalue"],n=a.$apilist["qiniudown"]+"?signature="+f;a.$server.post(n,r["fd"]).then((function(i){l.uploadPicUrl=i.data,l.imgList.push({name:e.key.split("__"+l.$store.state.corpid)[0]+"."+e.key.split(".").pop(),key:e.key,hash:e.hash,url:i.data}),t.value=l.imgList})).catch((function(e){}))},uploadError:function(e,i,s){this.$message({message:"上传出错，请重试！",type:"error",center:!0})},handleRemove:function(e,i,s){this.imgList=i,s.value=i,this.$emit("updata:item",s)},beforeRemove:function(e,i,s){}},created:function(){var e;this.nowTime=Object(a["e"])();var i={},s="deepgrid",t=this.uploadToken,l=this.uploadKey,r=Math.round((new Date).getTime()/1e3)+3600;i.scope=s,i.deadline=r,e=Object(o["a"])(t,l,i),this.QiniuData.token=e}},n=f,d=s("2877"),_=Object(d["a"])(n,t,l,!1,null,null,null);i["a"]=_.exports},"9e55":function(e,i,s){"use strict";s("8e6c")},aca3:function(e,i,s){},c44d:function(e,i,s){"use strict";s("aca3")},d394:function(e,i,s){"use strict";var t=function(){var e=this,i=e.$createElement,s=e._self._c||i;return s("div",{staticClass:"fill_alert"},[s("el-dialog",{staticClass:"fill_alert_dialog",attrs:{title:"编辑",visible:e.my_is_add,"close-on-click-modal":!1,"custom-class":"depart_aldert_dialog",width:"600px",height:"700px","append-to-body":!0},on:{"update:visible":function(i){e.my_is_add=i},close:e.close}},[s("div",{},[s("el-form",{attrs:{"label-position":"left","label-width":e.form_data.labelWidth},nativeOn:{submit:function(e){e.preventDefault()}}},[s("el-form-item",{attrs:{label:"表单"}},[e._v(e._s(e.form_data.title)+" ")])],1),s("el-form",{staticClass:"add_form",attrs:{"label-width":e.form_data.labelWidth+"px","label-position":e.form_data.labelPosition}},[""!=e.form_data.remark?s("el-form-item",{staticClass:"remark_style"},[e._v(" "+e._s(e.form_data.remark)+" ")]):e._e(),e._l(e.other_data.FField,(function(i,t){return s("div",{key:i},["divider"==i.tagIcon||"describe"==i.tagIcon||"describeImg"==i.tagIcon?s("el-form-item",["divider"==i.tagIcon?s("div",[s("el-divider")],1):"describe"==i.tagIcon?s("div",[s("el-tag",[e._v(e._s(i.placeholder))])],1):s("div",[s("el-image",{attrs:{src:i.placeholder}})],1)]):"upload"==i.tagIcon?s("el-form-item",{attrs:{"label-width":i.labelWidth>0?i.labelWidth+"px":e.form_data.labelWidth+"px",label:i.label,"label-position":e.form_data.labelPosition,required:i.required}},[s("uploadFile",{attrs:{item:i,fileList:i.value},on:{back_btn:e.back_btn}})],1):"image"==i.tagIcon?s("el-form-item",{attrs:{"label-width":i.labelWidth>0?i.labelWidth+"px":e.form_data.labelWidth+"px",label:i.label,"label-position":e.form_data.labelPosition,required:i.required}},[s("uploadImg",{attrs:{item:i,imgList:i.value},on:{back_btn:e.back_btn_img}})],1):"calculate"==i.tagIcon?s("el-form-item",{attrs:{"label-width":i.labelWidth>0?i.labelWidth+"px":e.form_data.labelWidth+"px",label:i.label,"label-position":e.form_data.labelPosition}},[s("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(i.label)+" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:i.strlist.join(""),placement:"right"}},[s("i",{staticClass:"el-icon-warning-outline"})])],1),s("span",{staticClass:"calculate_span display_inline_block"},[e._v(" "+e._s(null==i.value?0:i.value)+" ")]),i.enable_assign?s("el-button",{staticClass:"margin_l_15",attrs:{size:"medium",type:"text"},on:{click:function(s){return e.assignClick(i,t)}}},[e._v("分配")]):e._e(),null!=i.assign_data?s("div",[null!=i.assign_data&&0!=i.assign_data.length?s("span",{staticClass:"success"},[e._v(" 未分配值："+e._s(e.calOther(i.value,t,i.assign_data))+" ")]):e._e(),e._l(i.assign_data,(function(l,a){return s("div",{key:l,staticClass:"margin_top_10"},[s("el-select",{staticClass:"assign_input",attrs:{filterable:"",placeholder:"请选择被分配人","filter-method":e.dataFilter},on:{change:function(i){return e.assignChange()}},model:{value:l.ToUserId,callback:function(i){e.$set(l,"ToUserId",i)},expression:"assignitem.ToUserId"}},e._l(e.userlist,(function(i){return s("el-option",{key:i.uid,attrs:{label:i.name,value:i.uid}},[s("span",{staticStyle:{float:"left"}},[e._v(e._s(i.name))]),s("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(i.uid))])])})),1),s("el-input",{staticClass:"assign_input margin_l_15",attrs:{placeholder:"请填写分配数值"},on:{input:function(s){return e.cal(i.value,i.assign_data,t)}},model:{value:l.ToValue,callback:function(i){e.$set(l,"ToValue",i)},expression:"assignitem.ToValue"}}),s("i",{staticClass:"el-icon-remove assign_icon assign_error danger",on:{click:function(s){return e.removeassign(i,a)}}}),a===i.assign_data.length-1?s("i",{staticClass:"el-icon-circle-plus assign_icon assign_add primary",on:{click:function(s){return e.assignClick(i,t)}}}):e._e()],1)}))],2):e._e()],1):"calculate"!=i.tagIcon?s("el-form-item",{attrs:{"label-width":i.labelWidth>0?i.labelWidth+"px":e.form_data.labelWidth+"px",label:i.label,"label-position":e.form_data.labelPosition,required:i.required}},["input"==i.tagIcon?s("div",[s("el-input",{attrs:{placeholder:i.placeholder,maxlength:i.maxlength,size:"medium"},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}})],1):e._e(),"coefficient"==i.tagIcon?s("div",[s("p",[e._v(e._s(i.const_value))])]):e._e(),"textarea"==i.tagIcon?s("div",[s("el-input",{attrs:{type:"textarea",rows:3,maxlength:i.maxlength,placeholder:i.placeholder},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}})],1):e._e(),"number"==i.tagIcon?s("div",[s("el-input",{attrs:{placeholder:i.placeholder,size:"medium"},on:{input:function(i){return e.enterClick(i)}},model:{value:i.value,callback:function(s){e.$set(i,"value","string"===typeof s?s.trim():s)},expression:"item.value"}}),i.enable_assign?s("el-button",{staticClass:"margin_l_15",attrs:{size:"medium",type:"text"},on:{click:function(s){return e.assignClick(i,t)}}},[e._v("分配")]):e._e(),null!=i.assign_data?s("div",[null!=i.assign_data&&0!=i.assign_data.length?s("span",{staticClass:"success"},[e._v(" 未分配值："+e._s(e.calOtherNum(i.value,t,i.assign_data))+" ")]):e._e(),e._l(i.assign_data,(function(l,a){return s("div",{key:l,staticClass:"margin_top_10"},[s("el-select",{staticClass:"assign_input",attrs:{filterable:"",placeholder:"请选择被分配人","filter-method":e.dataFilter},on:{change:function(i){return e.assignChange()}},model:{value:l.ToUserId,callback:function(i){e.$set(l,"ToUserId",i)},expression:"assignitem.ToUserId"}},e._l(e.userlist,(function(i){return s("el-option",{key:i.uid,attrs:{label:i.name,value:i.uid}},[s("span",{staticStyle:{float:"left"}},[e._v(e._s(i.name))]),s("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(i.uid))])])})),1),s("el-input",{staticClass:"assign_input margin_l_15",attrs:{placeholder:"请填写分配数值"},on:{input:function(s){return e.cal(i.value,i.assign_data,t)}},model:{value:l.ToValue,callback:function(i){e.$set(l,"ToValue",i)},expression:"assignitem.ToValue"}}),s("i",{staticClass:"el-icon-remove assign_icon assign_error danger",on:{click:function(s){return e.removeassign(i,a)}}}),a===i.assign_data.length-1?s("i",{staticClass:"el-icon-circle-plus assign_icon assign_add primary",on:{click:function(s){return e.assignClick(i,t)}}}):e._e()],1)}))],2):e._e()],1):e._e(),"date"==i.tagIcon?s("div",[s("el-date-picker",{attrs:{type:"date",placeholder:i.placeholder,size:"medium"},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}})],1):e._e(),"select"==i.tagIcon?s("div",[s("el-select",{attrs:{placeholder:i.placeholder,size:"medium"},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}},e._l(i.options,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"select_number"==i.tagIcon?s("div",[0==i.is_counted?s("span",[e._v(e._s(e.otherfn(i)))]):e._e(),s("el-select",{attrs:{placeholder:i.placeholder,size:"medium"},on:{change:function(i){return e.selectNChage(i)}},model:{value:i.is_counted,callback:function(s){e.$set(i,"is_counted",s)},expression:"item.is_counted"}},e._l(i.options,(function(e){return s("el-option",{key:e.value+"__"+e.label,attrs:{label:e.label,value:("object"==typeof e.value?JSON.stringify(e.value):e.value)+"__"+e.label}})})),1)],1):e._e(),"rate"==i.tagIcon?s("div",[s("el-rate",{attrs:{"allow-half":i["allow-half"]},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}})],1):e._e()]):e._e()],1)}))],2)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(i){return e.close()}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary",size:"small",disabled:e.btn_disable},on:{click:function(i){return e.submitClick()}}},[e._v("确 定")])],1)])],1)},l=[],a=(s("4de4"),s("c975"),s("b0c0"),s("b680"),s("d3b7"),s("ac1f"),s("25f0"),s("1276"),s("53ca"),s("9c00")),o=s("ff65"),r={name:"fill_alert",props:{is_add:Boolean,form_data:Object,task_code:String,main_code:String,detail:Object},components:{uploadImg:a["a"],uploadFile:o["a"]},data:function(){return{btn_disable:!1,other_data:{},my_is_add:!1,form_fields:[],assigndetail:{},is_assign:!1,userlist:[],userlist_two:[],assign_other:[],form_fields_select:[]}},methods:{back_btn:function(e){this.btn_disable=e},back_btn_img:function(e){this.btn_disable=e},addindex:function(e,i){this.assign_other[e]=i},calOtherNum:function(e,i,s){for(var t in this.assign_other[i]=e,s){if("number"!=typeof s[t].ToValue&&("."==s[t].ToValue.split("")[s[t].ToValue.length-1]||""==s[t].ToValue))break;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(s[t].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;e=this.subtr(e,parseFloat(s[t].ToValue))}return this.assign_other[i]=e,e},calOther:function(e,i,s){for(var t in this.assign_other[i]=e,s){if("number"!=typeof s[t].ToValue&&("."==s[t].ToValue.split("")[s[t].ToValue.length-1]||""==s[t].ToValue))break;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(s[t].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;e=this.subtr(e,parseFloat(s[t].ToValue))}return this.assign_other[i]=e,e},cal:function(e,i,s){var t=parseFloat(e);for(var l in i){if("."==i[l].ToValue.split("")[i[l].ToValue.length-1]||""==i[l].ToValue)break;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(i[l].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;t=this.subtr(t,parseFloat(i[l].ToValue))}this.assign_other[s]=t},subtr:function(e,i){var s,t,l,a;try{s=e.toString().split(".")[1].length}catch(o){s=0}try{t=i.toString().split(".")[1].length}catch(o){t=0}return l=Math.pow(10,Math.max(s,t)),a=s>=t?s:t,((e*l-i*l)/l).toFixed(a)},isNum:function(e){if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(e))return this.$alert(" 请填写数字!","提示",{confirmButtonText:"确定"}),e="",!1},removeassign:function(e,i){this.$delete(e.assign_data,i)},addassign:function(e){},assignClick:function(e,i){if(null==e.value||0==e.value)return this.$alert(" 请先填写，再分配!","提示",{confirmButtonText:"确定"}),!1;this.assignChange(),null==e.assign_data?(e.assign_data=[],e["assign_data"].push({ToUserId:"",ToValue:""})):e["assign_data"].push({ToUserId:"",ToValue:""})},otherfn:function(e){return e.is_counted="",e.join_gather="",""},close:function(){this.btn_disable=!1,this.my_is_add=!1},selectNChage:function(e){this.subClick()},enterClick:function(e){return"."!=e.split("")[e.length-1]&&""!=e&&(/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(e)?void this.subClick():(this.$alert(" 请填写数字!","提示",{confirmButtonText:"确定"}),!1))},getnowdate:function(e){var i=new Date(e),s=i.getFullYear(),t=i.getMonth()+1,l=i.getDate();return t<10&&(t="0"+t),l<10&&(l="0"+l),s+"/"+t+"/"+l},countselected:function(e){var i=this,s=[];for(var t in this.form_fields)if(this.form_fields[t].required)if("number"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].value)});else if("coefficient"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].const_value)});else{if("divider"==this.form_fields[t].tagIcon||"describe"==this.form_fields[t].tagIcon||"describeImg"==this.form_fields[t].tagIcon)continue;"select_number"==this.form_fields[t].tagIcon?this.form_fields[t].is_counted.split("]}__").length<2?s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].is_counted.split("__")[0])}):(this.form_fields[t].join_gather,s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].join_gather)})):"date"==this.form_fields[t].tagIcon?s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.getnowdate(this.form_fields[t].value)}):"image"==this.form_fields[t].tagIcon?s.push({field_code:this.form_fields[t].filed_code,opt_label:"image",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:!1,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value}):"upload"==this.form_fields[t].tagIcon?s.push({field_code:this.form_fields[t].filed_code,opt_label:"file",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:!1,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value}):s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value})}else if("number"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].value)});else if("coefficient"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].const_value)});else if("select_number"==this.form_fields[t].tagIcon)this.form_fields[t].is_counted.split("]}__").length<2?s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].is_counted.split("__")[0])}):(this.form_fields[t].join_gather,s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].join_gather)}));else if("date"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.getnowdate(this.form_fields[t].value)});else if("image"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,opt_label:"image",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value});else if("upload"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,opt_label:"file",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value});else{if("divider"==this.form_fields[t].tagIcon||"describe"==this.form_fields[t].tagIcon||"describeImg"==this.form_fields[t].tagIcon)continue;var l=this.form_fields[t].enable_assign;s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:l,value:this.form_fields[t].value})}var a=JSON.parse(e.is_counted.split("__")[0]).str_id_list,o=this,r={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,file_info:JSON.stringify(s),formula_method:JSON.stringify(a)},f=o.$createObj(r),n=f["keyvalue"],d=o.$apilist["countselected"]+"?signature="+n;o.$server.post(d,f["fd"]).then((function(s){e.join_gather=s.data,i.subClickTwo()})).catch((function(e){}))},subClick:function(){var e=this;for(var i in this.form_fields_select)this.form_fields_select[i].is_counted.split("]}__").length>1&&this.countselected(this.form_fields_select[i]);var s=[];for(var t in this.form_fields)if(this.form_fields[t].required)if("number"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].value)});else{if("divider"==this.form_fields[t].tagIcon||"describe"==this.form_fields[t].tagIcon||"describeImg"==this.form_fields[t].tagIcon)continue;"select_number"==this.form_fields[t].tagIcon?this.form_fields[t].is_counted.split("]}__").length<2?s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].is_counted.split("__")[0])}):(this.form_fields[t].join_gather,s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].join_gather)})):"image"==this.form_fields[t].tagIcon?s.push({field_code:this.form_fields[t].filed_code,opt_label:"image",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:!1,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value}):"upload"==this.form_fields[t].tagIcon?s.push({field_code:this.form_fields[t].filed_code,opt_label:"file",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value}):"date"==this.form_fields[t].tagIcon?s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.getnowdate(this.form_fields[t].value)}):s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value})}else if("number"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].value)});else if("select_number"==this.form_fields[t].tagIcon)this.form_fields[t].is_counted.split("]}__").length<2?s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].is_counted.split("__")[0])}):(this.form_fields[t].join_gather,s.push({field_code:this.form_fields[t].filed_code,opt_label:this.form_fields[t].is_counted,field_label:this.form_fields[t].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:parseFloat(this.form_fields[t].join_gather)}));else if("date"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:this.form_fields[t].enable_assign,value:this.getnowdate(this.form_fields[t].value)});else if("image"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,opt_label:"image",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:!1,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value});else if("upload"==this.form_fields[t].tagIcon)s.push({field_code:this.form_fields[t].filed_code,opt_label:"file",field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:!1,enable_assign:this.form_fields[t].enable_assign,value:this.form_fields[t].value});else{if("divider"==this.form_fields[t].tagIcon||"describe"==this.form_fields[t].tagIcon||"describeImg"==this.form_fields[t].tagIcon)continue;var l=this.form_fields[t].enable_assign;s.push({field_code:this.form_fields[t].filed_code,field_label:this.form_fields[t].label,join_gather:this.form_fields[t].join_gather,is_counted:this.form_fields[t].is_counted,enable_greater:this.form_fields[t].enable_greater,enable_assign:l,value:this.form_fields[t].value})}var a=this,o={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,rule_file_info:JSON.stringify(s)},r=a.$createObj(o),f=r["keyvalue"],n=a.$apilist["countfunction"]+"?signature="+f;a.$server.post(n,r["fd"]).then((function(i){if(i.data.length>0)for(var s in i.data)for(var t in e.other_data.FField)e.other_data.FField[t].filed_code==i.data[s].field_code&&(e.other_data.FField[t].value=i.data[s].value)})).catch((function(e){}))},subClickTwo:function(){var e=this,i=[];for(var s in this.form_fields)if(this.form_fields[s].required)if("number"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)});else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;"select_number"==this.form_fields[s].tagIcon?this.form_fields[s].is_counted.split("]}__").length<2?i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])}):(this.form_fields[s].join_gather,i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].join_gather)})):"date"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)}):"image"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):"upload"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value})}else if("number"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)});else if("select_number"==this.form_fields[s].tagIcon)this.form_fields[s].is_counted.split("]}__").length<2?i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])}):(this.form_fields[s].join_gather,i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].join_gather)}));else if("date"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)});else if("image"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else if("upload"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;var t=this.form_fields[s].enable_assign;i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:t,value:this.form_fields[s].value})}var l=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,rule_file_info:JSON.stringify(i)},o=l.$createObj(a),r=o["keyvalue"],f=l.$apilist["countfunction"]+"?signature="+r;l.$server.post(f,o["fd"]).then((function(i){if(i.data.length>0)for(var s in i.data)for(var t in e.form_data1.fields)e.form_data1.fields[t].filed_code==i.data[s].field_code&&(e.form_data1.fields[t].value=i.data[s].value)})).catch((function(e){}))},submitClick:function(){var e=this,i=[];for(var s in this.form_fields)if(this.form_fields[s].required){if("select_number"==this.form_fields[s].tagIcon){if(0==this.form_fields[s].is_counted)return this.$alert("请选择 "+this.form_fields[s].label+" !","提示",{confirmButtonText:"确定"}),!1}else if("number"==this.form_fields[s].tagIcon){if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].value))return this.$alert(this.form_fields[s].label+" 请填写数字!","提示",{confirmButtonText:"确定"}),!1}else if((null==this.form_fields[s].value||""==this.form_fields[s].value)&&"divider"!=this.form_fields[s].tagIcon&&"describe"!=this.form_fields[s].tagIcon&&"describeImg"!=this.form_fields[s].tagIcon)return this.$alert("请填写 "+this.form_fields[s].label+" !","提示",{confirmButtonText:"确定"}),!1;if("number"==this.form_fields[s].tagIcon){for(var t in this.form_fields[s].assign_data){if(""==this.form_fields[s].assign_data[t].ToUserId||""==this.form_fields[s].assign_data[t].ToValue)return this.$alert(this.form_fields[s].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].assign_data[t].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[s].assign_data[t].ToValue=parseFloat(this.form_fields[s].assign_data[t].ToValue)}i.push({field_code:this.form_fields[s].filed_code,assign_data:this.form_fields[s].assign_data,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)})}else if("coefficient"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].const_value)});else if("calculate"==this.form_fields[s].tagIcon){for(var l in this.form_fields[s].assign_data){if(""==this.form_fields[s].assign_data[l].ToUserId||""==this.form_fields[s].assign_data[l].ToValue)return this.$alert(this.form_fields[s].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].assign_data[l].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[s].assign_data[l].ToValue=parseFloat(this.form_fields[s].assign_data[l].ToValue)}i.push({field_code:this.form_fields[s].filed_code,assign_data:this.form_fields[s].assign_data,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)})}else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;"select_number"==this.form_fields[s].tagIcon?this.form_fields[s].is_counted.split("]}__").length<2?i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])}):(this.form_fields[s].join_gather,i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].join_gather)})):"image"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):"upload"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):"date"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)}):i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value})}}else if("number"==this.form_fields[s].tagIcon){for(var a in this.form_fields[s].assign_data){if(""==this.form_fields[s].assign_data[a].ToUserId||""==this.form_fields[s].assign_data[a].ToValue)return this.$alert(this.form_fields[s].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].assign_data[a].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[s].assign_data[a].ToValue=parseFloat(this.form_fields[s].assign_data[a].ToValue)}i.push({field_code:this.form_fields[s].filed_code,assign_data:this.form_fields[s].assign_data,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)})}else if("coefficient"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].const_value)});else if("calculate"==this.form_fields[s].tagIcon){for(var o in this.form_fields[s].assign_data){if(""==this.form_fields[s].assign_data[o].ToUserId||""==this.form_fields[s].assign_data[o].ToValue)return this.$alert(this.form_fields[s].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].assign_data[o].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[s].assign_data[o].ToValue=parseFloat(this.form_fields[s].assign_data[o].ToValue)}i.push({field_code:this.form_fields[s].filed_code,assign_data:this.form_fields[s].assign_data,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)})}else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;if("select_number"==this.form_fields[s].tagIcon)this.form_fields[s].is_counted.split("]}__").length<2?i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])}):(this.form_fields[s].join_gather,i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].join_gather)}));else if("image"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else if("upload"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else if("date"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)});else{var r=this.form_fields[s].enable_assign;i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:r,value:this.form_fields[s].value})}}var f=this,n={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,form_field_info:JSON.stringify(i),main_code:this.other_data.Code},d=f.$createObj(n),_=d["keyvalue"],h=f.$apilist["edit"]+"?signature="+_;f.$server.post(h,d["fd"]).then((function(i){e.$message({message:"修改成功！",type:"success"}),e.$emit("subback"),e.close()})).catch((function(e){}))},dataFilter:function(e){this.userlist=this.userlist_two.filter((function(i){if(-1!==i.uid.indexOf(e)||-1!==i.name.indexOf(e))return!0}))},assignChange:function(){this.userlist=this.userlist_two},alluser:function(){var e=this,i=this,s={corpid:this.$store.state.corpid,userid:this.$store.state.userid},t=i.$createObj(s),l=t["keyvalue"],a=i.$apilist["allusernameandid"]+"?signature="+l;i.$server.post(a,t["fd"]).then((function(i){e.userlist=i.data,e.userlist_two=Object.assign(i.data)})).catch((function(e){}))},detailbycode:function(){var e=this,i=this,s={corpid:this.$store.state.corpid,userid:this.$store.state.userid,main_code:this.main_code},t=i.$createObj(s),l=t["keyvalue"],a=i.$apilist["detailbycode"]+"?signature="+l;i.$server.post(a,t["fd"]).then((function(i){for(var s in e.other_data=i.data,e.form_fields=e.other_data.FField,e.form_fields){for(var t in e.other_data.FormFieldInfos)e.form_fields[s].filed_code==e.other_data.FormFieldInfos[t].field_code&&(e.form_fields[s].value=e.other_data.FormFieldInfos[t].value,""!==e.other_data.FormFieldInfos[t]["opt_label"]&&(e.form_fields[s].opt_label=e.other_data.FormFieldInfos[t].opt_label,e.form_fields[s].is_counted=e.other_data.FormFieldInfos[t].opt_label));for(var l in e.detail.FormFieldInfos)e.form_fields[s].filed_code!=e.detail.FormFieldInfos[l].field_code||"image"!=e.detail.FormFieldInfos[l].opt_label&&"file"!=e.detail.FormFieldInfos[l].opt_label||(e.form_fields[s].value=e.detail.FormFieldInfos[l].value)}for(var a in e.form_fields_select=[],e.form_fields)"select_number"==e.form_fields[a].tagIcon&&e.form_fields_select.push(e.form_fields[a]);6==i.data.State&&e.subClick()})).catch((function(e){}))}},mounted:function(){this.alluser()},watch:{is_add:function(e){this.my_is_add=e,e&&this.detailbycode()},my_is_add:function(e){this.$emit("back",e)}}},f=r,n=(s("9e55"),s("2877")),d=Object(n["a"])(f,t,l,!1,null,null,null);i["a"]=d.exports},ff65:function(e,i,s){"use strict";var t=function(){var e=this,i=e.$createElement,s=e._self._c||i;return s("div",{staticClass:"upload_file"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.is_error,expression:"is_error"}]},[s("el-alert",{attrs:{title:"上传失败，请删除附件重新上传！",type:"error"}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}]},[s("el-alert",{attrs:{title:"上传中！",type:"warning"}})],1),s("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"upload-demo",attrs:{action:"",data:e.QiniuData,"on-remove":function(i,s){return e.handleRemoveFile(i,s,e.item)},"on-error":e.uploadErrorFile,"on-success":function(i,s,t){return e.uploadSuccessFile(i,s,t,e.item)},"before-remove":function(i,s){return e.beforeRemoveFile(i,s,e.item)},"before-upload":e.beforeAvatarUploadFile,"http-request":function(i,s,t){return e.Upload(i,s,t)},multiple:"","file-list":e.fileList}},[s("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传附件")]),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[s("p",{staticClass:"upload_p"},[e._v("只能上传不超过20MB的文件")]),s("p",{staticClass:"upload_p"},[e._v(e._s(e.item.placeholder))])])],1),s("div",{staticStyle:{display:"none"}},[e._v(e._s(e.fileList))])],1)},l=[],a=(s("99af"),s("c975"),s("a15b"),s("b0c0"),s("b680"),s("b64b"),s("ac1f"),s("1276"),s("5a6e")),o=s("1d57"),r={name:"upload_file",props:{fileList:Object,item:Object},data:function(){return{loading:!1,imgurl:this.$store.state.imgurl,uploadKey:"0pc99vFCTZFb-FxnwxuyzbVcmlC_n0qkQ37INru4",uploadToken:"gbNuDHhFDyjIRLDXdJ6HRzp-uc_D6QypslKMJ85m",baseUrl:"http://images.xxxx.cn/",QiniuData:{key:"",token:""},domain:"https://upload-z1.qiniup.com",qiniuaddr:"http://cdn.deepgrid.cn/",uploadPicUrl:"",imgList:[],nowTime:"",fileExtension:"",otherlist:[],newFile:{},is_error:!1}},methods:{getval:function(e){var i=[];for(var s in e)-1!=Object.keys(e[s]).join(",").indexOf("response")&&i.push({name:e[s].response.key,hash:e[s].response.hash,url:e[s].url});return i},beforeAvatarUploadFile:function(e){var i=e.name.split(".");this.fileExtension=i.pop(),this.newFile=e},Upload:function(e,i,s){var t=this,l={userid:t.$store.state.userid,file:this.newFile},a=t.$createObj(l),o=t.$apilist["uploadfiles"];this.loading=!0,t.$emit("back_btn",!0),t.$server.post(o,a["fd"]).then((function(e){setTimeout((function(){t.uploadPicUrl=e.urlpath,t.otherlist=i,void 0!=t.fileList&&null!=t.fileList&&""!=t.fileList||(t.fileList=[]),t.fileList.push({name:e.docname,url:t.imgurl+e.urlpath,doccode:e.doccode}),t.item.value=t.fileList,t.loading=!1,t.is_error=!1,t.$emit("back_btn",!1),t.$message.success("添加成功"),t.$emit("updata:item",t.item)}),1e3)})).catch((function(e){t.is_error=!0,t.loading=!1,t.$emit("back_btn",!1),t.$message.error("上传失败")}))},uploadSuccessFile:function(e,i,s,t){return!1},uploadSuccessFile1:function(e,i,s,t){var l=this,a={userid:l.$store.state.userid,file:i},o=l.$createObj(a),r=l.$apilist["uploadfiles"];this.loading=!0,l.$server.post(r,o["fd"]).then((function(e){l.loading=!1;var i=e;setTimeout((function(){l.excellist=i}),1e3)}))},isFileType:function(e){var i=(e[0].size/1048576).toFixed(2),s=e[0].name;return/.(xls|xlsx)$/.test(s)?i>20?(this.$alert("文件过大,请压缩至20M以内再上传!","提示",{confirmButtonText:"确定"}),!1):void 0:(this.$alert("请上传excel文件!","提示",{confirmButtonText:"确定"}),!1)},uploadErrorFile:function(e,i,s){this.$message({message:"上传出错，请重试！",type:"error",center:!0})},handleRemoveFile:function(e,i,s){this.fileList=i,s.value=i,this.$emit("updata:item",s)},beforeRemoveFile:function(e,i,s){}},created:function(){var e;this.nowTime=Object(a["e"])();var i={},s="deepgrid",t=this.uploadToken,l=this.uploadKey,r=Math.round((new Date).getTime()/1e3)+3600;i.scope=s,i.deadline=r,e=Object(o["a"])(t,l,i),this.QiniuData.token=e}},f=r,n=s("2877"),d=Object(n["a"])(f,t,l,!1,null,null,null);i["a"]=d.exports}}]);