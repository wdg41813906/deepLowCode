(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d99568b"],{"0d85":function(t,e,s){},6374:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"permissions"},[s("div",{staticClass:"text_right top_form"},[s("el-button",{attrs:{size:"small"},on:{click:function(e){return t.addClick()}}},[t._v("添加")])],1),s("div",{staticClass:"member_colRight"},[s("data-tables",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.tasklist,"pagination-props":{pageSizes:[5,10,15]},"row-key":t.row_key,"expand-row-keys":t.expandRowKeys,"table-props":t.tableProps},on:{"selection-change":t.handleSelectionChange}},[s("el-table-column",{attrs:{label:"工号",prop:"UserId"}}),s("el-table-column",{attrs:{label:"用户名",prop:"Name"}}),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.myuserid!=e.row.UserId?s("div",{staticClass:"form_operate"},[s("el-link",{attrs:{underline:!1,type:"danger"},on:{click:function(s){return t.delClick(e.row)}}},[s("span",[t._v("删除")])])],1):t._e()]}}])})],1)],1),s("el-dialog",{staticClass:"audit_dialog",attrs:{title:"权限添加",visible:t.dialogTableVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[s("el-form",{staticClass:"auditform",attrs:{"label-width":"120px"},nativeOn:{submit:function(t){t.preventDefault()}}},[s("el-form-item",{attrs:{label:"管理员"}},[s("div",{staticClass:"el-input el-input--medium width_260 ww_groupSelBtn"},[s("div",{staticClass:"el-input__inner",on:{click:function(e){return t.departClick()}}},t._l(t.departlist,(function(e){return s("div",{key:e.id,staticClass:"ww_groupSelBtn_item"},[s("span",{staticClass:"ww_img"}),s("span",{staticClass:"ww_groupSelBtn_item_text"},[t._v(t._s(e.Department))])])})),0)])]),s("el-form-item",{attrs:{label:"管理角色"}},[s("el-select",{staticStyle:{height:"50px"},attrs:{placeholder:"请选择",size:"medium"},model:{value:t.select_per,callback:function(e){t.select_per=e},expression:"select_per"}},t._l(t.permisionlist,(function(t){return s("el-option",{key:t.val,attrs:{label:t.label,value:t.val}})})),1)],1),2==t.select_per||"2"==t.select_pere?s("el-form-item",{staticStyle:{"margin-top":"8px"},attrs:{label:"管理范围"}},[s("div",{staticClass:"el-input el-input--medium width_260 ww_groupSelBtn"},[s("div",{staticClass:"el-input__inner",on:{click:function(e){return t.departDClick()}}},t._l(t.departlist_d,(function(e){return s("div",{key:e.id,staticClass:"ww_groupSelBtn_item"},[s("span",{staticClass:"ww_img"}),s("span",{staticClass:"ww_groupSelBtn_item_text"},[t._v(t._s(e.Department))])])})),0)])]):t._e()],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!1}}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.perSubClick()}}},[t._v("确 定")])],1)],1),s("DepartAlert",{attrs:{is_add:t.is_depart,departlist:t.departlist,title:"权限添加",alldepart:t.alldepart},on:{back:t.departBack,departSub:t.departSub}}),s("DepartAlertA",{attrs:{is_add:t.is_depart_d,departlist:t.departlist_d,title:"设置管理范围",alldepart:t.alldepart_d},on:{back:t.departDBack,departSub:t.departDSub}})],1)},a=[],l=s("91d3"),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"depart_alert_A"},[s("el-dialog",{staticClass:"depart_alert",attrs:{title:t.title,visible:t.my_is_add,"close-on-click-modal":!1,"custom-class":"depart_aldert_dialog",width:"600px",height:"700px","append-to-body":!0},on:{"update:visible":function(e){t.my_is_add=e},close:t.close}},[s("div",{staticClass:"member_container_depart"},[s("div",{staticClass:"left member_colLeft_depart"},[s("ElementTree",{attrs:{getdata:t.alldepart,departlist:t.my_select_id_list,is_colse:t.is_colse},on:{getTreelist:t.getTreelist}})],1),s("div",{staticClass:"left member_colRight_depart"},[s("ul",t._l(t.my_selectlist,(function(e,i){return s("li",{key:i,staticClass:"step_right_li"},[s("span",{},[t._v(" "+t._s(e.Department)+" ")]),s("i",{staticClass:"el-icon-close del_select",on:{click:function(e){return t.delClick(i)}}}),s("div",{staticClass:"clearfix"})])})),0)]),s("div",{staticClass:"clearfix"}),s("div",{staticClass:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(e){return t.close()}}},[t._v("取消")]),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.departSub()}}},[t._v("确定")])],1)])])],1)},n=[],d=s("0dd1"),c={name:"depart_alert",components:{ElementTree:d["a"]},props:{is_add:Boolean,departlist:Array,alldepart:Array,title:String},data:function(){return{my_is_add:!1,my_selectlist:[],my_select_id_list:[],is_colse:!1}},methods:{departSub:function(){if(0==this.my_selectlist.length&&"权限添加"==this.title)return this.$alert(this.title+"为空！","提示",{confirmButtonText:"确定"}),!1;this.$emit("departSub",this.my_selectlist),this.close()},delClick:function(t){this.is_colse=!this.is_colse,this.$delete(this.my_selectlist,t),this.$delete(this.my_select_id_list,t);var e=JSON.stringify(this.my_selectlist);this.my_selectlist=[];var s=this;setTimeout((function(){s.my_selectlist=JSON.parse(e)}),100)},close:function(){this.is_colse=!0,this.my_is_add=!1},getTreelist:function(t){for(var e in this.my_selectlist=t.depart,this.my_select_id_list=[],this.my_selectlist)this.my_select_id_list.push(this.my_selectlist[e].depart_id)},getalldepartmenttree:function(){this.$store.state.corpid;var t=this,e=this;this.loading=!0;var s={corpid:this.$store.state.corpid,userid:this.$store.state.userid},i=e.$createObj(s),a=i["keyvalue"],l=e.$apilist["getalldepartment"]+"?signature="+a;this.$server.post(l,i["fd"]).then((function(e){t.loading=!1,t.alldepart=e.data})).catch((function(t){}))}},mounted:function(){},watch:{is_add:function(t){if(t&&(this.is_colse=!1,this.my_is_add=t,void 0!=this.departlist))for(var e in this.my_selectlist=JSON.parse(JSON.stringify(this.departlist)),this.my_select_id_list=[],this.my_selectlist)this.my_select_id_list.push(this.my_selectlist[e].depart_id)},my_is_add:function(t){this.$emit("back",t)}}},o=c,p=(s("a9f5"),s("2877")),u=Object(p["a"])(o,r,n,!1,null,null,null),_=u.exports,h={name:"permisiions",data:function(){return{myuserid:this.$store.state.userid,dialogTableVisible:!1,tableProps:{border:!0,"header-cell-style":{background:"#eef1f6",color:"#606266"}},tasklist:[],loading:!1,is_depart:!1,departlist:[],alldepart:[],alldepart_d:[],permisionlist:[{label:"管理员一级",val:1},{label:"管理员二级",val:2}],select_per:"",departlist_d:[],is_depart_d:!1}},components:{DepartAlert:l["a"],DepartAlertA:_},methods:{addClick:function(){this.dialogTableVisible=!this.dialogTableVisible},departDClick:function(){this.is_depart_d=!this.is_depart_d},departDBack:function(t){this.is_depart_d=t},departDSub:function(t){this.departlist_d=t},departClick:function(){this.is_depart=!this.is_depart},departBack:function(t){this.is_depart=t},departSub:function(t){this.departlist=t},perSubClick:function(){var t=[];if(0==this.departlist.length)return this.$alert("请选择管理员！","提示",{confirmButtonText:"确定"}),!1;var e={corpid:this.$store.state.corpid,userid:this.departlist[0].id,level:this.select_per};if(2==this.select_per){if(0==this.departlist_d.length)return this.$alert("请选择管理范围！","提示",{confirmButtonText:"确定"}),!1;for(var s in this.departlist_d)t.push(parseInt(this.departlist_d[s].id));e["departids"]=JSON.stringify(t)}var i=this.$createObj(e),a=i["keyvalue"],l=this.$apilist["addoneadmin"]+"?signature="+a,r=this;this.$server.post(l,i["fd"]).then((function(t){r.$message({type:"success",message:"添加成功!"}),r.dialogTableVisible=!1,r.select_per="",r.departlist_d=[],r.departlist=[],r.getalladmin()})).catch((function(t){}))},delClick:function(t){var e=this;this.$confirm("是否移除该管理员?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var s={corpid:e.$store.state.corpid,self:e.$store.state.userid,userid:t.UserId},i=e.$createObj(s),a=i["keyvalue"],l=e.$apilist["deloneadmin"]+"?signature="+a,r=e;e.$server.post(l,i["fd"]).then((function(){r.getalladmin(),r.$message({type:"success",message:"移除成功!"})})).catch((function(t){}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},handleSelectionChange:function(){},getalladmin:function(){var t={corpid:this.$store.state.corpid},e=this.$createObj(t),s=e["keyvalue"],i=this.$apilist["alladmin"]+"?signature="+s,a=this;this.$server.post(i,e["fd"]).then((function(t){a.tasklist=t.data})).catch((function(t){}))},getalldepartmentanduseridtree:function(){var t=this,e=(this.$store.state.corpid,{corpid:this.$store.state.corpid,userid:this.$store.state.userid}),s=t.$createObj(e),i=s["keyvalue"],a=t.$apilist["getalldepartmentanduser"]+"?signature="+i;this.$server.post(a,s["fd"]).then((function(e){t.loading=!1,t.alldepart=e.data})).catch((function(t){}))},getalldepartmenttree:function(){this.$store.state.corpid;var t=this,e=this;this.loading=!0;var s={corpid:this.$store.state.corpid,userid:this.$store.state.userid},i=e.$createObj(s),a=i["keyvalue"],l=e.$apilist["getalldepartment"]+"?signature="+a;this.$server.post(l,i["fd"]).then((function(e){t.loading=!1,t.alldepart_d=e.data})).catch((function(t){}))}},mounted:function(){this.getalladmin(),this.getalldepartmenttree(),this.getalldepartmentanduseridtree()}},f=h,m=(s("92ec"),Object(p["a"])(f,i,a,!1,null,null,null));e["default"]=m.exports},"91d3":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"depart_alert"},[s("el-dialog",{staticClass:"depart_alert",attrs:{title:t.title,visible:t.my_is_add,"close-on-click-modal":!1,"custom-class":"depart_aldert_dialog",width:"600px",height:"700px","append-to-body":!0},on:{"update:visible":function(e){t.my_is_add=e},close:t.close}},[s("div",{staticClass:"member_container"},[s("div",{staticClass:"left member_colLeft"},[s("ElementTree",{attrs:{getdata:t.alldepart,departlist:t.my_select_id_list,is_colse:t.is_colse},on:{getTreelist:t.getTreelist}})],1),s("div",{staticClass:"left member_colRight"},[s("ul",t._l(t.my_selectlist,(function(e,i){return s("li",{key:i,staticClass:"step_right_li"},[s("span",{},[t._v(" "+t._s(e.Department)+" ")]),s("i",{staticClass:"el-icon-close del_select",on:{click:function(e){return t.delClick(i)}}}),s("div",{staticClass:"clearfix"})])})),0)]),s("div",{staticClass:"clearfix"}),s("div",{staticClass:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(e){return t.close()}}},[t._v("取消")]),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.departSub()}}},[t._v("确定")])],1)])])],1)},a=[],l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"element_tree"},[i("div",{staticClass:"member_coolLeft_top element_left"},[i("el-input",{staticClass:"search_tree",attrs:{placeholder:"输入关键字进行过滤"},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}})],1),i("el-tree",{ref:"tree",attrs:{data:t.datalist,"show-checkbox":"","node-key":"depart_id",props:t.defaultProps,"filter-node-method":t.filterNode,"default-expanded-keys":["1"],"default-checked-keys":t.departlist,"check-strictly":!0},on:{"check-change":t.handleCheckChange},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.node;return i("span",{staticClass:"custom-tree-node"},[i("span",[1==a.data.IsDepart||"true"==a.data.IsDepart?i("img",{attrs:{src:s("b945"),alt:""}}):i("img",{attrs:{src:s("059b"),alt:""}})]),t._v(" "+t._s(a.label)+" ")])}}])},[t._v(" > ")])],1)},r=[],n=(s("99af"),s("4de4"),s("c975"),s("a434"),s("a9e3"),s("b64b"),s("d3b7"),s("ac1f"),s("25f0"),s("1276"),s("5a6e"),{name:"element_tree",props:{getdata:Array,departlist:Array,key:Number,is_colse:Boolean},data:function(){return{datalist:[],defaultProps:{id:"id",label:"Department",children:"Children",parent_id:"ParentId",depart_id:"depart_id",IsDepart:"IsDepart",disabled:"IsDepart"},filterText:"",selectlist:[],list_select:[]}},methods:{handleCheckChange:function(t,e,s){if(this.getCheckedNodes(),e){var i=[t.depart_id];this.$refs.tree.setCheckedKeys(i),this.getCheckedNodes()}else this.getCheckedNodes()},getCheckedNodes:function(){var t=this.$refs.tree.getCheckedNodes(),e=[],s=[],i=[];for(var a in t)-1==i.indexOf(parseInt(t[a].ParentId))&&(1==t[a].IsDepart?e.push(t[a]):s.push(t[a])),i.push(parseInt(t[a].DepartId));this.unique(t);this.$emit("getTreelist",{depart:t,label:s})},unique:function(t){for(var e=0;e<t.length;e++)for(var s=e+1;s<t.length;s++)t[e].depart_id==t[s].depart_id&&(t.splice(s,1),s--);return t},getHalfCheckedNodes:function(){},getTreeData:function(){this.datalist=JSON.parse(JSON.stringify(this.getdata))},filterNode:function(t,e){return!t||(-1!==e.Department.indexOf(t)||-1!==e.depart_id.indexOf(t))},searchid:function(){var t=this,e={corpid:this.$store.state.corpid,query_word:this.filterText},s=this,i=s.$createObj(e),a=i["keyvalue"],l=s.$apilist["searchcontact"]+"?signature="+a;s.$server.post(l,i["fd"]).then((function(e){var s=[],i=[];if(0!=Object.keys(e.query_result).length&&-1!=Object.keys(e.query_result).indexOf("party"))for(var a in e.query_result.party.department_id)s.push({id:e.query_result.party.department_id[a].toString(),depart_id:e.query_result.party.department_id[a].toString(),IsDepart:!0});if(0!=Object.keys(e.query_result).length&&-1!=Object.keys(e.query_result).indexOf("user"))for(var l in e.query_result.user.userid)i.push({id:e.query_result.user.userid[l],IsDepart:!1,depart_id:e.query_result.usermap[e.query_result.user.userid[l]][0]+"-"+e.query_result.user.userid[l]});t.datalist=i.concat(s);for(var r=JSON.stringify(t.list_select),n=0;n<s.length;n++)if(r.indexOf(t.datalist[n].toString())>-1)for(var d=0;d<t.list_select.length;d++)if(t.datalist[n].depart_id==t.list_select[d].depart_id){t.$delete(t.list_select,d);break}})).catch((function(t){}))}},mounted:function(){for(var t in this.datalist=JSON.parse(JSON.stringify(this.getdata)),this.list_select=[],this.departlist)this.list_select.push({depart_id:this.departlist[t].toString(),IsDepart:!(this.departlist[t].split("-").length>1)})},watch:{is_colse:function(t){for(var e in this.list_select=[],this.departlist)this.list_select.push({depart_id:this.departlist[e].toString(),IsDepart:!(this.departlist[e].split("-").length>1)})},getdata:function(){for(var t in this.getTreeData(),this.departlist)this.selectlist.push(this.departlist[t].depart_id);var e=this;setTimeout((function(){e.departlist.length>0&&this.$refs.tree.setCheckedKeys(e.departlist)}),500)},filterText:function(t){this.$refs.tree.filter(t)},departlist:function(t){if(this.$refs.tree.setCheckedKeys(this.departlist),""==this.filterText)for(var e in this.list_select=[],this.departlist)this.list_select.push({depart_id:this.departlist[e].toString(),IsDepart:!(this.departlist[e].split("-").length>1)})}}}),d=n,c=(s("abfe"),s("2877")),o=Object(c["a"])(d,l,r,!1,null,null,null),p=o.exports,u={name:"depart_alert",components:{ElementTree:p},props:{is_add:Boolean,departlist:Array,alldepart:Array,title:String},data:function(){return{my_is_add:!1,my_selectlist:[],my_select_id_list:[],is_colse:!1}},methods:{departSub:function(){if(0==this.my_selectlist.length&&"填报对象"==this.title)return this.$alert(this.title+"为空！","提示",{confirmButtonText:"确定"}),!1;this.$emit("departSub",this.my_selectlist),this.close()},delClick:function(t){this.is_colse=!this.is_colse,this.$delete(this.my_selectlist,t),this.$delete(this.my_select_id_list,t);var e=JSON.stringify(this.my_selectlist);this.my_selectlist=[];var s=this;setTimeout((function(){s.my_selectlist=JSON.parse(e)}),100)},close:function(){this.is_colse=!0,this.my_is_add=!1},getTreelist:function(t){for(var e in this.my_selectlist=t.depart,this.my_select_id_list=[],this.my_selectlist)this.my_select_id_list.push(this.my_selectlist[e].depart_id)},getalldepartmenttree:function(){var t=this,e=(this.$store.state.corpid,this),s=this;this.loading=!0;var i={corpid:this.$store.state.corpid,userid:this.$store.state.userid},a=s.$createObj(i),l=a["keyvalue"],r=s.$apilist["getalldepartment"]+"?signature="+l;this.$server.post(r,a["fd"]).then((function(s){if(e.loading=!1,e.alldepart=s.data,void 0!=t.departlist)for(var i in t.my_selectlist=JSON.parse(JSON.stringify(t.departlist)),t.my_select_id_list=[],t.my_selectlist)t.my_select_id_list.push(t.my_selectlist[i].depart_id)})).catch((function(t){}))}},mounted:function(){},watch:{is_add:function(t){if(t&&(this.is_colse=!1,this.my_is_add=t,void 0!=this.departlist))for(var e in this.my_selectlist=JSON.parse(JSON.stringify(this.departlist)),this.my_select_id_list=[],this.my_selectlist)this.my_select_id_list.push(this.my_selectlist[e].depart_id)},my_is_add:function(t){this.$emit("back",t)}}},_=u,h=(s("a5c0"),Object(c["a"])(_,i,a,!1,null,null,null));e["a"]=h.exports},"92ec":function(t,e,s){"use strict";s("a4d5")},"97dd":function(t,e,s){},a4d5:function(t,e,s){},a5c0:function(t,e,s){"use strict";s("97dd")},a9f5:function(t,e,s){"use strict";s("fbab")},abfe:function(t,e,s){"use strict";s("0d85")},fbab:function(t,e,s){}}]);