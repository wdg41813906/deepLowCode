(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-341a787c"],{"0c7d":function(e,t,i){"use strict";i("d12d")},"0d85":function(e,t,i){},"1d51":function(e,t,i){},"20f5":function(e,t,i){e.exports=i.p+"img/none.d30ea1a5.png"},3386:function(e,t,i){},4841:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"assign_detail"},[s("el-dialog",{attrs:{title:"分配",visible:e.my_is_add,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.my_is_add=t}}},[e.is_show?s("div",[s("el-form",{nativeOn:{submit:function(e){e.preventDefault()}}},[s("el-form-item",{attrs:{label:"分配人员"}},[s("div",{staticClass:"el-input__inner",on:{click:function(t){return e.departClick()}}},[0==e.select_depart.length?s("span",[e._v(" 点击选择 ")]):s("span",[s("GetTreeNameM",{attrs:{openid:e.select_depart[0].id}}),e._v("/"+e._s(e.select_depart[0].id)+" ")],1)])]),e._l(e.leftlist,(function(t){return s("el-form-item",{key:t,attrs:{label:t.field_label}},[s("p",{staticClass:"right_title"},[e._v(" （原始值："+e._s(t.orgin)+"，"),s("span",{staticStyle:{color:"#f56c6c"}},[e._v("剩余值："+e._s(t.left))]),e._v("，"),s("span",{staticStyle:{color:"#67c23a"}},[e._v("已分配值："+e._s(t.used))]),e._v("） ")]),s("el-input",{attrs:{type:"number"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}})],1)}))],2)],1):s("div",[0==e.assignlist.length?s("div",{staticClass:"text_center"},[s("img",{attrs:{src:i("20f5")}}),s("p",[e._v("暂无分配数据")])]):e._e(),e.assignlist.length>0?s("data-tables",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",attrs:{data:e.assignlist,"pagination-props":{pageSizes:[5,10,15]},"row-key":e.row_key,"expand-row-keys":e.expandRowKeys,"table-props":e.tableProps}},[s("el-table-column",{attrs:{label:"用户名/工号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" props.row.ToUserId /"+e._s(t.row.ToUserId)+" ")]}}],null,!1,3431400982)}),e._l(e.assignlist[0].ToValues,(function(t,i){return s("el-table-column",{key:t,attrs:{label:t.field_label},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.ToValues[i].value)+" ")]}}],null,!0)})})),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(i){return e.editorClick(t.row)}}},[s("span",[e._v("编辑")])]),s("el-link",{staticClass:"margin_l_5",attrs:{underline:!1,type:"primary"},on:{click:function(i){return e.delClick(t.row)}}},[e._v("删除")])]}}],null,!1,3969939139)})],2):e._e()],1),e.is_show?s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(t){e.is_show=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.assignSubClick()}}},[e._v("确 定")])],1):s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.assignClick()}}},[e._v("分配")])],1)]),s("DepartAlertMS",{attrs:{is_add:e.is_depart,departlist:e.select_depart},on:{back:e.departBackM,departSub:e.departSubM}})],1)},l=[],a=i("91d3"),o={name:"assign_detail",components:{DepartAlertMS:a["a"]},props:{is_add:Boolean,detail:Object,task_code:String},data:function(){return{tableProps:{border:!0,"header-cell-style":{background:"#eef1f6",color:"#606266"}},my_is_add:!1,leftlist:[],assignlist:[],is_show:!1,is_depart:!1,select_depart:[],departlist_m:[],departlist_select:[],is_editor:!1,editor_detail_as_id:"",num:0,titles:[{prop:"name",label:"名字"},{prop:"orgin",label:"原始值"},{prop:"used",label:"已分配值"},{prop:"left",label:"剩余值"}]}},methods:{assignClick:function(){for(var e in this.select_depart=[],this.leftlist)this.leftlist[e].value="";this.is_editor=!1,this.is_show=!0},delClick:function(e){var t=this;this.$confirm("删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=t,s={corpid:t.$store.state.corpid,userid:t.$store.state.userid,data_code:t.detail.Code,as_id:e.Id},l=i.$createObj(s),a=l["keyvalue"],o=i.$apilist["deloneassigndata"]+"?signature="+a;i.$server.post(o,l["fd"]).then((function(){t.allassigndata(),t.leftvalue(),t.$message({type:"success",message:"删除成功!"})})).catch((function(e){}))}))},editorClick:function(e){for(var t in this.is_editor=!0,this.is_show=!0,this.departlist_m=[{id:e.ToUserId,depart_id:e.ToDepartId}],this.select_depart=this.departlist_m,this.editor_detail_as_id=e.Id,e.ToValues)for(var i in this.leftlist)this.leftlist[i].field_code==e.ToValues[t].field_code&&(this.leftlist[i].value=e.ToValues[i].value)},assignSubClick:function(){var e=this,t=this;if(0==this.select_depart.length)return this.$alert("请选择人员！","提示",{confirmButtonText:"确定"}),!1;for(var i in this.leftlist){if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.leftlist[i].value))return this.$alert(this.leftlist[i].field_label+"请填写数字！","提示",{confirmButtonText:"确定"}),!1;this.leftlist[i].value=parseFloat(this.leftlist[i].value)}var s={corpid:this.$store.state.corpid,userid:this.$store.state.userid,to_userid:this.select_depart[0].id,to_departid:this.select_depart[0].depart_id,to_value:JSON.stringify(this.leftlist),data_code:this.detail.Code};this.is_editor&&(s["as_id"]=this.editor_detail_as_id);var l=t.$createObj(s),a=l["keyvalue"],o=t.$apilist["addoneassigndata"]+"?signature="+a;this.is_editor&&(o=t.$apilist["editoneassigndata"]+"?signature="+a),t.$server.post(o,l["fd"]).then((function(t){e.is_show=!1,e.allassigndata(),e.leftvalue()})).catch((function(e){}))},departClick:function(){this.is_depart=!this.is_depart},departBackM:function(e){this.is_depart=e},departSubM:function(e){this.select_depart=e.list},leftvalue:function(){var e=this,t=this,i={corpid:this.$store.state.corpid,userid:this.$store.state.userid,data_code:this.detail.Code},s=t.$createObj(i),l=s["keyvalue"],a=t.$apilist["leftvalue"]+"?signature="+l;t.$server.post(a,s["fd"]).then((function(t){var i=[];for(var s in t.data.left)i.push({value:"",join_gather:t.data.left[s].join_gather,field_code:t.data.left[s].field_code,field_label:t.data.left[s].field_label,left:t.data.left[s].value,orgin:t.data.orgin[s].value,used:t.data.used[s].value});e.leftlist=i})).catch((function(e){}))},allassigndata:function(){var e=this,t=this,i={corpid:this.$store.state.corpid,userid:this.$store.state.userid,data_code:this.detail.Code},s=t.$createObj(i),l=s["keyvalue"],a=t.$apilist["allassigndata"]+"?signature="+l;t.$server.post(a,s["fd"]).then((function(t){e.assignlist=t.data,0==e.assignlist.length?e.is_show=!0:e.is_show=!1})).catch((function(e){}))}},watch:{is_add:function(e){this.my_is_add=e,e&&(this.leftvalue(),this.allassigndata())},my_is_add:function(e){this.$emit("back",e)}}},r=o,n=(i("e5df"),i("2877")),d=Object(n["a"])(r,s,l,!1,null,null,null);t["a"]=d.exports},"4ad9":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"upload_file"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.is_error,expression:"is_error"}]},[i("el-alert",{attrs:{title:"上传失败，请删除附件重新上传！",type:"error"}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}]},[i("el-alert",{attrs:{title:"上传中！",type:"warning"}})],1),i("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"upload-demo",attrs:{action:"",data:e.QiniuData,"on-remove":function(t,i){return e.handleRemoveFile(t,i,e.item)},"on-error":e.uploadErrorFile,"on-success":function(t,i,s){return e.uploadSuccessFile(t,i,s,e.item)},"before-remove":function(t,i){return e.beforeRemoveFile(t,i,e.item)},"before-upload":e.beforeAvatarUploadFile,"http-request":function(t,i,s){return e.Upload(t,i,s)},multiple:"","file-list":e.fileList}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传附件")]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传不超过20MB的文件")])],1)],1)},l=[],a=(i("99af"),i("c975"),i("a15b"),i("b0c0"),i("b680"),i("b64b"),i("ac1f"),i("1276"),i("5a6e")),o=i("1d57"),r={name:"upload_file",props:{fileList:Object,item:Object},data:function(){return{imgurl:this.$store.state.imgurl,uploadKey:"0pc99vFCTZFb-FxnwxuyzbVcmlC_n0qkQ37INru4",uploadToken:"gbNuDHhFDyjIRLDXdJ6HRzp-uc_D6QypslKMJ85m",baseUrl:"http://images.xxxx.cn/",QiniuData:{key:"",token:""},domain:"https://upload-z1.qiniup.com",qiniuaddr:"http://cdn.deepgrid.cn/",uploadPicUrl:"",imgList:[],nowTime:"",fileExtension:"",otherlist:[],newFile:{},is_error:!1,loading:!1}},methods:{getval:function(e){var t=[];for(var i in e)-1!=Object.keys(e[i]).join(",").indexOf("response")&&t.push({name:e[i].response.key,hash:e[i].response.hash,url:e[i].url});return t},beforeAvatarUploadFile:function(e){var t=e.name.split(".");this.fileExtension=t.pop(),this.newFile=e},Upload:function(e,t,i){var s=this,l={userid:s.$store.state.userid,file:this.newFile},a=s.$createObj(l),o=s.$apilist["uploadfiles"];this.loading=!0,s.$emit("back_btn",!0),s.$server.post(o,a["fd"]).then((function(e){s.loading=!1;setTimeout((function(){s.uploadPicUrl=e.urlpath,s.otherlist=t,s.fileList.push({name:e.docname,url:s.imgurl+e.urlpath,doccode:e.doccode}),s.item.value=s.fileList,s.is_error=!1,s.loading=!1,s.$emit("back_btn",!1),s.$message.success("添加成功"),s.$emit("updata:item",s.item)}),1e3)})).catch((function(e){s.is_error=!0,s.loading=!1,s.$emit("back_btn",!1)}))},uploadSuccessFile:function(e,t,i,s){return!1},uploadSuccessFile1:function(e,t,i,s){var l=this,a={userid:l.$store.state.userid,file:t},o=l.$createObj(a),r=l.$apilist["uploadfiles"];this.loading=!0,l.$server.post(r,o["fd"]).then((function(e){l.loading=!1;var t=e;setTimeout((function(){l.excellist=t}),1e3)}))},isFileType:function(e){var t=(e[0].size/1048576).toFixed(2),i=e[0].name;return/.(xls|xlsx)$/.test(i)?t>20?(this.$alert("文件过大,请压缩至20M以内再上传!","提示",{confirmButtonText:"确定"}),!1):void 0:(this.$alert("请上传excel文件!","提示",{confirmButtonText:"确定"}),!1)},uploadErrorFile:function(e,t,i){this.$message({message:"上传出错，请重试！",type:"error",center:!0})},handleRemoveFile:function(e,t,i){this.fileList=t,i.value=t,this.$emit("updata:item",i)},beforeRemoveFile:function(e,t,i){}},created:function(){var e;this.nowTime=Object(a["e"])();var t={},i="deepgrid",s=this.uploadToken,l=this.uploadKey,r=Math.round((new Date).getTime()/1e3)+3600;t.scope=i,t.deadline=r,e=Object(o["a"])(s,l,t),this.QiniuData.token=e}},n=r,d=i("2877"),f=Object(d["a"])(n,s,l,!1,null,null,null);t["a"]=f.exports},"56bf":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{staticClass:"detail_alert_dialog form_other_detail_el_dialog",attrs:{title:"详情",visible:e.my_is_add,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.my_is_add=t}}},[i("div",{staticClass:"form_other_detail"},[i("el-row",[i("el-col",{attrs:{span:24}},[e._v("表单名："+e._s(e.detail.FormName))]),i("el-col",{attrs:{span:12}},[e._v("创建人："+e._s(e.detail.CreateUserName))]),i("el-col",{attrs:{span:12}},[e._v("创建时间："+e._s(new Date(e.detail.CreateTime).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"").split(" ")[0]))])],1)],1),e.detail_arr.length>0?i("el-table",{attrs:{data:e.detail_arr,border:"","header-cell-style":{background:"#eef1f6",color:"#606266"}}},[i("el-table-column",{attrs:{prop:"name",width:"150",label:"字段"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!=t.row.str_list&&t.row.str_list.length>0?i("span",[e._v(" "+e._s(t.row.name)+" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.str_list.join(""),placement:"right"}},[i("i",{staticClass:"el-icon-warning-outline"})])],1):i("span",[e._v(" "+e._s(t.row.name))])]}}],null,!1,1451467323)}),i("el-table-column",{attrs:{prop:"value",label:"数值"},scopedSlots:e._u([{key:"default",fn:function(t){return[""!==t.row.opt_label&&"image"!==t.row.opt_label&&"file"!==t.row.opt_label?i("p",[e._v(" "+e._s(t.row.opt_label.split("__")[1])+" ")]):"image"==t.row.opt_label?i("div",e._l(t.row.value,(function(e){return i("span",{key:e,staticClass:"margin_r_10 display_block"},[i("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.url,"preview-src-list":t.row.enable_greater}})],1)})),0):"file"==t.row.opt_label?i("div",e._l(t.row.value,(function(t){return i("div",{key:t},[i("p",[i("span",{staticClass:"upload_list_span",on:{click:function(i){return e.goimg(t.url)}}},[e._v(" "+e._s(t.name)+" ")])])])})),0):i("p",[e._v(e._s(t.row.value))]),null!=t.row.assign_data&&t.row.assign_data.length>0?i("div",[i("el-table",{attrs:{data:t.row.assign_data,border:""}},[i("el-table-column",{attrs:{label:"被分配人",prop:"ToUserName"}}),i("el-table-column",{attrs:{label:"被分配值",prop:"ToValue"}})],1)],1):e._e()]}}],null,!1,3791008091)})],1):e._e(),i("el-form",{staticClass:"auditform",attrs:{"label-width":"150px"}},[null!=e.detail.AuditStates?i("el-form-item",{staticClass:"audit_item",attrs:{label:"审批流程：","label-width":"200px"}},[i("div",{staticClass:"audit_div"},[i("el-timeline",e._l(e.detail.AuditStates,(function(t,s){return i("el-timeline-item",{key:s,attrs:{color:0==t.node_state?"#0bbd87":"#D6D6D6"}},[i("div",[i("div",{staticClass:"left"},[i("p",{staticClass:"audit_title"},[e._v("审批人")]),i("p",{staticClass:"audit_num"},[e._v(" "+e._s(t.userids.length)+"人 "),i("span",[e._v(e._s(0==t.node_state?"(已审批)":"(待审批)"))])])]),i("div",{staticClass:"right"},e._l(t.user_info,(function(s,l){return i("span",{key:s},[e._v(" "+e._s(s.name)+" "),l<t.userids.length-1?i("span",[e._v("/")]):e._e()])})),0)])])})),1)],1)]):e._e()],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[0!=e.detail.State&&2!=e.detail.State?i("el-button",{attrs:{icon:"el-icon-refresh-left",size:"small"},on:{click:function(t){return e.callbackone(e.detail.Code)}}},[e._v(" 撤 回")]):e._e(),i("el-button",{attrs:{icon:"el-icon-delete",size:"small"},on:{click:function(t){return e.delClick(e.detail.Code)}}},[e._v(" 删 除")]),i("el-button",{attrs:{icon:"el-icon-tickets",size:"small"},on:{click:function(t){return e.logClick(e.detail.Code)}}},[e._v(" 日 志")]),i("el-button",{attrs:{icon:"el-icon-edit",size:"small",type:"primary",disabled:0!=e.detail.State&&2!=e.detail.State&&6!=e.detail.State},on:{click:function(t){return e.ediotrFillClick(e.detail.Code)}}},[e._v(" 编 辑")])],1)],1),i("LogAlert",{attrs:{is_add:e.is_log,code:e.logcode},on:{back:e.logBack}}),i("FillEditorAlert",{attrs:{is_add:e.is_editor,form_data:e.form_data,detail:e.detail,main_code:e.main_code,task_code:e.task_code},on:{back:e.fillEBack,subback:e.editorSubBack}})],1)},l=[],a=i("ade3"),o=i("7239"),r=i("7f91"),n={name:"detail_alert_dialog",props:{is_add:Boolean,detail:Object},components:{LogAlert:r["a"],FillEditorAlert:o["a"]},data:function(){var e;return e={form_data:{},imgurl:this.$store.state.imgurl,tableProps:{border:!0,"header-cell-style":{background:"#eef1f6",color:"#606266"}},coprid:this.$store.state.corpid,my_is_add:!1,is_editor:!1,is_log:!1,logcode:""},Object(a["a"])(e,"is_editor",!1),Object(a["a"])(e,"main_code",""),Object(a["a"])(e,"detail_arr",[]),e},methods:{goimg:function(e){return window.open(e),!1},ediotrFillClick:function(e){this.main_code=e,this.is_editor=!this.is_editor},fillEBack:function(e){this.is_editor=e},editorSubBack:function(){this.$emit("otherback"),this.my_is_add=!this.my_is_add},logClick:function(e){this.logcode=e,this.is_log=!this.is_log},logBack:function(e){this.is_log=e},editorClick:function(){this.is_editor=!this.is_editor},editorBack:function(e){this.is_editor=e},delClick:function(e){var t=this;this.$confirm("删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=t,s={corpid:t.$store.state.corpid,userid:t.$store.state.userid,code:e},l=i.$createObj(s),a=l["keyvalue"],o=i.$apilist["delone_main"]+"?signature="+a;i.$server.post(o,l["fd"]).then((function(){t.$message({type:"success",message:"删除成功!"}),t.$emit("otherback"),t.my_is_add=!t.my_is_add})).catch((function(e){}))})).catch((function(){}))},callbackone:function(e){var t=this;this.$confirm("撤回该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=t,s={corpid:t.$store.state.corpid,userid:t.$store.state.userid,main_code:e},l=i.$createObj(s),a=l["keyvalue"],o=i.$apilist["callbackone"]+"?signature="+a;i.$server.post(o,l["fd"]).then((function(){t.$message({type:"success",message:"撤回成功!"}),t.$emit("otherback"),t.my_is_add=!t.my_is_add})).catch((function(e){}))})).catch((function(){}))},getimgurl:function(e,t){for(var i in t.enable_greater=[],t.value)t.enable_greater.push(t.value[i].url)},getformdetail:function(){var e=this,t=this,i={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.detail.FormCode},s=t.$createObj(i),l=s["keyvalue"],a=t.$apilist["formdetail"]+"?signature="+l;t.$server.post(a,s["fd"]).then((function(t){e.form_data=t.data,e.form_data.form_code=e.detail.FormCode})).catch((function(e){}))}},watch:{is_add:function(e){if(this.my_is_add=e,this.detail_arr=[],e)for(var t in this.getformdetail(),this.detail.FormFieldInfos){if("image"==this.detail.FormFieldInfos[t].opt_label)for(var i in this.enable_assign=[],this.detail.FormFieldInfos[t].enable_greater=[],this.detail.FormFieldInfos[t].value)this.getimgurl(this.detail.FormFieldInfos[t].value[i],this.detail.FormFieldInfos[t]);this.detail_arr.push({name:this.detail.FormFieldInfos[t].field_label,value:this.detail.FormFieldInfos[t].value,assign_data:this.detail.FormFieldInfos[t].assign_data,opt_label:this.detail.FormFieldInfos[t].opt_label,enable_greater:this.detail.FormFieldInfos[t].enable_greater,str_list:this.detail.FormFieldInfos[t].str_list})}},my_is_add:function(e){this.$emit("back",e)}}},d=n,f=(i("d9e9"),i("2877")),_=Object(f["a"])(d,s,l,!1,null,null,null);t["a"]=_.exports},6136:function(e,t,i){},7239:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fill_alert"},[i("el-dialog",{staticClass:"fill_alert_dialog",attrs:{title:"编辑",visible:e.my_is_add,"close-on-click-modal":!1,"custom-class":"depart_aldert_dialog",width:"600px",height:"700px","append-to-body":!0},on:{"update:visible":function(t){e.my_is_add=t},close:e.close}},[i("div",{},[i("el-form",{attrs:{"label-position":"left","label-width":e.form_data.labelWidth},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",{attrs:{label:"表单"}},[e._v(e._s(e.form_data.title)+" ")])],1),i("el-form",{staticClass:"add_form",attrs:{"label-width":e.form_data.labelWidth+"px","label-position":e.form_data.labelPosition}},[""!=e.form_data.remark?i("el-form-item",{staticClass:"remark_style"},[e._v(" "+e._s(e.form_data.remark)+" ")]):e._e(),e._l(e.other_data.FField,(function(t,s){return i("div",{key:t},["divider"==t.tagIcon||"describe"==t.tagIcon||"describeImg"==t.tagIcon?i("el-form-item",["divider"==t.tagIcon?i("div",[i("el-divider")],1):"describe"==t.tagIcon?i("div",[i("el-tag",[e._v(e._s(t.placeholder))])],1):i("div",[i("el-image",{attrs:{src:t.placeholder}})],1)]):"upload"==t.tagIcon?i("el-form-item",{attrs:{"label-width":t.labelWidth>0?t.labelWidth+"px":e.form_data.labelWidth+"px",label:t.label,"label-position":e.form_data.labelPosition,required:t.required}},[i("uploadFile",{attrs:{item:t,fileList:t.value},on:{back_btn:e.back_btn}})],1):"image"==t.tagIcon?i("el-form-item",{attrs:{"label-width":t.labelWidth>0?t.labelWidth+"px":e.form_data.labelWidth+"px",label:t.label,"label-position":e.form_data.labelPosition,required:t.required}},[i("uploadImg",{attrs:{item:t,imgList:t.value},on:{back_btn:e.back_btn}})],1):"calculate"==t.tagIcon?i("el-form-item",{attrs:{"label-width":t.labelWidth>0?t.labelWidth+"px":e.form_data.labelWidth+"px",label:t.label,"label-position":e.form_data.labelPosition}},[i("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.label)+" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.strlist.join(""),placement:"right"}},[i("i",{staticClass:"el-icon-warning-outline"})])],1),i("span",{staticClass:"calculate_span display_inline_block"},[e._v(" "+e._s(null==t.value?0:t.value)+" ")]),t.enable_assign?i("el-button",{staticClass:"margin_l_15",attrs:{size:"medium",type:"text"},on:{click:function(i){return e.assignClick(t,s)}}},[e._v("分配")]):e._e(),null!=t.assign_data?i("div",[null!=t.assign_data&&0!=t.assign_data.length?i("span",{staticClass:"success"},[e._v(" 未分配值："+e._s(e.calOther(t.value,s,t.assign_data))+" ")]):e._e(),e._l(t.assign_data,(function(l,a){return i("div",{key:l,staticClass:"margin_top_10"},[i("el-select",{staticClass:"assign_input",attrs:{filterable:"",placeholder:"请选择被分配人","filter-method":e.dataFilter},on:{change:function(t){return e.assignChange()}},model:{value:l.ToUserId,callback:function(t){e.$set(l,"ToUserId",t)},expression:"assignitem.ToUserId"}},e._l(e.userlist,(function(t){return i("el-option",{key:t.uid,attrs:{label:t.name,value:t.uid}},[i("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),i("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.uid))])])})),1),i("el-input",{staticClass:"assign_input margin_l_15",attrs:{placeholder:"请填写分配数值"},on:{input:function(i){return e.cal(t.value,t.assign_data,s)}},model:{value:l.ToValue,callback:function(t){e.$set(l,"ToValue",t)},expression:"assignitem.ToValue"}}),i("i",{staticClass:"el-icon-remove assign_icon assign_error danger",on:{click:function(i){return e.removeassign(t,a)}}}),a===t.assign_data.length-1?i("i",{staticClass:"el-icon-circle-plus assign_icon assign_add primary",on:{click:function(i){return e.assignClick(t,s)}}}):e._e()],1)}))],2):e._e()],1):"calculate"!=t.tagIcon?i("el-form-item",{attrs:{"label-width":t.labelWidth>0?t.labelWidth+"px":e.form_data.labelWidth+"px",label:t.label,"label-position":e.form_data.labelPosition,required:t.required}},["input"==t.tagIcon?i("div",[i("el-input",{attrs:{placeholder:t.placeholder,maxlength:t.maxlength,size:"medium"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}})],1):e._e(),"textarea"==t.tagIcon?i("div",[i("el-input",{attrs:{type:"textarea",rows:3,maxlength:t.maxlength,placeholder:t.placeholder},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}})],1):e._e(),"number"==t.tagIcon?i("div",[i("el-input",{attrs:{placeholder:t.placeholder,size:"medium"},on:{input:function(t){return e.enterClick(t)}},model:{value:t.value,callback:function(i){e.$set(t,"value","string"===typeof i?i.trim():i)},expression:"item.value"}}),t.enable_assign?i("el-button",{staticClass:"margin_l_15",attrs:{size:"medium",type:"text"},on:{click:function(i){return e.assignClick(t,s)}}},[e._v("分配")]):e._e(),null!=t.assign_data?i("div",[null!=t.assign_data&&0!=t.assign_data.length?i("span",{staticClass:"success"},[e._v(" 未分配值："+e._s(e.calOtherNum(t.value,s,t.assign_data))+" ")]):e._e(),e._l(t.assign_data,(function(l,a){return i("div",{key:l,staticClass:"margin_top_10"},[i("el-select",{staticClass:"assign_input",attrs:{filterable:"",placeholder:"请选择被分配人","filter-method":e.dataFilter},on:{change:function(t){return e.assignChange()}},model:{value:l.ToUserId,callback:function(t){e.$set(l,"ToUserId",t)},expression:"assignitem.ToUserId"}},e._l(e.userlist,(function(t){return i("el-option",{key:t.uid,attrs:{label:t.name,value:t.uid}},[i("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),i("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.uid))])])})),1),i("el-input",{staticClass:"assign_input margin_l_15",attrs:{placeholder:"请填写分配数值"},on:{input:function(i){return e.cal(t.value,t.assign_data,s)}},model:{value:l.ToValue,callback:function(t){e.$set(l,"ToValue",t)},expression:"assignitem.ToValue"}}),i("i",{staticClass:"el-icon-remove assign_icon assign_error danger",on:{click:function(i){return e.removeassign(t,a)}}}),a===t.assign_data.length-1?i("i",{staticClass:"el-icon-circle-plus assign_icon assign_add primary",on:{click:function(i){return e.assignClick(t,s)}}}):e._e()],1)}))],2):e._e()],1):e._e(),"date"==t.tagIcon?i("div",[i("el-date-picker",{attrs:{type:"date",placeholder:t.placeholder,size:"medium"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}})],1):e._e(),"select"==t.tagIcon?i("div",[i("el-select",{attrs:{placeholder:t.placeholder,size:"medium"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}},e._l(t.options,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"select_number"==t.tagIcon?i("div",[0==t.is_counted?i("span",[e._v(e._s(e.otherfn(t)))]):e._e(),i("el-select",{attrs:{placeholder:t.placeholder,size:"medium"},on:{change:function(t){return e.selectNChage(t)}},model:{value:t.is_counted,callback:function(i){e.$set(t,"is_counted",i)},expression:"item.is_counted"}},e._l(t.options,(function(e){return i("el-option",{key:e.value+"__"+e.label,attrs:{label:e.label,value:("object"==typeof e.value?JSON.stringify(e.value):e.value)+"__"+e.label}})})),1)],1):e._e(),"rate"==t.tagIcon?i("div",[i("el-rate",{attrs:{"allow-half":t["allow-half"]},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}})],1):e._e()]):e._e()],1)}))],2)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){return e.close()}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.submitClick()}}},[e._v("确 定")])],1)])],1)},l=[],a=(i("4de4"),i("c975"),i("b0c0"),i("b680"),i("d3b7"),i("ac1f"),i("25f0"),i("1276"),i("53ca"),i("991d")),o=i("4ad9"),r={name:"fill_alert",props:{is_add:Boolean,form_data:Object,task_code:String,main_code:String,detail:Object},components:{uploadImg:a["a"],uploadFile:o["a"]},data:function(){return{other_data:{},my_is_add:!1,form_fields:[],assigndetail:{},is_assign:!1,userlist:[],userlist_two:[],userlist_to:[],userlist_two_to:[],assign_other:[],form_fields_select:[],btn_disable:!1}},methods:{back_btn:function(e){this.btn_disable=e},addindex:function(e,t){this.assign_other[e]=t},calOtherNum:function(e,t,i){for(var s in this.assign_other[t]=e,i){if("number"!=typeof i[s].ToValue&&("."==i[s].ToValue.split("")[i[s].ToValue.length-1]||""==i[s].ToValue))break;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(i[s].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;e=this.subtr(e,parseFloat(i[s].ToValue))}return this.assign_other[t]=e,e},calOther:function(e,t,i){for(var s in this.assign_other[t]=e,i){if("number"!=typeof i[s].ToValue&&("."==i[s].ToValue.split("")[i[s].ToValue.length-1]||""==i[s].ToValue))break;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(i[s].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;e=this.subtr(e,parseFloat(i[s].ToValue))}return this.assign_other[t]=e,e},cal:function(e,t,i){var s=parseFloat(e);for(var l in t){if("."==t[l].ToValue.split("")[t[l].ToValue.length-1]||""==t[l].ToValue)break;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(t[l].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;s=this.subtr(s,parseFloat(t[l].ToValue))}this.assign_other[i]=s},subtr:function(e,t){var i,s,l,a;try{i=e.toString().split(".")[1].length}catch(o){i=0}try{s=t.toString().split(".")[1].length}catch(o){s=0}return l=Math.pow(10,Math.max(i,s)),a=i>=s?i:s,((e*l-t*l)/l).toFixed(a)},isNum:function(e){if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(e))return this.$alert(" 请填写数字!","提示",{confirmButtonText:"确定"}),e="",!1},removeassign:function(e,t){this.$delete(e.assign_data,t)},addassign:function(e){},assignClick:function(e,t){if(null==e.value||0==e.value)return this.$alert(" 请先填写，再分配!","提示",{confirmButtonText:"确定"}),!1;this.assignChange(),null==e.assign_data?(e.assign_data=[],e["assign_data"].push({ToUserId:"",ToValue:""})):e["assign_data"].push({ToUserId:"",ToValue:""})},otherfn:function(e){return e.is_counted="",e.join_gather="",""},close:function(){this.btn_disable=!1,this.my_is_add=!1},selectNChage:function(e){this.subClick()},enterClick:function(e){return"."!=e.split("")[e.length-1]&&""!=e&&(/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(e)?void this.subClick():(this.$alert(" 请填写数字!","提示",{confirmButtonText:"确定"}),!1))},getnowdate:function(e){var t=new Date(e),i=t.getFullYear(),s=t.getMonth()+1,l=t.getDate();return s<10&&(s="0"+s),l<10&&(l="0"+l),i+"/"+s+"/"+l},countselected:function(e){var t=this,i=[];for(var s in this.form_fields)if(this.form_fields[s].required)if("number"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)});else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;"select_number"==this.form_fields[s].tagIcon?this.form_fields[s].is_counted.split("]}__").length<2?i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])}):(this.form_fields[s].join_gather,i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].join_gather)})):"date"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)}):"image"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):"upload"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value})}else if("number"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)});else if("select_number"==this.form_fields[s].tagIcon)this.form_fields[s].is_counted.split("]}__").length<2?i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])}):(this.form_fields[s].join_gather,i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].join_gather)}));else if("date"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)});else if("image"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else if("upload"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;var l=this.form_fields[s].enable_assign;i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:l,value:this.form_fields[s].value})}var a=JSON.parse(e.is_counted.split("__")[0]).str_id_list,o=this,r={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,file_info:JSON.stringify(i),formula_method:JSON.stringify(a)},n=o.$createObj(r),d=n["keyvalue"],f=o.$apilist["countselected"]+"?signature="+d;o.$server.post(f,n["fd"]).then((function(i){e.join_gather=i.data,t.subClickTwo()})).catch((function(e){}))},subClick:function(){var e=this;for(var t in this.form_fields_select)this.form_fields_select[t].is_counted.split("]}__").length>1&&this.countselected(this.form_fields_select[t]);var i=[];for(var s in this.form_fields)if(this.form_fields[s].required)if("number"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)});else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;"select_number"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])}):"image"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):"upload"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):"date"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)}):i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value})}else if("number"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)});else if("select_number"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])});else if("date"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)});else if("image"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else if("upload"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;var l=this.form_fields[s].enable_assign;i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:l,value:this.form_fields[s].value})}var a=this,o={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,rule_file_info:JSON.stringify(i)},r=a.$createObj(o),n=r["keyvalue"],d=a.$apilist["countfunction"]+"?signature="+n;a.$server.post(d,r["fd"]).then((function(t){if(t.data.length>0)for(var i in t.data)for(var s in e.other_data.FField)e.other_data.FField[s].filed_code==t.data[i].field_code&&(e.other_data.FField[s].value=t.data[i].value)})).catch((function(e){}))},subClickTwo:function(){var e=this,t=[];for(var i in this.form_fields)if(this.form_fields[i].required)if("number"==this.form_fields[i].tagIcon)t.push({field_code:this.form_fields[i].filed_code,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:parseFloat(this.form_fields[i].value)});else{if("divider"==this.form_fields[i].tagIcon||"describe"==this.form_fields[i].tagIcon||"describeImg"==this.form_fields[i].tagIcon)continue;"select_number"==this.form_fields[i].tagIcon?this.form_fields[i].is_counted.split("]}__").length<2?t.push({field_code:this.form_fields[i].filed_code,opt_label:this.form_fields[i].is_counted,field_label:this.form_fields[i].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:parseFloat(this.form_fields[i].is_counted.split("__")[0])}):(this.form_fields[i].join_gather,t.push({field_code:this.form_fields[i].filed_code,opt_label:this.form_fields[i].is_counted,field_label:this.form_fields[i].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:parseFloat(this.form_fields[i].join_gather)})):"date"==this.form_fields[i].tagIcon?t.push({field_code:this.form_fields[i].filed_code,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:this.getnowdate(this.form_fields[i].value)}):"image"==this.form_fields[i].tagIcon?t.push({field_code:this.form_fields[i].filed_code,opt_label:"image",field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:!1,enable_assign:this.form_fields[i].enable_assign,value:this.form_fields[i].value}):"upload"==this.form_fields[i].tagIcon?t.push({field_code:this.form_fields[i].filed_code,opt_label:"file",field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:!1,enable_assign:this.form_fields[i].enable_assign,value:this.form_fields[i].value}):t.push({field_code:this.form_fields[i].filed_code,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:this.form_fields[i].value})}else if("number"==this.form_fields[i].tagIcon)t.push({field_code:this.form_fields[i].filed_code,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:parseFloat(this.form_fields[i].value)});else if("select_number"==this.form_fields[i].tagIcon)this.form_fields[i].is_counted.split("]}__").length<2?t.push({field_code:this.form_fields[i].filed_code,opt_label:this.form_fields[i].is_counted,field_label:this.form_fields[i].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:parseFloat(this.form_fields[i].is_counted.split("__")[0])}):(this.form_fields[i].join_gather,t.push({field_code:this.form_fields[i].filed_code,opt_label:this.form_fields[i].is_counted,field_label:this.form_fields[i].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:parseFloat(this.form_fields[i].join_gather)}));else if("date"==this.form_fields[i].tagIcon)t.push({field_code:this.form_fields[i].filed_code,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:this.getnowdate(this.form_fields[i].value)});else if("image"==this.form_fields[i].tagIcon)t.push({field_code:this.form_fields[i].filed_code,opt_label:"image",field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:this.form_fields[i].value});else if("upload"==this.form_fields[i].tagIcon)t.push({field_code:this.form_fields[i].filed_code,opt_label:"file",field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:this.form_fields[i].value});else{if("divider"==this.form_fields[i].tagIcon||"describe"==this.form_fields[i].tagIcon||"describeImg"==this.form_fields[i].tagIcon)continue;var s=this.form_fields[i].enable_assign;t.push({field_code:this.form_fields[i].filed_code,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:s,value:this.form_fields[i].value})}var l=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,rule_file_info:JSON.stringify(t)},o=l.$createObj(a),r=o["keyvalue"],n=l.$apilist["countfunction"]+"?signature="+r;l.$server.post(n,o["fd"]).then((function(t){if(t.data.length>0)for(var i in t.data)for(var s in e.other_data.FField)e.other_data.FField[s].filed_code==t.data[i].field_code&&(e.other_data.FField[s].value=t.data[i].value)})).catch((function(e){}))},submitClick:function(){var e=this,t=[];for(var i in this.form_fields)if(this.form_fields[i].required){if("select_number"==this.form_fields[i].tagIcon){if(0==this.form_fields[i].is_counted)return this.$alert("请选择 "+this.form_fields[i].label+" !","提示",{confirmButtonText:"确定"}),!1}else if("number"==this.form_fields[i].tagIcon){if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[i].value))return this.$alert(this.form_fields[i].label+" 请填写数字!","提示",{confirmButtonText:"确定"}),!1}else if((null==this.form_fields[i].value||""==this.form_fields[i].value)&&"divider"!=this.form_fields[i].tagIcon&&"describe"!=this.form_fields[i].tagIcon&&"describeImg"!=this.form_fields[i].tagIcon)return this.$alert("请填写 "+this.form_fields[i].label+" !","提示",{confirmButtonText:"确定"}),!1;if("number"==this.form_fields[i].tagIcon){for(var s in this.form_fields[i].assign_data){if(""==this.form_fields[i].assign_data[s].ToUserId||""==this.form_fields[i].assign_data[s].ToValue)return this.$alert(this.form_fields[i].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[i].assign_data[s].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[i].assign_data[s].ToValue=parseFloat(this.form_fields[i].assign_data[s].ToValue)}t.push({field_code:this.form_fields[i].filed_code,assign_data:this.form_fields[i].assign_data,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:parseFloat(this.form_fields[i].value)})}else if("calculate"==this.form_fields[i].tagIcon){for(var l in this.form_fields[i].assign_data){if(""==this.form_fields[i].assign_data[l].ToUserId||""==this.form_fields[i].assign_data[l].ToValue)return this.$alert(this.form_fields[i].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[i].assign_data[l].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[i].assign_data[l].ToValue=parseFloat(this.form_fields[i].assign_data[l].ToValue)}t.push({field_code:this.form_fields[i].filed_code,assign_data:this.form_fields[i].assign_data,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:parseFloat(this.form_fields[i].value)})}else{if("divider"==this.form_fields[i].tagIcon||"describe"==this.form_fields[i].tagIcon||"describeImg"==this.form_fields[i].tagIcon)continue;"select_number"==this.form_fields[i].tagIcon?t.push({field_code:this.form_fields[i].filed_code,opt_label:this.form_fields[i].is_counted,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:!1,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:parseFloat(this.form_fields[i].is_counted.split("__")[0])}):"image"==this.form_fields[i].tagIcon?t.push({field_code:this.form_fields[i].filed_code,opt_label:"image",field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:!1,enable_assign:this.form_fields[i].enable_assign,value:this.form_fields[i].value}):"upload"==this.form_fields[i].tagIcon?t.push({field_code:this.form_fields[i].filed_code,opt_label:"file",field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:this.form_fields[i].value}):"date"==this.form_fields[i].tagIcon?t.push({field_code:this.form_fields[i].filed_code,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:this.getnowdate(this.form_fields[i].value)}):t.push({field_code:this.form_fields[i].filed_code,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:this.form_fields[i].value})}}else if("number"==this.form_fields[i].tagIcon){for(var a in this.form_fields[i].assign_data){if(""==this.form_fields[i].assign_data[a].ToUserId||""==this.form_fields[i].assign_data[a].ToValue)return this.$alert(this.form_fields[i].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[i].assign_data[a].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[i].assign_data[a].ToValue=parseFloat(this.form_fields[i].assign_data[a].ToValue)}t.push({field_code:this.form_fields[i].filed_code,assign_data:this.form_fields[i].assign_data,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:parseFloat(this.form_fields[i].value)})}else if("calculate"==this.form_fields[i].tagIcon){for(var o in this.form_fields[i].assign_data){if(""==this.form_fields[i].assign_data[o].ToUserId||""==this.form_fields[i].assign_data[o].ToValue)return this.$alert(this.form_fields[i].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[i].assign_data[o].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[i].assign_data[o].ToValue=parseFloat(this.form_fields[i].assign_data[o].ToValue)}t.push({field_code:this.form_fields[i].filed_code,assign_data:this.form_fields[i].assign_data,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:parseFloat(this.form_fields[i].value)})}else{if("divider"==this.form_fields[i].tagIcon||"describe"==this.form_fields[i].tagIcon||"describeImg"==this.form_fields[i].tagIcon)continue;if("select_number"==this.form_fields[i].tagIcon)t.push({field_code:this.form_fields[i].filed_code,opt_label:this.form_fields[i].is_counted,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:!1,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:parseFloat(this.form_fields[i].is_counted.split("__")[0])});else if("image"==this.form_fields[i].tagIcon)t.push({field_code:this.form_fields[i].filed_code,opt_label:"image",field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:!1,enable_assign:this.form_fields[i].enable_assign,value:this.form_fields[i].value});else if("upload"==this.form_fields[i].tagIcon)t.push({field_code:this.form_fields[i].filed_code,opt_label:"file",field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:this.form_fields[i].enable_assign,value:this.form_fields[i].value});else if("date"==this.form_fields[i].tagIcon)t.push({field_code:this.form_fields[i].filed_code,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:!1,enable_assign:this.form_fields[i].enable_assign,value:this.getnowdate(this.form_fields[i].value)});else{var r=this.form_fields[i].enable_assign;t.push({field_code:this.form_fields[i].filed_code,field_label:this.form_fields[i].label,join_gather:this.form_fields[i].join_gather,is_counted:this.form_fields[i].is_counted,enable_greater:this.form_fields[i].enable_greater,enable_assign:r,value:this.form_fields[i].value})}}var n=this,d={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,form_field_info:JSON.stringify(t),main_code:this.other_data.Code},f=n.$createObj(d),_=f["keyvalue"],c=n.$apilist["edit"]+"?signature="+_;n.$server.post(c,f["fd"]).then((function(t){e.$message({message:"修改成功！",type:"success"}),e.$emit("subback"),e.close()})).catch((function(e){}))},dataFilter:function(e){this.userlist=this.userlist_two.filter((function(t){if(-1!==t.uid.indexOf(e)||-1!==t.name.indexOf(e))return!0}))},dataFilterTo:function(e){this.userlist_to=this.userlist_two_to.filter((function(t){if(-1!==t.uid.indexOf(e)||-1!==t.name.indexOf(e))return!0}))},assignChangeTo:function(){this.userlist=this.userlist_two},assignChange:function(){this.userlist=this.userlist_two},alluser:function(){var e=this,t=this,i={corpid:this.$store.state.corpid,userid:this.$store.state.userid},s=t.$createObj(i),l=s["keyvalue"],a=t.$apilist["allusernameandid"]+"?signature="+l;t.$server.post(a,s["fd"]).then((function(t){e.userlist=t.data,e.userlist_two=Object.assign(t.data)})).catch((function(e){}))},detailbycode:function(){var e=this,t=this,i={corpid:this.$store.state.corpid,userid:this.$store.state.userid,main_code:this.main_code},s=t.$createObj(i),l=s["keyvalue"],a=t.$apilist["detailbycode"]+"?signature="+l;t.$server.post(a,s["fd"]).then((function(t){for(var i in e.other_data=t.data,e.form_fields=e.other_data.FField,e.form_fields){for(var s in e.other_data.FormFieldInfos)e.form_fields[i].filed_code==e.other_data.FormFieldInfos[s].field_code&&(e.form_fields[i].value=e.other_data.FormFieldInfos[s].value,""!==e.other_data.FormFieldInfos[s]["opt_label"]&&(e.form_fields[i].opt_label=e.other_data.FormFieldInfos[s].opt_label,e.form_fields[i].is_counted=e.other_data.FormFieldInfos[s].opt_label));for(var l in e.detail.FormFieldInfos)e.form_fields[i].filed_code!=e.detail.FormFieldInfos[l].field_code||"image"!=e.detail.FormFieldInfos[l].opt_label&&"file"!=e.detail.FormFieldInfos[l].opt_label||(e.form_fields[i].value=e.detail.FormFieldInfos[l].value)}for(var a in e.form_fields_select=[],e.form_fields)"select_number"==e.form_fields[a].tagIcon&&e.form_fields_select.push(e.form_fields[a]);6==t.data.State&&e.subClick()})).catch((function(e){}))},getformdetail:function(){var e=this,t=this,i={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.detail.FormCode},s=t.$createObj(i),l=s["keyvalue"],a=t.$apilist["formdetail"]+"?signature="+l;t.$server.post(a,s["fd"]).then((function(t){e.form_data=t.data,e.form_data.form_code=e.detail.FormCode})).catch((function(e){}))}},mounted:function(){this.alluser()},watch:{is_add:function(e){this.my_is_add=e,e&&(this.getformdetail(),this.detailbycode())},my_is_add:function(e){this.$emit("back",e)}}},n=r,d=(i("0c7d"),i("2877")),f=Object(d["a"])(n,s,l,!1,null,null,null);t["a"]=f.exports},"7f91":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"log_detail"},[i("el-dialog",{attrs:{title:"日志",visible:e.my_is_add,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.my_is_add=t}}},[i("data-tables",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",attrs:{data:e.loglist,"pagination-props":{pageSizes:[5,10,15]},"row-key":e.row_key,"expand-row-keys":e.expandRowKeys,"table-props":e.tableProps}},[i("el-table-column",{attrs:{label:"操作人"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.UserName)+" /"+e._s(t.row.UserId)+" ")]}}])}),i("el-table-column",{attrs:{label:"时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(new Date(+new Date(new Date(t.row.CreateTime).toJSON())+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"").slice(0,-3))+" ")]}}])}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[7==t.row.TypeId?i("p",{staticClass:"danger_span"},[e._v(" #"+e._s(t.row.TypeDesc)+"# ")]):i("p",{staticClass:"success_span"},[e._v("#"+e._s(t.row.TypeDesc)+"#")]),i("p",[e._v(e._s(t.row.Remark))])]}}])})],1)],1)],1)},l=[],a={name:"log_detail",props:{is_add:Boolean,code:String},components:{},data:function(){return{tableProps:{border:!0,"header-cell-style":{background:"#eef1f6",color:"#606266"}},my_is_add:!1,loglist:[],loading:!1}},methods:{getallloginfobydatacode:function(){var e=this,t=this,i={corpid:this.$store.state.corpid,userid:this.$store.state.userid,data_code:this.code},s=t.$createObj(i),l=s["keyvalue"],a=t.$apilist["getallloginfobydatacode"]+"?signature="+l;t.$server.post(a,s["fd"]).then((function(t){e.loglist=t.data})).catch((function(e){}))}},watch:{is_add:function(e){this.my_is_add=e,e&&this.getallloginfobydatacode()},my_is_add:function(e){this.$emit("back",e)}}},o=a,r=(i("a7e4"),i("2877")),n=Object(r["a"])(o,s,l,!1,null,null,null);t["a"]=n.exports},"91d3":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"depart_alert"},[i("el-dialog",{staticClass:"depart_alert",attrs:{title:e.title,visible:e.my_is_add,"close-on-click-modal":!1,"custom-class":"depart_aldert_dialog",width:"600px",height:"700px","append-to-body":!0},on:{"update:visible":function(t){e.my_is_add=t},close:e.close}},[i("div",{staticClass:"member_container"},[i("div",{staticClass:"left member_colLeft"},[i("ElementTree",{attrs:{getdata:e.alldepart,departlist:e.my_select_id_list,is_colse:e.is_colse},on:{getTreelist:e.getTreelist}})],1),i("div",{staticClass:"left member_colRight"},[i("ul",e._l(e.my_selectlist,(function(t,s){return i("li",{key:s,staticClass:"step_right_li"},[i("span",{},[e._v(" "+e._s(t.Department)+" ")]),i("i",{staticClass:"el-icon-close del_select",on:{click:function(t){return e.delClick(s)}}}),i("div",{staticClass:"clearfix"})])})),0)]),i("div",{staticClass:"clearfix"}),i("div",{staticClass:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){return e.close()}}},[e._v("取消")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.departSub()}}},[e._v("确定")])],1)])])],1)},l=[],a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"element_tree"},[s("div",{staticClass:"member_coolLeft_top element_left"},[s("el-input",{staticClass:"search_tree",attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1),s("el-tree",{ref:"tree",attrs:{data:e.datalist,"show-checkbox":"","node-key":"depart_id",props:e.defaultProps,"filter-node-method":e.filterNode,"default-expanded-keys":["1"],"default-checked-keys":e.departlist,"check-strictly":!0},on:{"check-change":e.handleCheckChange},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.node;return s("span",{staticClass:"custom-tree-node"},[s("span",[1==l.data.IsDepart||"true"==l.data.IsDepart?s("img",{attrs:{src:i("b945"),alt:""}}):s("img",{attrs:{src:i("059b"),alt:""}})]),e._v(" "+e._s(l.label)+" ")])}}])},[e._v(" > ")])],1)},o=[],r=(i("99af"),i("4de4"),i("c975"),i("a434"),i("a9e3"),i("b64b"),i("d3b7"),i("ac1f"),i("25f0"),i("1276"),i("5a6e"),{name:"element_tree",props:{getdata:Array,departlist:Array,key:Number,is_colse:Boolean},data:function(){return{datalist:[],defaultProps:{id:"id",label:"Department",children:"Children",parent_id:"ParentId",depart_id:"depart_id",IsDepart:"IsDepart",disabled:"IsDepart"},filterText:"",selectlist:[],list_select:[]}},methods:{handleCheckChange:function(e,t,i){if(this.getCheckedNodes(),t){var s=[e.depart_id];this.$refs.tree.setCheckedKeys(s),this.getCheckedNodes()}else this.getCheckedNodes()},getCheckedNodes:function(){var e=this.$refs.tree.getCheckedNodes(),t=[],i=[],s=[];for(var l in e)-1==s.indexOf(parseInt(e[l].ParentId))&&(1==e[l].IsDepart?t.push(e[l]):i.push(e[l])),s.push(parseInt(e[l].DepartId));this.unique(e);this.$emit("getTreelist",{depart:e,label:i})},unique:function(e){for(var t=0;t<e.length;t++)for(var i=t+1;i<e.length;i++)e[t].depart_id==e[i].depart_id&&(e.splice(i,1),i--);return e},getHalfCheckedNodes:function(){},getTreeData:function(){this.datalist=JSON.parse(JSON.stringify(this.getdata))},filterNode:function(e,t){return!e||(-1!==t.Department.indexOf(e)||-1!==t.depart_id.indexOf(e))},searchid:function(){var e=this,t={corpid:this.$store.state.corpid,query_word:this.filterText},i=this,s=i.$createObj(t),l=s["keyvalue"],a=i.$apilist["searchcontact"]+"?signature="+l;i.$server.post(a,s["fd"]).then((function(t){var i=[],s=[];if(0!=Object.keys(t.query_result).length&&-1!=Object.keys(t.query_result).indexOf("party"))for(var l in t.query_result.party.department_id)i.push({id:t.query_result.party.department_id[l].toString(),depart_id:t.query_result.party.department_id[l].toString(),IsDepart:!0});if(0!=Object.keys(t.query_result).length&&-1!=Object.keys(t.query_result).indexOf("user"))for(var a in t.query_result.user.userid)s.push({id:t.query_result.user.userid[a],IsDepart:!1,depart_id:t.query_result.usermap[t.query_result.user.userid[a]][0]+"-"+t.query_result.user.userid[a]});e.datalist=s.concat(i);for(var o=JSON.stringify(e.list_select),r=0;r<i.length;r++)if(o.indexOf(e.datalist[r].toString())>-1)for(var n=0;n<e.list_select.length;n++)if(e.datalist[r].depart_id==e.list_select[n].depart_id){e.$delete(e.list_select,n);break}})).catch((function(e){}))}},mounted:function(){for(var e in this.datalist=JSON.parse(JSON.stringify(this.getdata)),this.list_select=[],this.departlist)this.list_select.push({depart_id:this.departlist[e].toString(),IsDepart:!(this.departlist[e].split("-").length>1)})},watch:{is_colse:function(e){for(var t in this.list_select=[],this.departlist)this.list_select.push({depart_id:this.departlist[t].toString(),IsDepart:!(this.departlist[t].split("-").length>1)})},getdata:function(){for(var e in this.getTreeData(),this.departlist)this.selectlist.push(this.departlist[e].depart_id);var t=this;setTimeout((function(){t.departlist.length>0&&this.$refs.tree.setCheckedKeys(t.departlist)}),500)},filterText:function(e){this.$refs.tree.filter(e)},departlist:function(e){if(this.$refs.tree.setCheckedKeys(this.departlist),""==this.filterText)for(var t in this.list_select=[],this.departlist)this.list_select.push({depart_id:this.departlist[t].toString(),IsDepart:!(this.departlist[t].split("-").length>1)})}}}),n=r,d=(i("abfe"),i("2877")),f=Object(d["a"])(n,a,o,!1,null,null,null),_=f.exports,c={name:"depart_alert",components:{ElementTree:_},props:{is_add:Boolean,departlist:Array,alldepart:Array,title:String},data:function(){return{my_is_add:!1,my_selectlist:[],my_select_id_list:[],is_colse:!1}},methods:{departSub:function(){if(0==this.my_selectlist.length&&"填报对象"==this.title)return this.$alert(this.title+"为空！","提示",{confirmButtonText:"确定"}),!1;this.$emit("departSub",this.my_selectlist),this.close()},delClick:function(e){this.is_colse=!this.is_colse,this.$delete(this.my_selectlist,e),this.$delete(this.my_select_id_list,e);var t=JSON.stringify(this.my_selectlist);this.my_selectlist=[];var i=this;setTimeout((function(){i.my_selectlist=JSON.parse(t)}),100)},close:function(){this.is_colse=!0,this.my_is_add=!1},getTreelist:function(e){for(var t in this.my_selectlist=e.depart,this.my_select_id_list=[],this.my_selectlist)this.my_select_id_list.push(this.my_selectlist[t].depart_id)},getalldepartmenttree:function(){var e=this,t=(this.$store.state.corpid,this),i=this;this.loading=!0;var s={corpid:this.$store.state.corpid,userid:this.$store.state.userid},l=i.$createObj(s),a=l["keyvalue"],o=i.$apilist["getalldepartment"]+"?signature="+a;this.$server.post(o,l["fd"]).then((function(i){if(t.loading=!1,t.alldepart=i.data,void 0!=e.departlist)for(var s in e.my_selectlist=JSON.parse(JSON.stringify(e.departlist)),e.my_select_id_list=[],e.my_selectlist)e.my_select_id_list.push(e.my_selectlist[s].depart_id)})).catch((function(e){}))}},mounted:function(){},watch:{is_add:function(e){if(e&&(this.is_colse=!1,this.my_is_add=e,void 0!=this.departlist))for(var t in this.my_selectlist=JSON.parse(JSON.stringify(this.departlist)),this.my_select_id_list=[],this.my_selectlist)this.my_select_id_list.push(this.my_selectlist[t].depart_id)},my_is_add:function(e){this.$emit("back",e)}}},u=c,h=(i("a5c0"),Object(d["a"])(u,s,l,!1,null,null,null));t["a"]=h.exports},"97dd":function(e,t,i){},"991d":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.is_error,expression:"is_error"}]},[i("el-alert",{attrs:{title:"上传失败，请删除附件重新上传！",type:"error"}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}]},[i("el-alert",{attrs:{title:"上传中！",type:"warning"}})],1),i("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"upload-pic",attrs:{action:"",data:e.QiniuData,"on-remove":function(t,i){return e.handleRemove(t,i,e.item)},"on-error":e.uploadError,"on-success":function(t,i,s){return e.uploadSuccess(t,i,s,e.item)},"before-remove":function(t,i){return e.beforeRemove(t,i,e.item)},"before-upload":e.beforeAvatarUpload,"http-request":function(t,i,s){return e.Upload(t,i,s)},"list-type":"picture-card",multiple:"","file-list":e.imgList}},[i("i",{staticClass:"el-icon-plus"})])],1)},l=[],a=(i("99af"),i("c975"),i("a15b"),i("b0c0"),i("b64b"),i("ac1f"),i("1276"),i("5a6e")),o=i("1d57"),r=i("0a52"),n={name:"upload_img",props:{item:Object,imgList:Array},data:function(){return{imgurl:this.$store.state.imgurl,uploadKey:"0pc99vFCTZFb-FxnwxuyzbVcmlC_n0qkQ37INru4",uploadToken:"gbNuDHhFDyjIRLDXdJ6HRzp-uc_D6QypslKMJ85m",baseUrl:"http://images.xxxx.cn/",QiniuData:{key:"",token:""},domain:"https://upload-z1.qiniup.com",qiniuaddr:"http://cdn.deepgrid.cn/",uploadPicUrl:"",fileList:[],nowTime:"",fileExtension:"",otherlist:[],newFile:"",is_error:!1,loading:!1}},methods:{beforeAvatarUpload:function(e){var t="image/png"===e.type,i="image/jpeg"===e.type,s="image/jpg"===e.type;if(!t&&!i&&!s)return this.$message.error("上传图片只能是 jpg、png、jpeg 格式!"),!1;var l=e.name.split(".");this.fileExtension=l.pop(),this.newFile=e},Upload:function(e,t,i){var s=this,l={userid:s.$store.state.userid,file:this.newFile};s.$createObj(l),s.$apilist["uploadfiles"];this.loading=!0,Object(r["a"])(this.newFile,{quality:.2},(function(e){var i={userid:s.$store.state.userid,basestr:String(e).split("base64,")[1],shotname:s.newFile.name},l=s.$createObj(i),a=s.$apilist["uploadimages"];s.$emit("back_btn",!0),s.$server.post(a,l["fd"]).then((function(e){setTimeout((function(){s.uploadPicUrl=e.urlpath,s.otherlist=t,s.imgList.push({name:e.docname,url:s.imgurl+e.urlpath,doccode:e.doccode}),s.item.value=s.imgList,s.loading=!1,s.$emit("back_btn",!1),s.$message.success("添加成功"),s.$emit("updata:item",this.item)}),1e3)})).catch((function(e){s.is_error=!0,s.loading=!1,s.$emit("back_btn",!1)}))}))},getval:function(e){var t=[];for(var i in e)-1!=Object.keys(e[i]).join(",").indexOf("response")&&t.push({name:e[i].response.key,hash:e[i].response.hash,url:e[i].url});return t},uploadSuccess:function(e,t,i,s){var l=this;this.uploadPicUrl="".concat(this.qiniuaddr,"/").concat(e.key);var a=this,o={key:e.key},r=a.$createObj(o),n=r["keyvalue"],d=a.$apilist["qiniudown"]+"?signature="+n;a.$server.post(d,r["fd"]).then((function(t){l.uploadPicUrl=t.data,l.imgList.push({name:e.key.split("__"+l.$store.state.corpid)[0]+"."+e.key.split(".").pop(),key:e.key,hash:e.hash,url:t.data}),s.value=l.imgList})).catch((function(e){}))},uploadError:function(e,t,i){this.$message({message:"上传出错，请重试！",type:"error",center:!0})},handleRemove:function(e,t,i){this.imgList=t,i.value=t,this.$emit("updata:item",i)},beforeRemove:function(e,t,i){}},created:function(){var e;this.nowTime=Object(a["e"])();var t={},i="deepgrid",s=this.uploadToken,l=this.uploadKey,r=Math.round((new Date).getTime()/1e3)+3600;t.scope=i,t.deadline=r,e=Object(o["a"])(s,l,t),this.QiniuData.token=e}},d=n,f=i("2877"),_=Object(f["a"])(d,s,l,!1,null,null,null);t["a"]=_.exports},a5c0:function(e,t,i){"use strict";i("97dd")},a7e4:function(e,t,i){"use strict";i("3386")},abfe:function(e,t,i){"use strict";i("0d85")},d12d:function(e,t,i){},d9e9:function(e,t,i){"use strict";i("6136")},e5df:function(e,t,i){"use strict";i("1d51")}}]);