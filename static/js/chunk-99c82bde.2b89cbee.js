(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-99c82bde"],{"014b":function(e,i,s){"use strict";var l=function(){var e=this,i=e.$createElement,s=e._self._c||i;return s("div",{staticClass:"fill_alert"},[s("el-dialog",{staticClass:"fill_alert_dialog",attrs:{title:e.form_data.title,visible:e.my_is_add,"close-on-click-modal":!1,"custom-class":"depart_aldert_dialog",width:"600px",height:"700px","append-to-body":!0},on:{"update:visible":function(i){e.my_is_add=i},close:e.close}},[s("div",{},[s("el-form",{staticClass:"add_form",attrs:{"label-width":e.form_data.labelWidth+"px","label-position":e.form_data.labelPosition},nativeOn:{submit:function(e){e.preventDefault()}}},[""!=e.form_data.remark?s("el-form-item",{staticClass:"remark_style"},[e._v(" "+e._s(e.form_data.remark)+" ")]):e._e(),e._l(e.form_data1.fields,(function(i,l){return s("div",{key:i},["divider"==i.tagIcon||"describe"==i.tagIcon||"describeImg"==i.tagIcon?s("el-form-item",["divider"==i.tagIcon?s("div",[s("el-divider")],1):"describe"==i.tagIcon?s("div",[s("el-tag",[e._v(e._s(i.placeholder))])],1):s("div",[s("el-image",{attrs:{src:i.placeholder}})],1)]):"upload"==i.tagIcon?s("el-form-item",{attrs:{"label-width":i.labelWidth>0?i.labelWidth+"px":e.form_data.labelWidth+"px",label:i.label,"label-position":e.form_data.labelPosition,required:i.required}},[s("uploadFile",{attrs:{item:i,fileList:null===i.value?[]:i.value},on:{back_btn:e.back_btn}})],1):"image"==i.tagIcon?s("el-form-item",{attrs:{"label-width":i.labelWidth>0?i.labelWidth+"px":e.form_data.labelWidth+"px",label:i.label,"label-position":e.form_data.labelPosition,required:i.required}},[s("uploadImg",{attrs:{item:i,imgList:null===i.value?[]:i.value},on:{back_btn:e.back_btn_img}})],1):"calculate"==i.tagIcon?s("el-form-item",{attrs:{"label-width":i.labelWidth>0?i.labelWidth+"px":e.form_data.labelWidth+"px",label:i.label,"label-position":e.form_data.labelPosition}},[s("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(i.label)+" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:i.strlist.join(""),placement:"right"}},[s("i",{staticClass:"el-icon-warning-outline"})])],1),s("span",{staticClass:"calculate_span display_inline_block"},[e._v(" "+e._s(null==i.value?0:i.value)+" ")]),i.enable_assign?s("el-button",{staticClass:"margin_l_15",attrs:{size:"medium",type:"text"},on:{click:function(s){return e.assignClick(i,l)}}},[e._v("分配")]):e._e(),null!=i.assign_data?s("div",[null!=i.assign_data&&0!=i.assign_data.length?s("span",{staticClass:"success"},[e._v(" 未分配值："+e._s(e.calOther(i.value,l,i.assign_data))+" "),s("span",{staticStyle:{color:"#fff"}},[e._v(e._s(e.calOther(i.value,l,i.assign_data))+" ")])]):e._e(),e._l(i.assign_data,(function(t,a){return s("div",{key:t,staticClass:"margin_top_10"},[s("el-select",{staticClass:"assign_input",attrs:{filterable:"",placeholder:"请选择被分配人","filter-method":e.dataFilter},on:{change:function(i){return e.assignChange()}},model:{value:t.ToUserId,callback:function(i){e.$set(t,"ToUserId",i)},expression:"assignitem.ToUserId"}},e._l(e.userlist,(function(i){return s("el-option",{key:i.uid,attrs:{label:i.name,value:i.uid}},[s("span",{staticStyle:{float:"left"}},[e._v(e._s(i.name))]),s("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(i.uid))])])})),1),s("el-input",{staticClass:"assign_input margin_l_15",attrs:{placeholder:"请填写分配数值"},on:{input:function(s){return e.cal(i.value,i.assign_data,l)}},model:{value:t.ToValue,callback:function(i){e.$set(t,"ToValue",i)},expression:"assignitem.ToValue"}}),s("i",{staticClass:"el-icon-remove assign_icon assign_error danger",on:{click:function(s){return e.removeassign(i,a)}}}),a===i.assign_data.length-1?s("i",{staticClass:"el-icon-circle-plus assign_icon assign_add primary",on:{click:function(s){return e.assignClick(i,l)}}}):e._e()],1)}))],2):e._e()],1):"calculate"!=i.tagIcon?s("el-form-item",{attrs:{"label-width":i.labelWidth>0?i.labelWidth+"px":e.form_data.labelWidth+"px",label:i.label,"label-position":e.form_data.labelPosition,required:i.required}},["input"==i.tagIcon?s("div",[s("el-input",{attrs:{placeholder:i.placeholder,maxlength:i.maxlength,size:"medium"},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}})],1):e._e(),"coefficient"==i.tagIcon?s("div",[s("p",[e._v(e._s(i.const_value))])]):e._e(),"textarea"==i.tagIcon?s("div",[s("el-input",{attrs:{type:"textarea",rows:3,maxlength:i.maxlength,placeholder:i.placeholder},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}})],1):e._e(),"number"==i.tagIcon?s("div",[s("el-input",{attrs:{placeholder:i.placeholder,size:"medium"},on:{input:function(s){return e.enterClick(s,i.assign_data,l)}},model:{value:i.value,callback:function(s){e.$set(i,"value","string"===typeof s?s.trim():s)},expression:"item.value"}}),i.enable_assign?s("el-button",{staticClass:"margin_l_15",attrs:{size:"medium",type:"text"},on:{click:function(s){return e.assignClick(i,l)}}},[e._v("分配")]):e._e(),null!=i.assign_data?s("div",[null!=i.assign_data&&0!=i.assign_data.length?s("span",{staticClass:"success"},[e._v(" 未分配值："+e._s(e.assign_other[l])+" ")]):e._e(),e._l(i.assign_data,(function(t,a){return s("div",{key:t,staticClass:"margin_top_10"},[s("el-select",{staticClass:"assign_input",attrs:{filterable:"",placeholder:"请选择被分配人","filter-method":e.dataFilter},on:{change:function(i){return e.assignChange()}},model:{value:t.ToUserId,callback:function(i){e.$set(t,"ToUserId",i)},expression:"assignitem.ToUserId"}},e._l(e.userlist,(function(i){return s("el-option",{key:i.uid,attrs:{label:i.name,value:i.uid}},[s("span",{staticStyle:{float:"left"}},[e._v(e._s(i.name))]),s("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(i.uid))])])})),1),s("el-input",{staticClass:"assign_input margin_l_15",attrs:{placeholder:"请填写分配数值"},on:{input:function(s){return e.cal(i.value,i.assign_data,l)}},model:{value:t.ToValue,callback:function(i){e.$set(t,"ToValue",i)},expression:"assignitem.ToValue"}}),s("i",{staticClass:"el-icon-remove assign_icon assign_error danger",on:{click:function(s){return e.removeassign(i,a)}}}),a===i.assign_data.length-1?s("i",{staticClass:"el-icon-circle-plus assign_icon assign_add primary",on:{click:function(s){return e.assignClick(i,l)}}}):e._e()],1)}))],2):e._e()],1):e._e(),"date"==i.tagIcon?s("div",[s("el-date-picker",{attrs:{type:"date",placeholder:i.placeholder,size:"medium"},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}})],1):e._e(),"select"==i.tagIcon?s("div",[s("el-select",{attrs:{placeholder:i.placeholder,size:"medium"},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}},e._l(i.options,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"select_number"==i.tagIcon?s("div",[0==i.is_counted?s("span",[e._v(e._s(e.otherfn(i)))]):e._e(),s("el-select",{attrs:{placeholder:i.placeholder,size:"medium"},on:{change:function(s){return e.selectNChage(s,i)}},model:{value:i.is_counted,callback:function(s){e.$set(i,"is_counted",s)},expression:"item.is_counted"}},e._l(i.options,(function(e){return s("el-option",{key:e.value+"__"+e.label,attrs:{label:e.label,value:("object"==typeof e.value?JSON.stringify(e.value):e.value)+"__"+e.label}})})),1)],1):e._e(),"rate"==i.tagIcon?s("div",[s("el-rate",{attrs:{"allow-half":i["allow-half"]},model:{value:i.value,callback:function(s){e.$set(i,"value",s)},expression:"item.value"}})],1):e._e()]):e._e()],1)}))],2)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(i){e.my_is_add=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary",size:"small",disabled:e.btn_disable},on:{click:function(i){return e.submitClick()}}},[e._v("确 定")])],1)]),s("AssignAlert",{attrs:{is_add:e.is_assign,task_code:e.task_code,detail:e.detail},on:{back:e.assignBack,subback:e.assignSubBack}})],1)},t=[],a=(s("4de4"),s("c975"),s("b0c0"),s("b680"),s("d3b7"),s("ac1f"),s("25f0"),s("1276"),s("f2cd")),o=(s("5a6e"),s("1d57"),s("9c00")),f=s("ff65"),_={name:"fill_alert",props:{is_add:Boolean,form_data:Object,task_code:String},components:{AssignAlert:a["a"],uploadImg:o["a"],uploadFile:f["a"]},data:function(){return{btn_disable:!1,form_fields_select:[],form_data1:{},my_is_add:!1,form_fields:[],assigndetail:{},is_assign:!1,userlist:[],userlist_two:[],uploadKey:"0pc99vFCTZFb-FxnwxuyzbVcmlC_n0qkQ37INru4",uploadToken:"gbNuDHhFDyjIRLDXdJ6HRzp-uc_D6QypslKMJ85m",baseUrl:"http://images.xxxx.cn/",QiniuData:{key:"",token:""},domain:"http://upload-z1.qiniup.com",qiniuaddr:"http://cdn.deepgrid.cn/",uploadPicUrl:"",fileList:[],imgList:[],nowTime:"",fileExtension:"",otherlist:[],assign_other:[]}},methods:{back_btn:function(e){this.btn_disable=e},back_btn_img:function(e){this.btn_disable=e},addindex:function(e,i){this.assign_other[e]=i},calOther:function(e,i,s){for(var l in this.assign_other[i]=e,s){if("number"!=typeof s[l].ToValue&&("."==s[l].ToValue.split("")[s[l].ToValue.length-1]||""==s[l].ToValue))break;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(s[l].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;e=this.subtr(e,parseFloat(s[l].ToValue))}return this.assign_other[i]=e,e},cal:function(e,i,s){var l=parseFloat(e);for(var t in i){if("."==i[t].ToValue.split("")[i[t].ToValue.length-1]||""==i[t].ToValue)break;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(i[t].ToValue))return this.$alert(" 分配值请填写数字!","提示",{confirmButtonText:"确定"}),!1;l=this.subtr(l,parseFloat(i[t].ToValue))}this.assign_other[s]=l},subtr:function(e,i){var s,l,t,a;try{s=e.toString().split(".")[1].length}catch(o){s=0}try{l=i.toString().split(".")[1].length}catch(o){l=0}return t=Math.pow(10,Math.max(s,l)),a=s>=l?s:l,((e*t-i*t)/t).toFixed(a)},isNum:function(e){if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(e))return this.$alert(" 请填写数字!","提示",{confirmButtonText:"确定"}),e="",!1},removeassign:function(e,i){this.$delete(e.assign_data,i)},addassign:function(e){},assignClick:function(e,i){if(null==e.value||0==e.value)return this.$alert(" 请先填写，再分配!","提示",{confirmButtonText:"确定"}),!1;this.assignChange(),null==e.assign_data?(e.assign_data=[],e["assign_data"].push({ToUserId:"",ToValue:""})):e["assign_data"].push({ToUserId:"",ToValue:""})},otherfn:function(e){return e.is_counted="",e.join_gather="",""},close:function(){this.btn_disable=!1,this.my_is_add=!1},selectNChage:function(e,i){this.subClick()},enterClick:function(e,i,s){return"."!=e.split("")[e.length-1]&&""!=e&&(/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(e)?(this.cal(e,i,s),void this.subClick()):(this.$alert(" 请填写数字!","提示",{confirmButtonText:"确定"}),!1))},getnowdate:function(e){var i=new Date(e),s=i.getFullYear(),l=i.getMonth()+1,t=i.getDate();return l<10&&(l="0"+l),t<10&&(t="0"+t),s+"/"+l+"/"+t},countselected:function(e){var i=this,s=[];for(var l in this.form_fields)if(this.form_fields[l].required)if("number"==this.form_fields[l].tagIcon)s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].value)});else if("coefficient"==this.form_fields[l].tagIcon)s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].const_value)});else{if("divider"==this.form_fields[l].tagIcon||"describe"==this.form_fields[l].tagIcon||"describeImg"==this.form_fields[l].tagIcon)continue;"select_number"==this.form_fields[l].tagIcon?this.form_fields[l].is_counted.split("]}__").length<2?s.push({field_code:this.form_fields[l].filed_code,opt_label:this.form_fields[l].is_counted,field_label:this.form_fields[l].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].is_counted.split("__")[0])}):(this.form_fields[l].join_gather,s.push({field_code:this.form_fields[l].filed_code,opt_label:this.form_fields[l].is_counted,field_label:this.form_fields[l].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].join_gather)})):"date"==this.form_fields[l].tagIcon?s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:this.getnowdate(this.form_fields[l].value)}):"image"==this.form_fields[l].tagIcon?s.push({field_code:this.form_fields[l].filed_code,opt_label:"image",field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:!1,enable_assign:this.form_fields[l].enable_assign,value:this.form_fields[l].value}):"upload"==this.form_fields[l].tagIcon?s.push({field_code:this.form_fields[l].filed_code,opt_label:"file",field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:!1,enable_assign:this.form_fields[l].enable_assign,value:this.form_fields[l].value}):s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:this.form_fields[l].value})}else if("number"==this.form_fields[l].tagIcon)s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].value)});else if("coefficient"==this.form_fields[l].tagIcon)s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].const_value)});else if("select_number"==this.form_fields[l].tagIcon)this.form_fields[l].is_counted.split("]}__").length<2?s.push({field_code:this.form_fields[l].filed_code,opt_label:this.form_fields[l].is_counted,field_label:this.form_fields[l].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].is_counted.split("__")[0])}):(this.form_fields[l].join_gather,s.push({field_code:this.form_fields[l].filed_code,opt_label:this.form_fields[l].is_counted,field_label:this.form_fields[l].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].join_gather)}));else if("date"==this.form_fields[l].tagIcon)s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:this.getnowdate(this.form_fields[l].value)});else if("image"==this.form_fields[l].tagIcon)s.push({field_code:this.form_fields[l].filed_code,opt_label:"image",field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:this.form_fields[l].value});else if("upload"==this.form_fields[l].tagIcon)s.push({field_code:this.form_fields[l].filed_code,opt_label:"file",field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:this.form_fields[l].value});else{if("divider"==this.form_fields[l].tagIcon||"describe"==this.form_fields[l].tagIcon||"describeImg"==this.form_fields[l].tagIcon)continue;var t=this.form_fields[l].enable_assign;s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:t,value:this.form_fields[l].value})}var a=JSON.parse(e.is_counted.split("__")[0]).str_id_list,o=this,f={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,file_info:JSON.stringify(s),formula_method:JSON.stringify(a)},_=o.$createObj(f),r=_["keyvalue"],d=o.$apilist["countselected"]+"?signature="+r;o.$server.post(d,_["fd"]).then((function(s){e.join_gather=s.data,i.subClickTwo()})).catch((function(e){}))},subClick:function(){var e=this;for(var i in this.form_fields_select)this.form_fields_select[i].is_counted.split("]}__").length>1&&this.countselected(this.form_fields_select[i]);var s=[];for(var l in this.form_fields)if(this.form_fields[l].required)if("number"==this.form_fields[l].tagIcon)s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].value)});else if("coefficient"==this.form_fields[l].tagIcon)s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].const_value)});else{if("divider"==this.form_fields[l].tagIcon||"describe"==this.form_fields[l].tagIcon||"describeImg"==this.form_fields[l].tagIcon)continue;"select_number"==this.form_fields[l].tagIcon?this.form_fields[l].is_counted.split("]}__").length<2?s.push({field_code:this.form_fields[l].filed_code,opt_label:this.form_fields[l].is_counted,field_label:this.form_fields[l].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].is_counted.split("__")[0])}):(this.form_fields[l].join_gather,s.push({field_code:this.form_fields[l].filed_code,opt_label:this.form_fields[l].is_counted,field_label:this.form_fields[l].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].join_gather)})):"date"==this.form_fields[l].tagIcon?s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:this.getnowdate(this.form_fields[l].value)}):"image"==this.form_fields[l].tagIcon?s.push({field_code:this.form_fields[l].filed_code,opt_label:"image",field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:!1,enable_assign:this.form_fields[l].enable_assign,value:this.form_fields[l].value}):"upload"==this.form_fields[l].tagIcon?s.push({field_code:this.form_fields[l].filed_code,opt_label:"file",field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:!1,enable_assign:this.form_fields[l].enable_assign,value:this.form_fields[l].value}):s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:this.form_fields[l].value})}else if("number"==this.form_fields[l].tagIcon)s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].value)});else if("coefficient"==this.form_fields[l].tagIcon)s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].const_value)});else if("select_number"==this.form_fields[l].tagIcon)this.form_fields[l].is_counted.split("]}__").length<2?s.push({field_code:this.form_fields[l].filed_code,opt_label:this.form_fields[l].is_counted,field_label:this.form_fields[l].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].is_counted.split("__")[0])}):(this.form_fields[l].join_gather,s.push({field_code:this.form_fields[l].filed_code,opt_label:this.form_fields[l].is_counted,field_label:this.form_fields[l].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:parseFloat(this.form_fields[l].join_gather)}));else if("date"==this.form_fields[l].tagIcon)s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:this.getnowdate(this.form_fields[l].value)});else if("image"==this.form_fields[l].tagIcon)s.push({field_code:this.form_fields[l].filed_code,opt_label:"image",field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:this.form_fields[l].value});else if("upload"==this.form_fields[l].tagIcon)s.push({field_code:this.form_fields[l].filed_code,opt_label:"file",field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:this.form_fields[l].enable_assign,value:this.form_fields[l].value});else{if("divider"==this.form_fields[l].tagIcon||"describe"==this.form_fields[l].tagIcon||"describeImg"==this.form_fields[l].tagIcon)continue;var t=this.form_fields[l].enable_assign;s.push({field_code:this.form_fields[l].filed_code,field_label:this.form_fields[l].label,join_gather:this.form_fields[l].join_gather,is_counted:this.form_fields[l].is_counted,enable_greater:this.form_fields[l].enable_greater,enable_assign:t,value:this.form_fields[l].value})}var a=this,o={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,rule_file_info:JSON.stringify(s)},f=a.$createObj(o),_=f["keyvalue"],r=a.$apilist["countfunction"]+"?signature="+_;a.$server.post(r,f["fd"]).then((function(i){if(i.data.length>0)for(var s in i.data)for(var l in e.form_data1.fields)e.form_data1.fields[l].filed_code==i.data[s].field_code&&(e.form_data1.fields[l].value=i.data[s].value)})).catch((function(e){}))},subClickTwo:function(){var e=this,i=[];for(var s in this.form_fields)if(this.form_fields[s].required)if("number"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)});else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;"select_number"==this.form_fields[s].tagIcon?this.form_fields[s].is_counted.split("]}__").length<2?i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])}):(this.form_fields[s].join_gather,i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].join_gather)})):"date"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)}):"image"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):"upload"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value})}else if("number"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)});else if("select_number"==this.form_fields[s].tagIcon)this.form_fields[s].is_counted.split("]}__").length<2?i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])}):(this.form_fields[s].join_gather,i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].join_gather)}));else if("date"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)});else if("image"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else if("upload"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;var l=this.form_fields[s].enable_assign;i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:l,value:this.form_fields[s].value})}var t=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,rule_file_info:JSON.stringify(i)},o=t.$createObj(a),f=o["keyvalue"],_=t.$apilist["countfunction"]+"?signature="+f;t.$server.post(_,o["fd"]).then((function(i){if(i.data.length>0)for(var s in i.data)for(var l in e.form_data1.fields)e.form_data1.fields[l].filed_code==i.data[s].field_code&&(e.form_data1.fields[l].value=i.data[s].value)})).catch((function(e){}))},submitClick:function(){var e=this,i=[];for(var s in this.form_fields)if(this.form_fields[s].required){if("select_number"==this.form_fields[s].tagIcon){if(0==this.form_fields[s].is_counted)return this.$alert("请选择 "+this.form_fields[s].label+" !","提示",{confirmButtonText:"确定"}),!1}else if("number"==this.form_fields[s].tagIcon){if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].value))return this.$alert(this.form_fields[s].label+" 请填写数字!","提示",{confirmButtonText:"确定"}),!1}else if((null==this.form_fields[s].value||""==this.form_fields[s].value)&&"divider"!=this.form_fields[s].tagIcon&&"describe"!=this.form_fields[s].tagIcon&&"describeImg"!=this.form_fields[s].tagIcon)return this.$alert("请填写 "+this.form_fields[s].label+" !","提示",{confirmButtonText:"确定"}),!1;if("number"==this.form_fields[s].tagIcon){for(var l in this.form_fields[s].assign_data){if(""==this.form_fields[s].assign_data[l].ToUserId||""==this.form_fields[s].assign_data[l].ToValue)return this.$alert(this.form_fields[s].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].assign_data[l].ToValue))return this.$alert(" 分配值请填写数字1!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[s].assign_data[l].ToValue=parseFloat(this.form_fields[s].assign_data[l].ToValue)}i.push({field_code:this.form_fields[s].filed_code,assign_data:this.form_fields[s].assign_data,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)})}else if("calculate"==this.form_fields[s].tagIcon){for(var t in this.form_fields[s].assign_data){if(""==this.form_fields[s].assign_data[t].ToUserId||""==this.form_fields[s].assign_data[t].ToValue)return this.$alert(this.form_fields[s].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].assign_data[t].ToValue))return this.$alert(" 分配值请填写数字2!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[s].assign_data[t].ToValue=parseFloat(this.form_fields[s].assign_data[t].ToValue)}i.push({field_code:this.form_fields[s].filed_code,assign_data:this.form_fields[s].assign_data,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)})}else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;"select_number"==this.form_fields[s].tagIcon?this.form_fields[s].is_counted.split("]}__").length<2?i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])}):(this.form_fields[s].join_gather,i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].join_gather)})):"date"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)}):"image"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):"upload"==this.form_fields[s].tagIcon?i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:!1,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value}):i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value})}}else if("number"==this.form_fields[s].tagIcon){for(var a in this.form_fields[s].assign_data){if(""==this.form_fields[s].assign_data[a].ToUserId||""==this.form_fields[s].assign_data[a].ToValue)return this.$alert(this.form_fields[s].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].assign_data[a].ToValue))return this.$alert(" 分配值请填写数字3!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[s].assign_data[a].ToValue=parseFloat(this.form_fields[s].assign_data[a].ToValue)}i.push({field_code:this.form_fields[s].filed_code,assign_data:this.form_fields[s].assign_data,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)})}else if("calculate"==this.form_fields[s].tagIcon){for(var o in this.form_fields[s].assign_data){if(""==this.form_fields[s].assign_data[o].ToUserId||""==this.form_fields[s].assign_data[o].ToValue)return this.$alert(this.form_fields[s].label+" 的分配内容未完成!","提示",{confirmButtonText:"确定"}),!1;if(!/(^[\-0-9][0-9]*(.[0-9]+)?)$/.test(this.form_fields[s].assign_data[o].ToValue))return this.$alert(" 分配值请填写数字4!","提示",{confirmButtonText:"确定"}),!1;this.form_fields[s].assign_data[o].ToValue=parseFloat(this.form_fields[s].assign_data[o].ToValue)}i.push({field_code:this.form_fields[s].filed_code,assign_data:this.form_fields[s].assign_data,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].value)})}else if("select_number"==this.form_fields[s].tagIcon)this.form_fields[s].is_counted.split("]}__").length<2?i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].is_counted.split("__")[0])}):(this.form_fields[s].join_gather,i.push({field_code:this.form_fields[s].filed_code,opt_label:this.form_fields[s].is_counted,field_label:this.form_fields[s].label,join_gather:!1,is_counted:!1,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:parseFloat(this.form_fields[s].join_gather)}));else if("date"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.getnowdate(this.form_fields[s].value)});else if("image"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"image",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else if("upload"==this.form_fields[s].tagIcon)i.push({field_code:this.form_fields[s].filed_code,opt_label:"file",field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:this.form_fields[s].enable_assign,value:this.form_fields[s].value});else{if("divider"==this.form_fields[s].tagIcon||"describe"==this.form_fields[s].tagIcon||"describeImg"==this.form_fields[s].tagIcon)continue;var f=this.form_fields[s].enable_assign;i.push({field_code:this.form_fields[s].filed_code,field_label:this.form_fields[s].label,join_gather:this.form_fields[s].join_gather,is_counted:this.form_fields[s].is_counted,enable_greater:this.form_fields[s].enable_greater,enable_assign:f,value:this.form_fields[s].value})}var _=this,r={corpid:this.$store.state.corpid,userid:this.$store.state.userid,form_code:this.form_data.form_code,form_field_info:JSON.stringify(i),task_code:this.task_code},d=_.$createObj(r),n=d["keyvalue"],h=_.$apilist["addone_main"]+"?signature="+n;_.$server.post(h,d["fd"]).then((function(i){e.$message({message:"添加成功！",type:"success"}),e.fileList=[],e.$emit("subback"),e.close()})).catch((function(e){}))},dataFilter:function(e){this.userlist=this.userlist_two.filter((function(i){if(-1!==i.uid.indexOf(e)||-1!==i.name.indexOf(e))return!0}))},assignChange:function(){this.userlist=this.userlist_two},alluser:function(){var e=this,i=this,s={corpid:this.$store.state.corpid,userid:this.$store.state.userid},l=i.$createObj(s),t=l["keyvalue"],a=i.$apilist["allusernameandid"]+"?signature="+t;i.$server.post(a,l["fd"]).then((function(i){e.userlist=i.data,e.userlist_two=Object.assign(i.data)})).catch((function(e){}))}},created:function(){},mounted:function(){this.alluser()},watch:{is_add:function(e){if(this.my_is_add=e,e)for(var i in this.form_data1=JSON.parse(JSON.stringify(this.form_data)),this.form_fields=this.form_data1.fields,this.form_fields_select=[],this.form_fields)"select_number"==this.form_fields[i].tagIcon&&this.form_fields_select.push(this.form_fields[i])},my_is_add:function(e){this.$emit("back",e)}}},r=_,d=(s("8ea8"),s("2877")),n=Object(d["a"])(r,l,t,!1,null,null,null);i["a"]=n.exports},"57fd":function(e,i,s){},"5f87":function(e,i,s){"use strict";s.d(i,"a",(function(){return a}));var l=s("a78e"),t=s.n(l);function a(e){return t.a.get(e)}},"8ea8":function(e,i,s){"use strict";s("57fd")}}]);