(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f15959b0"],{"1d35":function(t,e,a){},"25ce":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"alldatalist"},[a("div",{staticClass:"top_form"},[a("span",{staticClass:"name_span",class:{active_gatherlist:t.is_tab},on:{click:function(e){return t.tabClick(1)}}},[t._v(t._s(t.title))]),a("span",{staticClass:"line_span"},[t._v("|")]),a("span",{staticClass:"name_span",class:{active_gatherlist:!t.is_tab},attrs:{span:""},on:{click:function(e){return t.tabClick(2)}}},[t._v("数据详情")]),a("span",{staticClass:"right"},[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.is_tab,expression:"!is_tab"}]},[a("el-input",{staticClass:"width_150",attrs:{placeholder:"搜索",size:"small"},model:{value:t.filters[0].value,callback:function(e){t.$set(t.filters[0],"value",e)},expression:"filters[0].value"}}),a("el-button",{staticClass:"margin_l_15",attrs:{icon:"el-icon-plus",type:"primary",size:"small"},on:{click:function(e){return t.fillClick()}}},[t._v("添加")]),a("el-button",{staticClass:"margin_l_15",attrs:{icon:"el-icon-delete",size:"small"},on:{click:function(e){return t.batchdel()}}},[t._v("删除")])],1),a("el-button",{staticClass:"margin_l_5",attrs:{size:"small",icon:"iconfont icon-cancel"},on:{click:function(e){return t.goback()}}},[t._v("返回")])],1)]),a("div",{staticClass:"flex_item"},[a("div",{staticClass:"right_fill_top_content"},[a("div",{staticClass:"flex audit_content"},[a("div",{staticClass:"flex_item"},[a("p",{staticClass:"audit_num"},[t._v(t._s(t.main_data.CommitCount))]),a("p",{staticClass:"audit_font"},[t._v("已提交")])]),a("div",{staticClass:"flex_item"},[a("p",{staticClass:"audit_num"},[t._v(t._s(t.main_data.DenyCount))]),a("p",{staticClass:"audit_font"},[t._v("已退回")])]),a("div",{staticClass:"flex_item"},[a("p",{staticClass:"audit_num"},[t._v(t._s(t.main_data.PassedCount))]),a("p",{staticClass:"audit_font"},[t._v("已通过")])]),a("div",{staticClass:"flex_item"},[a("p",{staticClass:"audit_num"},[t._v(t._s(t.main_data.ReviewingCount))]),a("p",{staticClass:"audit_font"},[t._v("审核中")])])])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.is_tab,expression:"is_tab"}]},[a("div",t._l(t.sortFun(t.formlist),(function(e){return a("div",{key:e,staticClass:"type_div"},[a("p",{staticClass:"title_form"},[a("span",{on:{click:function(a){return t.typeEditorClick(e,t.formlist[e][0].TypeContent)}}},[t._v(" "+t._s(t.formlist[e][0].TypeContent)+" ")])]),a("div",{staticClass:"clearfix"}),1==t.isStr(t.formlist[e])?a("ul",{staticClass:"eform-list clearfix"},t._l(t.formlist[e],(function(e){return a("li",{key:e,on:{mouseover:function(e){return t.mouseOver(e)},mouseleave:function(e){return t.mouseLeave(e)}}},[a("div",{staticClass:"list_box"},[a("div",{staticClass:"content_list_item"},[a("p",{staticClass:"p_over left width_150",attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(e.Title)+" ")]),e.DenyCount>0?a("p",{staticClass:"right other_count"},[t._v(" "+t._s(e.DenyCount)+" ")]):t._e(),a("div",{staticClass:"clearfix"})]),a("div",[a("div",{staticClass:"left other_left"},[t._v(" 包含 "),a("span",{staticClass:"other_span"},[t._v(t._s(e.AllCount))]),t._v(" 条数据 ")]),a("ul",{staticClass:"operation flex right"},[a("li",{on:{click:function(a){return t.authorizationFormClick(e)}}},[t._v("授权导入")]),a("li",{on:{click:function(a){return t.goClick(e)}}},[a("span",[t._v("进入")])])])])])])})),0):t._e(),a("div",{staticClass:"clearfix"})])})),0)]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.is_tab,expression:"!is_tab"}],staticClass:"type_div"},[a("data-tables",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{data:t.table_data,filters:t.filters,"pagination-props":{pageSizes:[5,10,15]},"row-key":t.row_key,"expand-row-keys":t.expandRowKeys,"table-props":t.tableProps},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"65"}}),a("el-table-column",{attrs:{label:"内容"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.FormFieldInfos,(function(e,i){return a("div",{key:e},[i<3?a("p",{staticClass:"flow-subtitle"},[""!=e.opt_label&&"image"!=e.opt_label&&"file"!=e.opt_label?a("span",[t._v(" "+t._s(e.field_label)+":"+t._s(e.opt_label.split("__")[1])+" ")]):"image"==e.opt_label||"file"==e.opt_label?a("span",[t._v(" "+t._s(e.field_label)+": "),e.value.length>1?a("span",[t._v(t._s(e.value[0].name)+"...")]):1==e.value.length?a("span",[t._v(t._s(e.value[0].name))]):a("span",[t._v("-")])]):a("span",[t._v(" "+t._s(e.field_label)+":"+t._s(e.value)+" ")])]):t._e()])}))}}])}),a("el-table-column",{attrs:{label:"工号",prop:"CreateUserId"}}),a("el-table-column",{attrs:{label:"姓名",prop:"CreateUserName"}}),a("el-table-column",{attrs:{label:"表单名",prop:"FormName"}}),a("el-table-column",{attrs:{label:"部门",prop:"Department"}}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"flow-permisson-row"},[a("span",[0==e.row.State?a("span",{staticClass:"flow_per"},[t._v("未提交")]):1==e.row.State?a("span",{staticClass:"flow_per warning"},[t._v("已提交 ")]):2==e.row.State?a("span",{staticClass:"flow_per danger"},[t._v("驳回")]):3==e.row.State?a("span",{staticClass:"flow_per success"},[t._v("已通过")]):4==e.row.State?a("span",{staticClass:"flow_per warning"},[t._l(e.row.AuditStates,(function(i,s){return a("span",{key:i},[a("span",[t._v(t._s(i.user_info[0].name))]),s<e.row.AuditStates.length-1?a("span",[t._v("/")]):t._e()])})),t._v(" 审核中")],2):5==e.row.State?a("span",{staticClass:"flow_per success"},[t._v("已通过")]):6==e.row.State?a("span",{staticClass:"flow_per"},[t._v("导入数据")]):t._e()])])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[a("i",{staticClass:"el-icon-more"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("p",{on:{click:function(a){return t.detailClick(e.row)}}},[t._v("详情")])]),0==e.row.State||2==e.row.State||6==e.row.State?a("el-dropdown-item",[a("p",{on:{click:function(a){return t.ediotrFillClick(e.row)}}},[t._v(" 编辑 ")])]):t._e(),a("el-dropdown-item",[a("p",{on:{click:function(a){return t.delClick(e.row.Code)}}},[t._v(" 删除 ")])])],1)],1)]}}])})],1),a("div",{staticClass:"clearfix"})],1),a("el-dialog",{staticClass:"audit_dialog",attrs:{title:"选择审批",visible:t.dialogTableVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("el-form",{staticClass:"auditform",attrs:{"label-width":"80px"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"部门"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(e){return t.auditSelectClick()}},model:{value:t.select_depart,callback:function(e){t.select_depart=e},expression:"select_depart"}},t._l(t.auditkey,(function(e){return a("el-option",{key:e,attrs:{label:t.auditlist[e].depart_name,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"审批"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.select_auditcode,callback:function(e){t.select_auditcode=e},expression:"select_auditcode"}},t._l(t.audit_key_list,(function(t){return a("el-option",{key:t.NodeCode,attrs:{label:t.ConditionName,value:t.NodeCode}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.auditSubmitClick()}}},[t._v("确 定")])],1)],1),a("FillAlert",{attrs:{is_add:t.is_add,formlist:t.formlist,task_code:t.task_code},on:{back:t.fillBack,subback:t.subFillBack}}),a("FillEditorAlert",{attrs:{is_add:t.is_editor,form_data:t.formdetail,main_code:t.main_code,task_code:t.task_code,detail:t.detail},on:{back:t.fillEBack,subback:t.subFillEBack}}),a("DetailAlert",{attrs:{is_add:t.is_detail,detail:t.detail,form_data:t.formdetail},on:{back:t.detailBack,otherback:t.otherDetailBack}}),a("LogAlert",{attrs:{is_add:t.is_log,code:t.logcode},on:{back:t.logBack}}),a("DepartAlertS",{attrs:{is_add:t.is_depart,departlist:t.departlist,title:"表单授权"},on:{back:t.departBack,departSub:t.departSub}})],1)},s=[],l=(a("99af"),a("b0c0"),a("b64b"),a("ade3")),o=a("5a6e"),n=a("988b"),r=a("7239"),c=a("56bf"),d=a("7f91"),u=a("bee8"),_={name:"gatherlist",components:{FillAlert:n["a"],FillEditorAlert:r["a"],DetailAlert:c["a"],LogAlert:d["a"],DepartAlertS:u["a"]},data:function(){var t;return t={is_add:!1,select_auditcode:"",select_depart:"",dialogTableVisible:!1,is_detail:!1,is_editor:!1,main_code:"",detail:{},formdetail:{}},Object(l["a"])(t,"is_add",!1),Object(l["a"])(t,"table_data",[]),Object(l["a"])(t,"task_code",""),Object(l["a"])(t,"main_data",{}),Object(l["a"])(t,"formlist",[]),Object(l["a"])(t,"is_tab",!0),Object(l["a"])(t,"gather_list",[]),Object(l["a"])(t,"rule_list",[]),Object(l["a"])(t,"rule_list_key",[]),Object(l["a"])(t,"title",""),Object(l["a"])(t,"code",""),Object(l["a"])(t,"dellist",[]),Object(l["a"])(t,"tableProps",{border:!0,"header-cell-style":{background:"#eef1f6",color:"#606266"}}),Object(l["a"])(t,"filters",[{prop:["CreateUserName","Department","CreateUserId","FormName"],value:""}]),Object(l["a"])(t,"auditlist",[]),Object(l["a"])(t,"auditkey",[]),Object(l["a"])(t,"is_depart",!1),Object(l["a"])(t,"form_code",""),t},methods:{authorizationFormClick:function(t){this.is_depart=!0,this.form_code=t.Code,null==t.CooperationInfo?this.departlist=[]:this.departlist=t.CooperationInfo},departBack:function(t){this.is_depart=t},departSub:function(t){var e=this,a=this;for(var i in t)delete t[i].Children,delete t[i].ParentId;var s={cooper:JSON.stringify(t),corpid:this.$store.state.corpid,userid:this.$store.state.userid,code:this.form_code},l=a.$createObj(s),o=l["keyvalue"],n=a.$apilist["updatecooper_task"]+"?signature="+o;a.$server.post(n,l["fd"]).then((function(t){e.$message({type:"success",message:"授权成功!"}),e.departlist=[],e.getalltemplateform()})).catch((function(t){}))},handleSelectionChange:function(t){this.dellist=t},subFillBack:function(){this.getgather()},fillClick:function(){this.is_add=!this.is_add},fillBack:function(t){this.is_add=t},auditSelectClick:function(){this.select_auditcode="",this.audit_key_list=this.auditlist[this.select_depart].conditions},auditSubmitClick:function(){if(""==this.select_auditcode)return this.$alert("请选择审批流程！","提示",{confirmButtonText:"确定"}),!1;1==this.num?this.commitmaindatawithnodecode(this.codeval):this.batchcommitmaindatawithnodecode(this.codeval)},submitClick:function(t,e){this.dialogTableVisible=!this.dialogTableVisible,this.num=e,this.codeval=t},getauditlist:function(){var t=this,e=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,task_code:Object(o["a"])(this.$route.query.id)},i=e.$createObj(a),s=i["keyvalue"],l=e.$apilist["getauditlist"]+"?signature="+s;e.$server.post(l,i["fd"]).then((function(e){t.auditlist=e.data,t.auditkey=Object.keys(e.data)})).catch((function(t){}))},commitmaindatawithnodecode:function(t){var e=this,a=this,i={corpid:this.$store.state.corpid,userid:this.$store.state.userid,main_code:t,depart_code:this.select_depart,node_code:this.select_auditcode},s=a.$createObj(i),l=s["keyvalue"],o=a.$apilist["commitmaindatawithnodecode"]+"?signature="+l;a.$server.post(o,s["fd"]).then((function(){e.dialogTableVisible=!1,e.$message({type:"success",message:"提交成功!"}),e.getgather()})).catch((function(t){}))},batchcommitmaindatawithnodecode:function(t){var e=this,a=this,i={corpid:this.$store.state.corpid,userid:this.$store.state.userid,main_codes:JSON.stringify(t),depart_code:this.select_depart,node_code:this.select_auditcode},s=a.$createObj(i),l=s["keyvalue"],o=a.$apilist["batchcommitmaindatawithnodecode"]+"?signature="+l;a.$server.post(o,s["fd"]).then((function(t){e.dialogTableVisible=!1,70002==t.data?e.$alert(t.message,"提示",{confirmButtonText:"确定",callback:function(t){e.getgather()}}):(e.$message({type:"success",message:"提交成功!"}),e.getgather())})).catch((function(t){}))},batchdel:function(){var t=this;if(0==this.dellist.length)return this.$alert("请选择要删除的数据","提示",{confirmButtonText:"确定"}),!1;this.$confirm("此操作将永久删除数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=[];for(var a in t.dellist)e.push(t.dellist[a].Code);var i=t,s={corpid:t.$store.state.corpid,userid:t.$store.state.userid,main_codes:JSON.stringify(e)},l=i.$createObj(s),o=l["keyvalue"],n=i.$apilist["batchdel"]+"?signature="+o;i.$server.post(n,l["fd"]).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.dellist=[],t.getgather()})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}))},delClick:function(t){var e=this;this.$confirm("删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=e,i={corpid:e.$store.state.corpid,userid:e.$store.state.userid,code:t},s=a.$createObj(i),l=s["keyvalue"],o=a.$apilist["delone_main"]+"?signature="+l;a.$server.post(o,s["fd"]).then((function(){e.getgather(),e.$message({type:"success",message:"删除成功!"})})).catch((function(t){}))})).catch((function(){}))},ediotrFillClick:function(t){this.main_code=t.Code,this.detail=t,this.is_editor=!this.is_editor},fillEBack:function(t){this.is_editor=t},subFillEBack:function(){this.getgather()},detailClick:function(t){this.is_detail=!this.is_detail,this.detail=t},detailBack:function(t){this.is_detail=t},otherDetailBack:function(){this.getgather()},isStr:function(t){return"string"!=typeof t?1:234},sortFun:function(t){var e=[],a=[],i=Object.keys(t);for(var s in i)"string"==typeof t[i[s]]?a.push(i[s]):e.push(i[s]);return"其他"==e[0]&&e.reverse(),e.concat(a)},goback:function(){this.$router.push({name:"indexTask",query:{k:Date.now()}})},goClick:function(t){this.$router.push({name:"formdataTask",params:{other:this.$route.params.other},query:{id:Object(o["b"])(t.Code),taskname:this.$route.query.name,taskcode:this.$route.query.id,name:t.Title}})},tabClick:function(t){this.is_tab=1==t},mouseOver:function(t){t.currentTarget.className="  active"},mouseLeave:function(t){t.currentTarget.className=""},getalltemplateform:function(){var t=this,e=this,a=this.$route.query.id,i={corpid:this.$store.state.corpid,userid:this.$store.state.userid,task_code:Object(o["a"])(a)},s=e.$createObj(i),l=s["keyvalue"],n=e.$apilist["getformlist"]+"?signature="+l;e.$server.post(n,s["fd"]).then((function(e){t.formlist=e.data})).catch((function(t){}))},maincountinfo:function(){var t=this,e=this,a=this.$route.query.id,i={corpid:this.$store.state.corpid,task_code:Object(o["a"])(a)},s=e.$createObj(i),l=s["keyvalue"],n=e.$apilist["maincountinfo"]+"?signature="+l;e.$server.post(n,s["fd"]).then((function(e){t.main_data=e.data})).catch((function(t){}))},getgather:function(){var t=this,e=this.$route.query.id;this.code=Object(o["a"])(e),this.title=this.$route.query.name,this.taskid=e,this.task_code=Object(o["a"])(e);var a=this,i={corpid:this.$store.state.corpid,task_code:Object(o["a"])(e)},s=a.$createObj(i),l=s["keyvalue"],n=a.$apilist["allmaindatabyformcodeanduserid"]+"?signature="+l;a.$server.post(n,s["fd"]).then((function(e){t.table_data=e.data,t.select_auditcode="",t.select_depart=""})).catch((function(t){}))},exportExcel:function(){var t=this,e=this,a={corpid:this.$store.state.corpid,userid:this.$store.state.userid,task_code:this.code},i=e.$createObj(a),s=i["keyvalue"],l=e.$apilist["export"]+"?signature="+s;this.gather_list=[],this.rule_list=[],this.rule_list_key=[],e.$server.post(l,i["fd"]).then((function(e){window.open(t.$store.state.imgurl+"/"+e.data.path),t.getgather()})).catch((function(t){}))}},mounted:function(){this.getauditlist(),this.getgather(),this.getalltemplateform(),this.maincountinfo()}},p=_,f=(a("8e48"),a("2877")),h=Object(f["a"])(p,i,s,!1,null,null,null);e["default"]=h.exports},"8e48":function(t,e,a){"use strict";a("1d35")}}]);